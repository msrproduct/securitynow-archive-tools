 (upbeat music)
 This is "Security Now" with Steve Gibson,
 Episode 17 for December 8th, 2005,
 continuing VPN solutions.
 (upbeat music)
 Steve Gibson is joining us via Google Talk
 and we're ready to continue,
 is this episode four of VPN, episode three,
 we've been doing this?
 - I think this is actually our third.
 We talked about the theory of VPN first.
 That is, what's the concept of tunneling packets
 through another protocol?
 Last week, of course, we talked about SSH tunnels
 and SSL tunnels.
 And this week we wanna talk about
 basically sort of the granddaddy protocols of VPN,
 which is a point-to-point tunneling protocol, PPTP,
 which was originated by Microsoft,
 and then sort of the formal IETF standard,
 which is IPsec tunneling
 to create a virtual private network extension.
 - So this is really the alphabet soup edition.
 - Yeah, we have a few more to go.
 We're gonna talk about some open source VPN solutions
 and some public services in the next week or two.
 But I wanna talk about the VPN
 that most people already have.
 Basically, if they're using Windows,
 even Mac supports PPTP VPNs.
 And of course, many people have VPN endpoint NAT routers
 and there are issues with interconnecting all this.
 So that's sort of where I wanted to go.
 - It's a big topic and an important topic
 because frankly, secure networking, secure online uses,
 top of mind for everybody these days.
 - Well, I can tell you that there's been a phenomenal
 response in the postings that we've received
 about this topic.
 People who are roaming around the so-called road warriors
 who are in hotels or in open Wi-Fi,
 they understand that their traffic is very vulnerable
 without creating a secure connection.
 So that's of course what VPN offers.
 - Well, let's start with the circle round
 for a last week's episode.
 'Cause even though it was a question and answer episode,
 we created some more questions.
 - Well, yeah, I think I overstated the security
 offered by switches versus hubs in responding
 to one of the questions that we'd seen many times
 like is a hub much more secure than a switch,
 much more secure than a hub
 because it doesn't allow you,
 a switch doesn't rebroadcast all of the net's traffic
 out of every port.
 I'm, a number of people said, wait a minute,
 there are ways to breach the security of a switch.
 Well, that's not really true.
 There are ways to breach the security of an ethernet LAN
 and we're definitely gonna be talking about those.
 But I first, I don't wanna freak everyone out with that
 until we provide some solutions
 which they'll already have implemented
 or be ready to implement
 after we talk about these VPN solutions.
 So it's really not that the security of a switch
 is unbreakable.
 It's that the security of the ethernet itself
 is, it was never designed, like many of our protocols,
 never designed with security in mind.
 So it is true that you cannot passively sniff the LANs traffic
 on a switch whereas you can with a hub,
 but it is also true that there are active means
 of subverting the entire network
 that we'll be talking about in the future.
 So I just wanted to go on the record and clear that up.
 - That are poisoning that the guy was talking about, right?
 - Exactly.
 - We'll save that for another.
 - Also, I mangled an acronym and I hate when I do that,
 especially the acronyms that I know so well.
 I talked about CSMA and I called it Collision Sense
 Multiple Access instead of Carrier Sense Multiple Access
 and it has a CD on the end which stands for Collision Detection.
 So the real acronym for ethernet is CSMA/CD
 which is Carrier Sense Multiple Access
 with Collision Detection.
 - I admire your engineers, you know,
 drive to precision and clarity,
 but I don't think most people care that much.
 - It's the only way I could code everything
 in assembly language if I paid attention to the carry bit.
 - Everything matters in a sense.
 - And following up one last point,
 which was our discussion of how virtually impossible
 it is to use a public access point.
 That is like a public terminal in a hotel or in a library.
 Even, you know, like we were explaining
 that even keystroke logging could be installed
 on that machine and in fact has been found
 in public terminals.
 Many people wrote with various like clever means
 to get around that.
 For example, if you open Notepad,
 you could type a couple characters in on your password,
 then switch to a different application,
 type some nonsense, go back to Notepad, type a few more,
 go back to something else, type some nonsense.
 The point is that you could,
 if something was only able to see your keystrokes
 and not things you were doing elsewhere
 on the multi-window interface,
 then you could even use like a cut and copy paste
 in order to end up assembling your final username
 and password that a keystroke logger would be blind to.
 And there's, you know, any number of variations
 of that concept that I thought those were clever
 and certainly worth mentioning.
 - Knock yourself out, kids.
 - There you go.
 If you really wanna do that.
 But I guess it is one way that you could use
 a public terminal and be fairly assured of safety,
 unless somebody's got a camera over your shoulder
 and then forget it.
 - If you really have to.
 - All right, let's go on.
 P-P-P-T-P point to point tunneling protocol.
 - This is the original protocol
 which every version of Windows from 95 on
 has had built into it.
 There are, it's, there are a number of ways
 to use the protocol and because they're built
 into Windows, they're sort of compelling.
 The problem is that Microsoft's first implementation
 had some very serious security vulnerabilities
 in the way the tunnel authenticates itself.
 And even the second one ends up being prone
 to too ready abuse.
 So Microsoft is deprecating the use of it.
 They call it non-strategic for the future
 and they're moving to what they call L2-TP,
 which is layer two tunneling protocol,
 which is protected by IPsec,
 which is the standard IP security protocol.
 But it is in everyone's machine and in our show notes,
 I've got some links to some pages that show, for example,
 how you can, with no additional software,
 how you can just use the built-in new connection wizard
 in Windows XP or there's a variation of that
 in Windows 2000, just step through the wizard
 and basically interconnect two machines using this VPN.
 - They call it VPN, but it's using this point-to-point
 tunneling protocol.
 - It is, well, it would be a point-to-point tunneling
 protocol VPN.
 I mean, it truly is a virtual private network
 where the client machine is acquiring an IP
 from the machine it's connecting to,
 which is essentially extending the entire network
 through to the other machine.
 That it's worth mentioning that when we were talking last week
 about SSH tunneling,
 there were really not using a VPN solution.
 It's a secure protocol tunnel which uses proxy servers
 in order to basically fool your clients
 into routing their traffic through the tunnel
 as opposed to a true VPN,
 which is what we're talking about this week,
 that actually gives your client an IP from the server
 and it's like it's on the server's local network
 and it's being secured through this encrypted tunnel.
 So these are true VPN solutions.
 - I remember using corporate VPNs that used this PPTP.
 You had to use Windows pretty much Macintosh
 and Linux didn't support it very well
 because it's a Microsoft protocol.
 And the rest of the world's not using PPTP.
 - That's true.
 And in fact, the routers that people can buy recently now,
 these so-called VPN endpoint routers,
 they actually are a VPN server.
 And you remember a couple of weeks ago,
 I started talking about my quest for the Holy Grail.
 Well, the Holy Grail was to need no client software
 on a machine out on the internet.
 You're in an open Wi-Fi hotspot.
 You're a road warrior in a hotel.
 You realize that because it's on a LAN,
 which is inherently unsafe or your radio,
 which is inherently unsafe,
 you really need to encrypt your traffic
 at least until it gets out of that danger zone.
 A number of people have said,
 "Hey, Steve, it's cool that you're talking about VPNs."
 But once you get your traffic decrypted,
 it's going out over the internet anyway, isn't it?
 So what's the point?
 Well, the point is you want it encrypted
 while your traffic is crossing the area of highest danger,
 which for example, in a hotel setting is a network
 you don't control or in an open Wi-Fi
 is where your traffic is inherently sniffleable
 by anybody who is able to be within range.
 So sure, all internet traffic,
 as it passes over the internet,
 unless it's explicitly encrypted by an SSL connection,
 it's going to be in the clear,
 but there you just have safety in numbers.
 It's a huge tunnel, an amazing amount of traffic going by,
 very unlikely that anyone is going to find it.
 But again, it's prone to targeted attack,
 but not sort of just general,
 general let's see what we can pick up with our antenna attack.
 But these VPN routers,
 my hope was that we'd be able with a Windows machine
 to connect to a VPN router.
 Well, it turns out that Microsoft has deliberately chosen
 to stick their head in the sand
 and not support the protocol
 in their built-in Windows client that everybody else does.
 Microsoft supports this L2TP,
 this layer two tunneling protocol,
 which is incompatible with just standard IPsec VPNs
 which is what all of the endpoint routers support.
 So it turns out that my search for the holy grail,
 that is no software installed in a laptop
 and you can connect to your VPN router at home,
 is deliberately not possible
 using just standard Microsoft client.
 And why would they do that?
 Is there a compelling reason to do that?
 I've got some links in our show notes,
 which in the episode notes,
 that show them defending this position
 for like page after page after page.
 It's like, no, we don't believe
 that this is that the standard yet exist, blah, blah, blah.
 It just goes on and on and on.
 It's like, okay, Microsoft,
 if you don't wanna do it, just say so.
 For whatever reason, they just don't wanna do it.
 So as far as you can tell,
 there's really no legitimate reason.
 It's just they don't wanna do it.
 I'm sure there's no legitimate reason
 because everybody else has
 and everybody else is interoperable.
 Now, if you had a Netgear router
 or a D-Link router or a LinkSIS or any router
 that really offered good peer-to-peer VPN endpoint support,
 which is what any of these VPN routers do,
 they offer, unfortunately it's not free,
 but it is very nice.
 They offer inexpensive clients,
 about $39 typically for the Netgear, the D-Link,
 or the LinkSIS.
 In fact, I think LinkSIS's client may be free,
 but it wasn't clear from their site.
 They have something you can download for free.
 It may be, it may be that it's available,
 although I don't know how interoperable it would be
 with other manufacturer's systems.
 - So they have this router, I put it on my system.
 Does it say on the box VPN router?
 Does it say yes?
 So I should look for that.
 - And they're generally a little more expensive
 than the generic non-VPN routers,
 but it's about $129, $139,
 something like that.
 - Now, and then I run the software on my laptop
 at the hotel where I'm worried about security.
 It connects to my router at home.
 Now here's my big question, and this is,
 I've been trying to, you know, as in parallel with you,
 trying to set this up to make it work.
 It lets me, I understand it lets me get to my home network
 and see my machines and stuff like that.
 Can I then surf out onto the Net as well?
 I mean, can I use my internet connection at home
 to surf the Net?
 - Well, you're a member of your local network,
 and I think we talked about this once before,
 and I had not yet achieved that.
 - Yeah, it's.
 - In theory, it's doable.
 - Well, what actually put me off of it
 is that there are still some problems even with doing that.
 The problems are, first of all,
 there is a problem with using IPsec
 through any Net routers,
 because the IPsec technology inherently,
 by design, protects its packets from being changed.
 It's an off packet authentication technology
 that basically signs every packet
 so that any change will be detected,
 except that Net routers change packets.
 They have to.
 That's the way they work as we know.
 - They readdress them, they change the address on them.
 - Exactly, now there are actually two,
 there are two encryption technologies for IPsec,
 one called AH,
 which is authenticated header,
 and one called ESP,
 which is, I can't remember the acronym,
 it's like, in encapsulation security policy,
 a protocol, encapsulated security protocol.
 The AH approach does include the IP address of the packet.
 Well, we know that has to change,
 so AH can never be routed across a Net router.
 However, the ESP encryption stops a little bit short,
 it doesn't change the IP address,
 it does change the inner packet address,
 so it's possible to route that.
 What happened is, people recognized that IPsec
 would not be very useful if it was unable,
 it was absolutely unable to ever transit Net routers,
 because of course, Net routers are,
 you're gonna find them in any hotel,
 any wifi hotspot, and of course, in any home environment.
 So, what they did was they created
 a next generation technology, a few years ago,
 called, unfortunately, NAT-T or NAT traversal.
 Now, this is different than just regular NAT traversal
 that we've had with packets crossing regular NAT routers.
 This is special NAT-T is the acronym you wanna look for,
 NAT-T, NAT traversal for IPsec.
 What this NAT-T does is it wraps the IPsec packet
 in another wrapper of UDP,
 the standard UDP versus TCP, the datagram protocol,
 that then allows the packet to run through a NAT router,
 for example, in a hotspot, Traverse the internet,
 come through another user NAT router,
 and then, since the protocol is recognized,
 if it's recognized, I should say, by each end,
 then this allows IPsec to work through NAT
 without any problems.
 - So basically, it's saying to IPsec,
 look, you don't have to change the packet, it's fine,
 we'll wrap it up in a wrapper that will stay,
 keep its integrity from point to point,
 then once it's inside the network, we'll unwrap it,
 and then the router can readdress it.
 - Exactly.
 Now, Microsoft silently added this technology
 in XP service pack two, so it does exist in service pack two,
 even though Microsoft is hostile for their client
 hooking up to endpoint VPN routers, unfortunately.
 However, all of the very latest VPN routers also support it.
 For example, Netgear has an FVS 318,
 like Frank Victor Sam 318, it's third version right now.
 The version three router does support this NAT T traversal,
 however, versions one and two don't,
 and unfortunately, they're not upgradable to support this.
 So if you had an earlier version of this particular router,
 you'd be out of luck, but if you've got a version three router,
 you're okay.
 Similarly, all of the current D-Link VPN routers
 also support this.
 The problem is it's very poorly documented on anyone's side,
 I had to contact D-Link and get a hold of a technical guy
 and say, okay, which of your router support this?
 You don't talk about it anywhere.
 Well, they all do.
 However, only some of the latest Netgear routers support it.
 They do have a PDF, and it shows a spreadsheet
 of what features are supported, and there's a line item,
 so they're beginning to recognize that this is an important thing,
 but it's still, it's sort of just on the emergence
 of being widespread.
 So if you want to use a Windows computer to access your home network,
 and you have purchased a router that supports VPN--
 A VPN, and now--
 It must support also NAT-T, the NAT traversal,
 so that your client can get into your network.
 There are two ways, though, that a router can support VPN,
 so you want to be clear about this.
 Routers for a long time have supported
 what's called VPN traversal, or, I'm sorry, VPN pass-through.
 VPN pass-through acknowledges the problem
 of changing the port as the packet emerges from the NAT router.
 So what VPN pass-through does is for one VPN connection,
 that is, if you're connecting to one remote server,
 the router recognizes, oh, look, this is UDP port 500,
 which is what IPsec uses for its transport.
 It deliberately leaves the port alone.
 It leaves it as 500 when it comes out the other side of the NAT router
 and puts it out onto the internet, specifically,
 so that the IPsec packet is not broken.
 So the idea is this would allow somebody working at home
 who had to have a VPN connection to their corporate server.
 It would allow them to still get a VPN connection
 to their corporate server, even if they've got a NAT router
 in their home environment that would normally break VPN
 because it's just, you know, VPN, you know, IPsec
 cannot traverse through NAT.
 So VPN pass-through is different than a VPN endpoint.
 When you purchased a VPN endpoint router,
 you've got a router that you can actually VPN to.
 It's the server of the VPN connection.
 So exactly as you were saying, Leo, you're out roaming around the internet somewhere
 and you use one of these third-party clients,
 you know, probably the same client whose router you purchase
 just to make sure that there's not going to be any interoperability problem.
 And it allows you, then, to connect to your network at home.
 I'm so confused, Steve.
 You've completely left me in the dust.
 Can we kind of boil this down to a series of recommendations?
 Or no?
 Well, OK, let's look.
 Let's get back to our original premise was I'm at a hotel.
 Yes.
 Or I'm actually-- this is perfect because I'm planning to do this.
 Tomorrow I'm going to get on a plane.
 I'm going to go to a hotel.
 What should I do at home so that I can safely use that hotel network?
 If you have a VPN endpoint router,
 that is a router that is clearly a VPN router--
 It'll say so on the box or it is wrong.
 You probably paid extra for it.
 So you may know that you have it, even if you've never been able to use it before.
 Which I have it.
 Then you will need to purchase their matching client software
 because, unfortunately, Microsoft's built-in client technology
 won't connect to an endpoint router.
 It's intentionally disabled in this L-T-P-T-P-T-2-P-2.
 Yes, they will not support it.
 They don't want to-- OK.
 They won't do it.
 For a couple of reasons.
 You could then use this client software that you purchased for about $39
 to connect to your router at home.
 Now, that would get you to your home network.
 You could then basically do anything you wanted to with very good security
 using your home network.
 I should mention, though, that you will want to use a pre-shared key
 much as we've talked about with WPA technology.
 So you have to set that up before you leave.
 You do need to set it up before you leave.
 Now, the other problem is-- and this is why I haven't pursued this all the way--
 is it turns out that ISPs or hotels can be--
 Could tell me they block the port?
 Yes.
 That's the problem with this failing the Holy Grail solution.
 Also, aside from needing to buy additional software,
 because you're using standard IPsec or point-to-point tunneling protocol
 ports, 1723, 1701, 500, those could be administratively blocked
 if, for whatever reason, someone didn't want you
 to be using VPN within or through their network.
 Do you think they're commonly blocked, is that?
 Yes.
 And in fact, I know that they are because I've run across sites
 which are trying to offer this as a service.
 And they say, well, if PPTP doesn't work, try using IPsec.
 Hopefully, one or the other will.
 Now, PPTP won't work if you're trying to use a Windows box,
 because you'll have to use the LP2P, which Microsoft prevents.
 Well, it turns out that we've mentioned, kind of--
 we've mentioned one nice-looking service called PublicVPN.
 PublicVPN.com.
 And it's something I would recommend for people as a possible solution
 for sort of, you know, in this myriad of solutions.
 It's inexpensive.
 It's $5.95 a month or $5,995 for a year.
 They're running servers that support Microsoft's PPTP
 and this level 2 tunneling protocol, L2TP/IPsec.
 What it means is that you need no client installed.
 They support all Windows platforms and the Mac platform,
 allowing you to create a secure connection to their server,
 which would get you out of the danger zone.
 If you were in a hotel, for example, Leo with your Mac,
 for $5.95 for a month, you could get an account with them
 and connect to them, getting your traffic encrypted
 as it leaves the hotel's land, travels the internet to them
 where it would be decrypted and dropped out onto the internet.
 And it uses SSL so it's unlikely to be blocked?
 No, it uses-- and that's why, again, it's probably not
 a great solution for someone traveling a lot
 because it does use the standard PPTP and L2TP blah, blah, blah.
 But it's there and we've talked about it before,
 so I wanted to wrap that up when we were specifically talking about it.
 There's another one called Hot Spot VPN that might be as relaxed.
 How about that one?
 It's less expensive.
 I'm just opening a dialogue.
 Actually, it's more expensive.
 They have a special of $88.88 per month at the moment.
 Otherwise, it's like $11 or $13 or $50,
 depending on how many bits you want your key length to be,
 which actually is pretty hokey, since even $128,
 the key would be fine.
 These people are an SSL-based VPN,
 but I haven't yet finished my dialogue with this guy
 to figure out exactly what it is they're doing.
 So--
 No endorsement yet, but we're looking at it.
 Yeah, no endorsement yet, but we'll come back to it.
 Ultimately, Leo, you and I are going
 to take a look at this open VPN service
 and another one that I have found called Hamachi,
 which both look like they're very interesting solutions.
 Not merely yellow-tailed tuna.
 It's a VPN solution.
 Exactly, OK.
 However, for the sake of completeness,
 for people who have VPN endpoint routers
 want to know how to use them, I can guarantee them
 they cannot connect with a Windows client.
 They need to purchase the client from their supplier.
 Because that is the net traversal.
 Yes, because-- and also, they need to make sure they have either
 updated their firmware or that their particular VPN endpoint
 does support the net traversal, otherwise they absolutely
 won't be able to connect from a hotel.
 And even if it does, they are subject to the VPN packets
 being filtered by policy, by the hotel.
 Or for example, maybe somebody wanted
 a VPN from their corporate environment to their home
 to get a file or to check up on their systems there or something.
 They might well find that their corporate firewall is blocking
 outbound VPN connections, even while allowing incoming VPN
 connections from people that were outside that the corporation
 coming in as a corporate policy, they might be really locked down.
 So there are problems with standard VPN technology
 being used all over the place, even if you've got a VPN router.
 I'm still aiming at coming up with a better solution.
 And that's what we're going to talk about next week.
 Good.
 I'm exhausted.
 OK.
 So I just want to recap so that people aren't completely
 left in the desk.
 If anybody's still listening, they're very brave.
 Because this was complicated and had a lot of acronyms in it.
 It did, although based on the feedback we've had,
 this is the discussion people want,
 because they want to understand the limits
 of virtual private network.
 And we all want to solve this problem of how do I use a network
 at a hotel safely.
 If you're not clear why we want to solve this,
 listen to some of the earlier episodes, particularly
 at the episode 14, where we really talk about why it's just
 not safe to use a hotel's--
 Well, and Leo, in all honesty, we haven't yet really
 explained the danger.
 I don't want to really do that until we have some solutions
 in place.
 It's worse than you think.
 You mentioned ARP poisoning, and it's a horrible problem.
 OK, OK.
 Don't because you're going to scare people.
 You're going to scare me.
 I got 10 days on the road coming up, hotel access
 for the all 10 days.
 OK.
 And you still have not found the holy grail for me.
 And I've been trying all these solutions.
 SSH tunneling and open VPN, and then so forth and so.
 Well, all right.
 And I'm a worse because I'm on a Mac.
 Does that make it worse or better?
 At least I don't have to deal with Windows blocking IPsec.
 True, the Mac does support PPTP, although it turns out
 that that is subject to a man-in-the-middle attacks.
 It has no strong, useful authentication,
 and it has been cracked by various tools
 that are able to insert themselves.
 And in fact, we're going to show how easy that is to actually
 do in the real world.
 We're going to get the solution, but we
 need to create a nice foundation here first.
 Oh, it's so frustrating.
 That's good.
 So I understand people really want to know this,
 and it was complicated, but we're
 laying the foundation for why.
 We've ended up choosing something else.
 We have to go to a particular--
 Yes, exactly.
 And it's just interesting.
 All right, so thank you very much, Steve, for explaining this.
 And as difficult a subject as is, even a dunce like me,
 I think I've understood it.
 If you want to know more, the show notes
 are available at grc.com/securitynow.html,
 and they are very helpful for kind of hallucinating this,
 because you've got pictures, you've got a graph.
 It makes it just much easier to understand.
 Yes, and in fact, for this episode,
 I have an extensive list of links that people can poke around
 at if they want to fill in the gaps.
 And thanks to Elaine, who's going to transcribe all this
 and make sense of it, you can even reread it slowly.
 And maybe reading it out loud with your mouth moving will help.
 I had one person named Andrew posted a comment.
 He said, wow, your podcasts have really picked up speed.
 I got a kick out of that.
 I thought that was a nice analogy.
 Does he mean they're getting more complicated?
 I think they've really got his interest.
 Good.
 And we're not always going to do this kind of high level stuff.
 We're going to mix it up.
 But frankly, this is an issue for everybody.
 Everybody has to solve, and you know, we will get--
 what do you think the next episode will finally
 get this holy grail thing?
 Yes, we're going to talk about the very interesting cross
 platform solution called OpenVPN.
 People who want to do a little research ahead of time
 can put OpenVPN into Google.
 They'll find a ton of links.
 It's a very popular looking solution.
 But it's not zero configuration by any means.
 Right.
 I know.
 I've been trying, and I can't figure it out.
 And who knows?
 It'll happen in seven days.
 We could find out.
 There's a horrible hole that will define something else.
 If you want to read those transcripts,
 that Elaine works so very hard on.
 Of course, again, grc.com/securitynow.htm.
 Steve also hosts 16 kilobit versions of this for easy download.
 And we have decided that we're going
 to put together some audio CDs of the year
 as when we get to January so that you can buy it as a portfolio
 and give it to your favorite IT person.
 We'll let you know about that.
 If you want to listen on AOL, we're
 on part of the AOL radio on the podcast channel.
 So tune in there.
 We thank AOL for providing that and for providing
 the bandwidth for security now.
 All right.
 I have a plane to catch.
 Steve Gibson, thank you very much.
 I really appreciate your explaining this and all the work
 that you must have to do to understand it yourself.
 It's--
 Thanks, Leo.
 It's a tangled web.
 We got you next week.
 That's it for this edition of "Security Now."
 [MUSIC PLAYING]
 Security Now.
 [MUSIC PLAYING]
