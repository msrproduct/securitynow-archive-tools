 Bandwidth for Security Now is provided by AOL Radio at AOL.com/podcasting.
 This is Security Now at Steve Gibson, Episode 47 for July 6th, 2006.
 Internet weaponry.
 Security Now is brought to you by the Starro, makers of the Starro Security Gateway, on the web at www.astarro.com.
 Steve Gibson and his magic mustache are back on Security Now.
 Somebody suggested, you know, we have those little pictures of ourselves next to each posting on this week in Tech website.
 And my, I wink, and Alex's eyebrows go up and down.
 Somebody suggested we should get your mustache to go up and down.
 Well, I'll tell you what's happening to it is it's turning more gray.
 We could fix that.
 We can un-gray that.
 We have the technology.
 First, I was thinking, that might be toothpaste, but no, it's definitely not toothpaste.
 It's one of those milk mustaches you have.
 Well, I will nitrous act and snaggy of the Joy of Tech.
 A wonderful Joy of Tech comic strip do these for us at joyoftech.com.
 And I'm sure I get nitrous act to, to, to maybe put a little more black, do a little, uh, Grecian formula.
 I don't mind being un-retouched, that's fine.
 You're, you're not, you're not as gray as a picture, actually.
 So we'll have to fix that.
 Okay.
 Yeah.
 So today we're going to talk about it.
 I think a fascinating subject you call internet weaponry.
 Well, yeah, I want to talk about botnets, as they're called, and the evolution of true internet weaponry, which is
 unfortunately what exists today on the internet, and it is highly effective.
 Much more effective than Kim Il-jong's missiles.
 And it's unlike them.
 They're aimed, this internet weaponry is aimed at you and me and everybody.
 Well, the internet, it's aimed at anyone.
 They, that the controllers of the weaponry choose to aim it at.
 It's extremely difficult, if not impossible to hide, and it has unlimited range.
 Unlike Kim Jong Il's missile that lasted for 35 seconds and then sputtered out.
 So what, when you say internet weaponry, what are we talking about?
 Well, this all began about eight years ago, um, sort of toward the end of '98 and, and in 1999 with, um, sort of the, the
 general prevalence of the net and, and machines on the net, the very first recorded attacks were Unix-based machines in a, in, in a network where,
 because, because always the idea was that you needed to generate a lot of bandwidth.
 Now, attacks have increased and we're talking denial of service attacks using a lot of packets, internet packets, basically to swamp either the receiving machine or the machine's
 connection to the internet.
 The idea being that, that any given internet connection has a certain speed, you know, a modem is 56 K DSL might be 384 K cable
 modems, you know, maybe you're able to receive, for example, a megabit, but, but whatever that rate is, that sets basically the, the total amount of traffic that is able to fit down that connection at any given time.
 So, so if more than that amount of traffic is being sent into sort of like the front of the connection, the, if the, and the connection is only able to carry a certain amount.
 Some percentage of packets will be dropped.
 The, the, the router that's trying to, to saturate and, and force as much data down the connection, whatever its speed, the, the router's own buffers will overflow and its strategy is simple.
 I, I just dropped what I can't send and as we've talked about in prior episodes, the, the internet's protocols are robust in the face of dropped packets because it's,
 it's understood that this is all very, you know, routers forward what they can and in the best direction they know how to, but packets will get lost.
 And so the TCP protocol has a, has a whole acknowledgement system and a retransmit logic protocols like UDP that don't have that built in their applications like DNS knows to make a, to resend a request if it hasn't received a response.
 So the notion of packets being dropped is something that the internet can deal with.
 The problem is if, if somebody, for example, were flooding a, a DSL connection that can handle 384k, if they were flooding it with 384 megabits, that is a thousand times more than it can handle, then, then there's very little chance one in a thousand
 for your good packets that is the, the, the valid packets you would like to receive down your DSL connection, there's, there's very little chance for them to compete against this flood of, of attacking packets.
 And, you know, the attacking packets are nothing really, but too many.
 They're just too many of them.
 And the router has no way of knowing in a properly designed attack which packets you want and which ones you don't, they all look the same to a router.
 So it just, you know, it just sends what it can onward and drops the flood basically.
 So, so it's not that the denial of service attack is all getting through to you and like overheating your, your DSL modem or something.
 It's that, that, that you see a denial of service because the valid traffic can't compete statistically against this flood of, of attacking traffic.
 We're just trying to get through.
 So, so backing up a little bit.
 It's essentially it's a bottleneck really.
 Exactly.
 It is a bottleneck happening somewhere.
 Yeah.
 Okay.
 And, and the other, the other, the other troubling thing about this is that the modern denial of service attacks, so-called DDoS, DDoS, D, the first D standing for, for, for distributed.
 The idea is that, that thousands and, and in fact today, even tens of thousands of, of machines scattered far and wide across the globe are, are being controlled centrally and all instructed to, to launch their, their traffic.
 Some, some attacking traffic towards a certain point.
 So that's the key because otherwise, if you just had one machine trying to do this, it wouldn't, it wouldn't have enough bandwidth to really flood the, the, the opponent.
 Well, that's a perfect example.
 For example, say that somebody on a cable modem was attacking, some one person on a cable modem was trying to directly attack some other person on a cable modem.
 Well, as we know, cable modems tend to be asynchronous, asymmetric rather bandwidth.
 You can download maybe a megabit, but you can only upload maybe 250K, or 256, so like one quarter of that.
 So the idea is, if one person were trying as hard as they could to attack another, well, their maximum upstream or outgoing bandwidth would be 256K or 250K, for example, a quarter of a megabit, which is one quarter of what you're able to download.
 So you could, you could accept that attack down your connection and still have three quarters of a megabit, that is three quarters of your total bandwidth available to you for, for the, for, for valid traffic.
 So you might notice that boy, you know, my, my cable modem or my DSL modem used to light used to be flickering or normally flickers.
 Now it's on steady, but you would still be able to use your internet connection because it wouldn't be flooded and your, your traffic would be able to get through.
 And even if, even if now, say four attackers combined their bandwidth and they were each a quarter megabit, well, now there'd be one megabit of attacking traffic competing with potentially one megabit of your valid traffic.
 And you'd probably, it would feel like a slowdown, it would feel like, okay, something's wrong somewhere, we don't know where or what, but boy, my connection is smoking, but I'm still sort of still connected to the internet.
 So it's, the idea is it's a, it's a matter of scale, it's a matter of how big the flood is that it's competing with valid traffic.
 I'd also like to just point out, because we got a couple of emails about last week that we're talking a particular denial of service attack, a flood denial of service, there are other denial of service attacks where you take advantage of exploits or holes, and that wouldn't require the same amount of bandwidth.
 That would just, in fact, you could, as somebody pointed out, you could do it with a, with an attack every five minutes because it would bring the machine down each time.
 Well, and I saw those postings over on the, on the twit side also, there was one, I mean, that posting brought up a very good point, which you've just made, which is that there are attacks which are not about floods.
 The, the classic one, I just love what was, it was called the Ping of Death, and it was a, it was a fault in early versions of Microsoft Windows, where you, if you sent it a ping, if you sent the machine, a single ping packet, where you had spoofed the source IP to be the same as the destination IP, that is, you, you, you, you sent a packet that said,
 this is a ping from you to you, the machine exploded, not literally, not literally, of course, but I mean, Windows didn't like it, right?
 But it's so funny, well, because it tried to reply to itself, and it didn't understand, and it got in a total loop, and, and the, the, the stack got unhappy, and the processor performance went to 100% utilization, and basically the system just ground to a halt completely,
 because at a very low level in the operating system, it was, it was continually trying to, to respond to its own ping, essentially.
 Yeah, there's a numerous attacks like that, but that, we're talking about the, the other, the denial of service that comes from basically a flood.
 Well, yes, and the problem with those other types of attack is they've all been resolved over time.
 That is, exactly, for example, Microsoft realized what was happening, and they, they fixed the problem in their stack that would, that would cause that to, to bring the system down when it received one bogus ping packet.
 And, I mean, and there are many other types of, I mean, very tricky, sophisticated, very clever attacks in the past.
 The, the original denial of service attacks against servers were, were not banned with the tax per se, they were, they were TCP protocol attacks, a so-called sin flood.
 What happened there was that, as we've talked about TCP connections before, the first packet to arrive at a server is a sin packet, short for synchronize, which is the client saying, and requesting a connection with the server.
 The server, um, sets up some resources at its end to accept the connection, then sends back a sin-ac packet to acknowledge the receipt of the sin and to send its own synchronization information to the client.
 And then the client responds with a, with a final third packet to, which is called the, the three-way TCP handshake.
 Well, the fact that the server receiving the single sin packet allocates a bunch of resources that is memory allocations on its end in order to begin to set up and get ready for the connection, clever hackers figured out, "Hey, what if we just send a whole bunch of sin packets to the server?
 It's going to end up expecting a whole bunch of, of connections which never arrived because we're not actually establishing a TCP connection, we're just saying we are."
 And so, so even with relatively low bandwidth, the early servers, which were not hardened against this kind of attack as virtually all servers are now, I mean Windows XP has this, this built-in, um, it turns out that, um,
 Linux and now Unix's are getting this technology where they're much smarter about, about what they, what resources they allocate upon the initiation of a TCP connection.
 So, so it's not, it's not any longer possible to bring servers down with, with a relatively small trickle of sin packets.
 So, so we...
 Not that some other exploit might not come along. I mean, there's plenty of bugs still to be found, no doubt.
 Oh, absolutely. And so, you know, you're right. They're, they're, there could be anything else. Right.
 But, but the, the, the evil elegance, if you will, of, of what happens with a, a true flood is, is that they're just, I mean, it's, it's fundamentally overloading the Internet's way of operating this.
 And there's no way to defend because it's not a, not a flaw in the Internet. It's taking advantage of the way the Internet is supposed to work.
 Correct. In fact, an analogy that I like that I think I've used, um, here, when we were talking about this briefly before, is a magnifying glass.
 If you put your hand out on the sunlight, it feels fine. It feels warm, you know, not a problem. Hands were designed for the sun.
 Right. And so, putting it out, there's not a problem. But, if you hold a magnifying glass at the right distance, oh, there's not a problem.
 But at the right distance over your hand, the same amount of radiation from the sun that was beforehand covering, before hand, before, which was previously covering your entire hand is now focused down to a single point.
 And now you've got a problem. That hurts a lot. You've got, you know, burned flesh and blisters and, and other horrors just from taking that normal amount of sunlight and focusing on a point.
 Well, the, I love the analogy because it really fits with the Internet. There's, you know, 10,000 computers are not causing anyone any problem when they're all just surfing the web and browsing around and uploading and downloading files.
 But if those same 10,000 machines all do the same thing, that is all focus their attention down to a single spot, that spot is in trouble.
 And of course, the non-malicious sort of corollary to this is the, is the, is the so-called slash dot where, you know, and I don't know if it's even still so true.
 Now it's called the dig effect. The dig effect. Exactly. It's where, you know, a whole, some, some highly popular site refers to some other site.
 And so suddenly that, that server is overwhelmed by valid users who, but too many valid users who all want to bring up the same pages at the same time.
 And there just isn't enough power in the server or bandwidth in the connection or whatever. And so, you know, you're digged or slash dotted or something.
 Right. Right. So it's a legitimate attack. I mean, I mean, not attack, but it's a legitimate traffic. So you can't say no.
 True. Well, and so, so back from about 99 is where we began to first see this happening that there was a youngster 15 years old named a mafia boy in, in, I remember the name.
 Well, because it made a lot of press at the time. And this was really the first indication that the world had that, you know, things were not quite as good on the Internet.
 As we thought, in February, he attacked Yahoo and brought Yahoo down and Dell. And you remember eBay going offline?
 Amazon.com was hit as was CNN. One kid did this. One kid. And it was estimated he caused about $1.7 billion of damage.
 Overall, from, from, from bringing these, these serious e-commerce sites that really depend upon being on the net in order to function.
 Every minute down costs some money. Yes. Did that catch him? Did they find out who he was?
 Yep. He was in Montreal. He ended up pleading guilty to 55 counts of criminal charges and served eight months in a youth detention center.
 Not enough. And I don't know, but I would imagine very much as was the case with Kevin Mitnick that he's probably not allowed to touch a computer these days.
 Either that or he's got a very good job with a security firm. Yeah. Well, and so, so those, of course, were, were the, you know, and so now we're talking, we're talking six and a half years ago that, you know, these really high profile attacks brought to everyone's attention.
 You know, that they don't, this could really happen. The other thing that happened was these attacks brought it to a much wider attention of, of other, of other young people on the net, you know, so-called script kiddies or, or, you know, young hackers who were often using IRC.
 IRC chat was, was like a place where they hung out and talked and, and told stories and, you know, swapped software and, and URLs and things.
 And there's a, there's a funny, the way IRC works. Internet, IRC stands for Internet Relay Chat.
 The way it works is that you, you can often have a, a channel operator, an IRC operator who's sort of like the ruler of the channel.
 And that person is able to kick off, just, just unilaterally kick off or ban anyone that they want to because, you know, they're in charge of the channel.
 Well, that caused fights among teenage hackers who were, you know, exactly, who, who were not appreciating being knocked off of their, of their, their, their, their connection.
 So there were little squabbles that would form an IRC. Well, what, what ensued was the development of the, the sort of the first personal denial of service attack tools, the so-called bots, which, which, which you know,
 which, which, which these, these young programmers would develop often writing them in visual basic or sometimes in C. There were source code floating around the net that they could use to sort of get started.
 And so it was, it was what they did after school was to build these, basically these, these, these bots whose purpose was to attack typically other people on IRC.
 Because if you are disconnected from IRC, you lose your privileges. Or the way IRC works, it's a, it's a network of servers.
 That's what's called internet relay chat. The servers will relay messages from one server to the next.
 And, and it turns out that if a server is attacked, it will split the network. There aren't redundant connections among servers.
 So if one server is attacked, it can fragment this, this so-called the IRC channel. And you can end up with a server that doesn't have any leader on it.
 You then join that server, stop the attack. And the way the IRC protocol works, when you, when the servers reconnect, they merge the users.
 And briefly, you will have two operators allowing one to kill the other. So, man. So, so what happened was, I mean, they really became this culture of, of blasting each other off the net in order to sort of play king of the hill.
 Within these IRC domains, which became important social structures for, for young kids who were, you know, hanging out on IRC in the afternoons, after school and in the evenings.
 Well, one thing led to another. And then it became, okay, my bots are stronger than your bots. My, you know, my bots can, you know, I can blast off anyone off the net and so on.
 Well, the problem is that the, the, as we've seen before, what you need in order to have a strong attack is more bandwidth. More bandwidth means more machines.
 So, so the second order phenomenon that, that then began to happen was that, that this bot code was then stuck in viruses, actually installed through IRC using very powerful scripting languages.
 A naive IRC users would ask for help. And, and somebody would give them instructions that would, in fact, download a Trojan, which is really what these programs are. These bots are Trojans.
 They would download these, these Trojans into their machine. So, one way or another, the motivation was to spread one person's bots out on innocent victims' computers as widely and with it.
 With this, with, with as high a concentration as possible. So that, that became the next game was seeing how many bots you could get in a so-called bot net or, or bot network.
 And, and again, the, the sole purpose of these things at this time, and this is before these Trojans and, and bots became spam sending. That, that happened afterwards.
 The sole purpose was to generate a bandwidth flood aimed at a single point that would blast typically someone else in IRC off of IRC.
 And, and the other really interesting thing about this is that the bots themselves used the IRC system. And, in fact, today they still do in order to receive instructions.
 The idea would be that the bots would be built with some domain name in them. And, and someone running a bot net would, would create a, would use a dynamic DNS system in order to, essentially in order to cause all of his bots using a, whatever domain name he'd come up with to, to connect to a server at a certain IP.
 The, the tricky thing is since, as we saw before, IRC is internet relay chat. The, the, the perpetrator or the, the master of this fleet of zombies doesn't himself need to connect to the same computer or the same server.
 He need, he just connects to internet relay chat and, and connects to the same channel. And all of his commands will be sent anonymously relayed from one server to a next.
 Well, this is what's made it so very difficult to track the operators of these networks down. Because, I mean, it's, it's very much like email, which is relayed from one email server to the next.
 However, in the course of email, of course, each server, a pen's headers as, as we've seen in order to allow you to backtrack where your mail came from, not so with the internet relay protocol.
 So it's extremely difficult to find out who's behind a fleet of bots.
 If you were going to invent really a service, an internet service that was designed for hacking from everything you've told me so far, it'd have to be IRC. I mean, it's, yes, it's just a perfect test tube for all this stuff.
 Yes. It's really phenomenal when you look at it from that light. I mean, as you said, Leo, it is a perfect, it's a perfect medium for, for, first of all, for creating anger among people, you know, who are there.
 And everybody knows everybody's internet address. Yeah. I mean, it's, it's really remarkable.
 Exactly. And in fact, the, the, the protocol, the IRC protocol is documented in some RFCs, although no server really follows it completely.
 But then what's happened is very powerful clients. M IRC is one of the most popular IRC clients. Very popular and very powerful clients have arisen.
 Oh, yeah. Which, which you're able to do scripting to. You can customize it. You can do all kinds of things. And in fact, there are, there are benign bots within IRC that are used for good, good purposes.
 I have a Leo bot. We use bots frequently in various chat rooms I've been part of. Right. I mean, it absolutely makes sense to have to have a presence there and maybe like have an auto responder bot. Exactly.
 That will send back a message when it receives one. So, so what we have now and, and what has evolved over time are very large bot networks.
 And I mean, truly tens of thousand networks large. And I have had the privilege sort of, I guess it's a privilege to, to get involved in this years ago when GRC was, I guess,
 originally attacked the very first denial of service attacks, which were launched in exactly this fashion. I ended up, you know, spending a lot of time reverse engineering this, figuring out how it works.
 I remember surreptitiously joining after reverse engineering a bot that I received, surreptitiously joining the, the, the channel that this fleet of bots were in.
 Just watching them when someone joins an IRC channel, they're, they're basically announced as, as, as coming. And when they leave, they leave.
 Well, if you just sit here watching one of these private bot network channels, you constantly, yes, you constantly have new machines announcing themselves joining the network and other machines leaving.
 And, and so what's happening is some automated. I mean, there's no human involved at all. This is correct. Well, exactly somewhere, someone, some innocent person turned their computer on and connected it to the internet.
 And behind their back, this Trojan that had been installed through some actions they took, whether it was surfing to a website, exploiting known security vulnerabilities, opening an email attachment.
 I mean, every conceivable way of getting software in, I mean, this was sort of the first spyware or really malware that was, that was aimed really targeting people's machines.
 The whole, the whole commercial side, the ad aware and, and ad aware stuff, the, you know, cool web search and all those things, those, those ended up sort of happening around the same time. But this was purely malicious in intent.
 And all the techniques that, that, that, that they, that the young hackers could come up with for getting this stuff installed in people's machines is what was used. I mean, so that, so that individual, individual hackers would have tens of thousands of machines that their own customized version of this bot Trojan had infected.
 And so at any given time, some percentage of those total number of machines that were carrying that Trojan would be online and automatically logging themselves in to this IRC chat channel.
 And what's chilling is they're, they're there reporting for duty. Yeah. Yeah. I mean, they're, they're logging in saying, okay, I'm ready to receive commands.
 And I will master. And so exactly. And so somewhere, if this hacker chose to take pretty much anyone down that they wanted to, knocking them off the net and holding them off for whatever period of time they chose, they log into a different server.
 Use a password that only they and their bots know because you're able to password protect these channels and you're able to hide the channels, log into a hidden, which raises the issue. I mean, if you saw this channel, can't the FBI just find them and kill them?
 Yes. I mean, and, and presumably that's going on all the time, but all they have to do is, you know, edit their code, change the channel and re-infect a bunch of machines. It is actually, I remember years ago, seeing some, some statistics about the rate at which a new bot would would infiltrate people's machines just through common user actions.
 I mean, you know, that kind of actions you don't want to have be common, but, but people not knowing better. And so somewhere this hacker connects to a different server joins the hidden channel that his bots are a member of and issues a command.
 The IRC system forwards that, that basically it's just, it's a command, but it's a comment like any other posted in into a chat room forwards that chat comment through the system bouncing through any number of servers until it reaches the one where the bots are congregated
 that they're all checked into and they don't even have to all be congregated at the same server. There are also distributed bot networks that are smart enough to have a number of domains that they'll randomly choose so that they're not all congregating at the same server.
 I mean, this stuff has become, you know, through a process of successive refinement from, from the hackers comparing notes and hey, how are you doing this? Oh, that's a good idea. I think I should try that too. There, I mean, for them, it's a game. And so, so what we have today is true destructive force, or as I call it Internet weaponry, weapons mass chatbotry.
 Well, yes. And, and in fact, in July of 2002, you may remember that the RIA was also off the net for many days, often on, in fact, it was, you know, it was very problematic for quite a while because they had, the RIA had, you know, there are wonderful recording industry association had strongly endorsed
 some very, very strong anti peer-to-peer file sharing legislation. And so in retaliation, one or more, we don't know, you know, to this day, as far as I know, it was never tracked down, one or more people who objected to that RIAA policy just said, okay, we'll show you who's boss of the Internet.
 It was really running into the show, yeah. And just blew the RIAA's website down and held it down for quite a while.
 How big are these nets? How many do you have to have, how many co-opted machines to be effective? And what are the defenses against these things? That's three big questions, I know.
 Well, I know that Mark Thompson has told me, he has a friend with a major bandwidth provider network that has seen attacks of nine gigabits.
 So, I mean, nine gigabit attack. Now, there's very few pipes that could survive something like that.
 Oh, yeah, I mean, that's a serious, a serious debilitating attack. So, say for the sake of calculating in our head that a typical bot on a cable modem, oh, and by the way, those are called cable bots, because you want to hit you cable bots are better than modem bots.
 You know, modem bots are lame. No, first of all, they're not connected very often, so they're not often participating in the fleet.
 You need it always on high bandwidth connection. That's really what you want.
 So, say that we had upstream bandwidth from an infected machine of, as I was saying before, like 250 kilobits, a quarter megabit, okay?
 So, four of those would be a megabit. 4,000 of those would be a gigabit, which means 6,000 machines.
 Yes. Oh, even if you were more conservative and said half that, it would still be 18,000 machines.
 There was one huge net. One bot net found of 100,000 machines. Wow.
 We controlled a single controlling individual with 100,000 machines.
 Now, are these always created by a virus? I mean, is that the only way to effectively create something like this?
 No, it's anything you can do to get it. The bots are communicating Trojans.
 It's a Trojan, which gets installed into a computer, arranged to automatically start whenever the machine is booted.
 And the first thing it does is try to roll home. You join the net, you join the net, report for duty.
 And so the idea is that any techniques which can be used to get code running in someone's machine has been done.
 So, any security flaw, presumably these bots could then be instructed, well, okay, here's some code.
 Execute it, try to find more recruits. Try to exercise them.
 A perfect example, for example, are the internet worms that we saw, like code, red, and nimda and so forth,
 that were very successful at propagating themselves.
 Now, their only interest was in their own propagation, although they also, in several cases, opened back doors
 and left back doors behind that then allowed their machines to be taken over remotely.
 But they weren't bringing along any other, like, remote control bot technology, although, of course,
 the famous code red did have, and in fact, many of them had time delay attacks where they would launch attacks on a given website.
 Remember, there was White House.gov was targeted, Microsoft's security update service was targeted.
 So, they had their own malicious intent, but they were not remote control trojans that they were disseminating.
 So, in general, email attachments, sort of shady websites that will use known vulnerabilities,
 or just somebody saying, in fact, this is one of the famous ones, here is a free utility that will speed up your internet connection five times.
 There were a lot of people who just jump at that.
 Absolutely. It's like, "Oh, my internet connection really needs a five times boost, so they'll download it and run it."
 And maybe it, like, it says, "Oh, your connection is already optimized. Thanks for coming by."
 Or, you know, "Or might pretend to be doing that. What it's really done is install something malicious."
 So, you know, we've said before, and this is a perfect reason to say again, really only download things from well-known,
 high-reputation websites. You know, SNAP files, CNET is going to be, you know, checking the files that they're offering and making sure.
 I mean, and they specifically say they've checked them for bots and viruses and trojans, and these files are clean.
 But, you know, you really need to be cautious when you download something that seems like it may be too good to be true.
 It probably is.
 And so, okay, so that's the size that you need. That's how they get them.
 Now, how do you define it?
 Well, the final step in this, and we'll talk about defense in a second, in the evolution of this has been doing this for profit.
 And that really changed the complexion of internet attacks.
 Somebody realized, "Hey, if Mafia Boy was able to do $1.7 billion of damage to those companies,
 then wouldn't they have been willing to pay something beforehand not to have suffered that damage?"
 Even 10% of that would be, you know, plenty of money, 170 million. So what people realized was,
 due to the evolution of the net, and specifically, the prime target have been online gambling websites,
 there are now companies whose livelihood really depends upon being online,
 especially, for example, in the case of online gambling sites around the times of major sporting events,
 which the sites tend to specialize in horse raises, boxing matches, matches, whatever.
 And so, what has happened and is now happening is there are extortion rings that seem relatively well organized,
 which will contact a website's owner or owning company and say, "Hi there, we'd like to sell you our protection services."
 Oh my goodness, this is a traditional protection scheme.
 That's exactly what it is. It is exactly that. And if you pay us $10,000, we will arrange not to have your site attacked.
 During the upcoming, you know, blue chip horse race, or who knows what.
 The truth is the only people they could protect against with themselves.
 Well, yes, they exactly, they're really saying we won't attack you.
 They cannot give the order to their bot fleet. It's sort of like the way Washington saves us money.
 It's by not giving us the increases they were planning, and they call that cut.
 Yeah, don't charge you what we thought we would.
 Exactly. So, very often, the first time one of these extortion threats is received, the owners blow it off.
 And, well, this is old news now. No one blows it off today who's in the business.
 But they would say, "Yeah, you know, I do only think it's going to be that bad, or I've got big servers, or I've got a big pipe,
 or I'm paying extra for super strong networking, whatever."
 And, sure enough, the big day comes and they are off the net for 24 hours. Just gone. They're black.
 No one can get to them, and they're losing their customers who are pissed off that they can't get to the gambling site they were using.
 So, those customers just go somewhere else.
 And so, they realize there's a huge cost of not being on the net because those customers that they have once lost are going to be very hard to reclaim.
 So, you know, the attack ends an hour later, the phone rings, or email arrives saying, "Gee, we're really sorry.
 We were unable to prevent that. We see you are off the net for the last day while the horses all cross the finish line."
 And so, gee, I hope that when that next boxing match comes up and we contact you again to offer our protective services,
 you may think twice. And more often than not, they get paid.
 Do we have any idea how often this is happening? I mean, I imagine it's quite widespread.
 Yes. The last time I spoke to a whole room full of FBI guys, I meet with the – I can't remember what they call themselves.
 It's like a – well, it's a crime division, yeah, yeah.
 The electronic crimes guy, but it's people from the Secret Service, the FBI, and border patrol and all kinds of divisions have, you know,
 and a side to them that is concerned with electronic crimes, the electronic crimes task force.
 And I was chatting with one of my FBI friends before this, and we were specifically talking about this kind of thing.
 And what often happens is that a few months will go by and there'll be another request for more payment.
 Right. And so it's black and – Well, they never stop. Once they've got a mark, they're going to keep going.
 Yeah. I mean, and it is really a problem. Now, what's happened is, in response, these sites that really, really have to stay on the net, or they're in serious trouble,
 they've realized, okay, I guess I can't buy my bandwidth from, you know, the cheapest provider in town.
 So they've ended up hugely strengthening their connections. There are some commercial services now that have deliberately have huge pipes
 and like proxying servers to accept the connections on behalf of one of their clients.
 So they're selling Internet protective services. These websites, then they're placed behind these denials.
 I'm legitimate vendors here. We're not talking about the extortionists now.
 Yes. And I mean, it's still the case that the largest attacks are able to cause problems.
 But mostly what's happened is the cost of doing business for these people who are having now pay a serious, true technology band with provider to insulate them from these floods of packets,
 you know, their costs have gone up forever. So it's not like the Internet is a free ride for them because, you know, there is now true Internet weaponry loose on the Internet.
 Amazing. So the defense is what? I mean, how do they do it?
 Well, the problem is that we're talking about a distributed network, widely distributed, for example, 10,000 machines or as we did the math for a 9 gigabit attack, 36,000 machines.
 There's, you know, they're not all in one university. They're not on one location because of the nature of the way they are spread through websites, through email, through spam, through, through, he download this free Internet accelerator program.
 You know, everybody on the planet is going to be carrying these bots.
 And so what happens is, as in my magnifying glass analogy, packet traffic is incoming from every ISP, every major tier one provider, you know, through every network on the Internet, and at any given point, the traffic doesn't look unusual.
 It's only as it begins to converge down towards its target that, you know, the wires begin glowing and the network engineers say, oh, oh, you know, something's wrong here because we're seeing all kinds of spikes and servers and routers crashing on our network.
 So the problem is, you know, there isn't a way to practically backtrack this, and it's certainly the case also that bots could be given instructions ahead of time, so they will launch their attack if not told not to.
 And you could even have smart bots that are able to figure out, like, something posted on a web page somewhere. They could be getting their instructions from the content of a web page.
 I mean, so the problem is that it's a perfect example of the extreme sophistication and power and flexibility of the Internet is being turned against it and citizens on the Internet.
 And so because it's so widespread, you can't filter it. You can only throw a band with that at basic. Right. Now, there have been attacks which were filterable.
 For example, there was a famous attack, in fact, that we didn't talk about yet, was in late October of 2002, remember when the DNS system was attacked.
 Oh boy. That was a one hour long massive ping attack. It was just an ICMP flood. It was so strong, though. It was directed at all 13 of the main DNS servers, the so-called root servers, which maintain the master directories of domain names.
 Nine of the 13 DNS servers were brought down. Only four of the servers managed to stay on the net. And they're brought down by pings by by floods.
 Yes. Just an ICMP. Now, what's interesting is that DNS doesn't need ICMP. It's nice to be able to ping a DNS server to see if it's up and if it's responding.
 But technically, you don't need it. Right. So what could be done is filters could be put in routers far enough upstream. That is away from the DNS server so the concentration hasn't yet had a chance to become so extreme that that filter can't handle the traffic.
 And the filters could be said, "Drop incoming ICMP traffic to this IP address." And so what would happen is the distributed attack would be, well, that particular distributed attack would be stopped far enough upstream when it was still dispersed enough that individual filters could stop their portion of the attack that was trying to move through them as it concentrated.
 The problem is DNS does use UDP. And so the reason we haven't really bothered filtering ICMP is first of all, it would be a problem if DNS servers didn't respond to pings. You'd like them to do that.
 I mean, that would, you know, break. Who knows? What else? That is like checking on DNS server response times and, and Lord only knows, but, but you could, you could always attack the same protocol that the service or server uses.
 In the case of DNS, it's the UDP protocol. And, and famously, in the case of any website, it's TCP aimed port 80. So if, if an attack, for example, were using UDP, say, well, say it was like a DNS attack on port 53, but aiming at a web server, if the web server didn't need to serve DNS,
 it could just have that blocked upstream and the attack could not get through to it. But all web servers inherently have to be able to accept TCP packets typically on port 80.
 So if the attack is profiled so that it looks exactly like what your customers are doing, like your valid traffic, there really truly is no way to filter it.
 So you're essentially saying there's no defense. There really is no defense. The only thing that can be done is that, and this is what some of the commercial anti denial of service service providers have done is they could have servers connected to very large pipes,
 which accept the connection on behalf of the actual website's servers and, and respond to every single incoming attacking packet, assuming that it's valid.
 And now the problem is you have something called denial of service backscatter. Since the, since the source IPs of the incoming packets are spoofed, they're normally just random numbers.
 And it's a SIN packet. The server will respond with a SINAC packet back to the apparent source IP. Well, if it's a random source IP, this just sprays these SINACs all over the internet.
 And in fact, some really brilliant people down at the San Diego computer, super computer center, they owned a large block of never used IP space. They set up a monitoring system to watch the incoming SINAC traffic that just happened to statistically land within their big IP space.
 And they were able to track. This is so cool. They were able to track and monitor denial of service attacks occurring all over the internet from the backscatter generated by servers. They were under attack trying to respond with SINACs to bogusly addressed packets.
 So some percentage of the total traffic from a random IP would happen to have the IP in this network and also net as an efficient net that the super computer center was watching.
 So they could tell when attacks were occurring, how strong the attacks were and since the server would be sending the SINAC from its own IP, they knew who was being attacked on the internet at any time.
 And the conclusion was, it's bad. Well, I mean, there is one solution, which is to really, and I certainly think we do this as best we can, I certainly do, and I know you do, tell everyone you know about it so that they don't fall prey to these botnets that they don't get their computers zombied. Otherwise, you're at a lot.
 Yeah, well, of course, I famously made a lot of noise when Microsoft was getting ready to put Windows XP out for the first time because they were something they were adding to XP known as raw sockets, which for unfortunately complex reasons was a really bad idea and allowed attacks to be much worse than they would otherwise be.
 It's not that they weren't happening before that Unix didn't always have raw sockets that there weren't other ways to generate floods of bandwidth.
 All that was true. But XP was the dominant platform. I knew that people would be, unfortunately, installing bots and Trojans into XP, and there's no better place than a denial of a service bot wants to be than in a machine with raw sockets.
 Because it makes it so much easier for it to launch an extra strong debilitating attack. Anyway, as we know, Microsoft didn't understand what I was trying to say, and it wasn't until the MS blast worm used XP's raw sockets against Microsoft.
 They finally thought, "Ouch, we've got to take this out of XP." And, of course, in Service Pack 2 that fixed so many other security problems with XP, Microsoft also removed raw sockets and things are better today.
 So, folks, anybody who listens to this podcast isn't really likely to be a member of a botnet, but tell your parents, your friends, your less sophisticated acquaintances don't open email attachments.
 You know, do all the security things we talk about day in, day out, you know, update your system regularly, make sure you apply all the critical updates.
 And, you know, don't open attachments, don't have a good antivirus, be careful. And then, I guess, if they have been abotted, in many cases, an antivirus scandal detected.
 But, of course, if they've used a rootkit, they may be completely invisible.
 Yeah, I guess bottom line is, I mean, people sometimes believe that I'm an alarmist, that I'm raising concerns that are above the level that the threat requires.
 And, you know, my position is, hey, I'm just explaining what is. I'm just saying this stuff is happening, it does exist, malicious programs are on the net that can be downloaded that will do what this says.
 So, it may be too late once, you know, if there really is a massive problem, that's too late.
 Better to raise the alarm now. Well, to me, it doesn't seem like this is escalating any further. I mean law enforcement has been successful in tracking down a lot of these people.
 The one glitch in the extortion racket is that somehow money needs to go from the company that's been extorted back to the extortors. And Western Union has been used often in order to sort of try to create some sort of not easy to follow trail.
 But the problem is, with more and more governments cooperating now with this now becoming a widely recognized problem, you know, when it used to be five years ago, you would talk to somebody and say, I need help, you know, tracking down an internet attack.
 They'd go, huh? Now it's like, oh, yeah, sorry, you hear that, you know, you've got a client who's got a problem.
 I mean, you know, now it's understood. So there's a lot more cooperation. And so certainly it's difficult for these extortions to get paid, though, apparently there are still ways because as far as I know, it's still going on.
 Well, I'm actually as bad as that is, more concerned about the vulnerability you described in the DNS system. And while nothing bad, really bad has happened yet. They've obviously made some noises indicating they could do it.
 Well, it's absolutely the case that if DNS were, if all the servers were held down long enough, see, that's the thing. This one hour attack frightened people in the networking community because it was very clear then that DNS could be held offline.
 The problem, though, is that DNS servers are also distributed and they cache all their addresses locally. So typical, you know, Amazon.com, my own GRC.com, eBay, whatever, those addresses are widespread.
 And only when they expire in a local server's DNS cache, is it necessary for that server to go and update itself? Typically, that's a day.
 So you'd have to hold all the DNS servers down and off the net for a day in order for the DNS history, for the DNS caches widely distributed among the millions of DNS servers that are owned by ISP and in some cases, individuals for their caches to drain and for them not to be able to then get themselves refreshed.
 So, I mean, it's hard. On the other hand, it would bring down the net. The entire net would basically come down. I mean, IP addresses would still work, but who knows anyone's IP address? We all use DNS.
 That's why I'm going back to the hosts file. You might want to start making a hosts file of your own of all the sites that you really, really like just in case.
 And of course, I hope you'll include Twit.TV in that list so you can still get our podcasts. Should the worst happen? That's just, it's amazing, really amazing.
 Yep. Well, it's one reason why our sponsor, Astaro, is doing so well. People are very aware of security nowadays.
 And naturally, when your company's looking for security, the place to go is ASTARO.com, a Staro corporation makers of the Astaro Security Gateway. If you're small or medium business network needs superior protection from everything.
 I mean, spam, viruses, of course, hackers, as well as complete VPN capabilities, intrusion protection, content filtering, and an industrial strength firewall, all in an easy to use high performance appliance like I have.
 I'm so glad I have. It makes me feel better. Contact Astaro, ASTARO.com, or 877, the number four AST ARO to schedule a free trial of an Astaro Security Gateway appliance.
 In your business, of course, they do offer the free version for consumer download at their website. And boy, if you're managing a larger network with a bunch of gateways, you want to look at the Astaro Command Center, we're going to slick way to keep track of what's happening on your network.
 And let's pray and hope that you never see all those lights go red with a big distant denial of service attack. That would be a scary, scary thing.
 You know, I think it's an interesting job now to be a system administrator.
 It's not boring. There is so much going on. You've got, you know, as we've talked before, you've got worms scanning around, trying to propagate themselves. You've got, you know, attacks at once or another. You've got incoming unslifts that it's spam.
 I mean, it's just it's there's a lot going on on the network on a beasties out there. Yeah, GRC.com is a place to go for more information about many things. Of course, this is where you can get to show notes and the 16 kilobits versions of this show.
 Transcriptions too, thanks to Elaine, a GRC.com slash security now. It's also a good place to go to get the ultimate disc recovery and maintenance utility, the wonderful spin right, Steve's bread and butter during the day.
 Yep. Also for information or testimonials from customers, and there's some great ones, spin right dot info.
 We got, we got one. I was thinking of you the other day, Leo. Someone wrote, they had, they had a hard drive die and they sent it to a data recovery company who gave them a quote of, I think it was eleven hundred and ninety nine dollars.
 Very typical, actually. With, with no guarantee of success. Right. Just that was the quote. And the guy said, send it back. So he bought a copy of Spinrite and three hours later, his drive was back online, working perfectly and fixed it.
 So nice story. There's lots of those at Spinrite dot info, S-P-I-N-R-I-T-E dot I-N-F-O. Yeah, you know, it's more and more I'm telling people. If it's a physical error, you know, if the disc is gouged, Spinrite won't fix that. You might have to spend eleven hundred bucks, but anything short of that. Spinrite's the first thing to try. Really is a great tool.
 So I guess we're, we're done for the day on our internet weaponry segment. What a fascinating topic though. Yep. 48 next week is a Q&A episode. So we'll answer questions and, and catch up with email and then move on from there approaching one year of security.
 Yeah. So a happy fourth of July week to you. I hope you take took a little time off for fireworks. I bet you know, I'm, I'm battling CSS menus.
 Different kind of fireworks going on in the Gibson household. Thank you Steve. We'll see you next week.
 Thanks Leo. Not security now.
