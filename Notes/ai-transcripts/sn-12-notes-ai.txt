 "Because the web is so huge, it's got 10 billion pages, you just can't go out there looking at every single page, you know, what kind of junk is out there, zombie machines, hackers, new words, malicious websites, and those zero-day exploits, affecting people's machines with spyware, is becoming a business model."
 "Security now!"
 "This is "Security Now" with Steve Gibson, Episode 12, for November 2nd, 2005, a special edition on Sony's Root Kit DRM."
 "Steve Gibson, welcome back from grc.com, the man behind spin right and shields up, and of course, security now, our security expert. His expertise is in taking complex security issues and making them intelligible and understandable for everyone."
 "We did a whole section, a whole segment on root kits, a couple of segments back, and they've returned to bite us in the butt. What's the latest on root kits? First maybe we should define root kits for those who missed our podcast on root kits."
 "Rutkit technology is technology which exploits the hookability, the variability of the operating system itself. It changes the way the OS works for the express purpose of hiding malicious software right in plain view, right in front of the user."
 "Use by hackers to hide their hacks on, originally on Unix systems, but now on Windows systems. And then, if you want more details, you should listen to Episode 9 as security now. But as we mentioned, it's also being used by spyware. But the big story this week is a big company that's using root kit technology."
 "Well, exactly. What happened was that Mark Rousinovich of Sisson terminals, who wrote the root kit revealer that we talked about in Episode 9 and recommended to people that they get in the habit of using, he discovered something on one of his own machines, using his own tool. Actually, he was updating the root kit revealer to add some more features to it, and ran it on his system, and there was a bunch of stuff.
 Which, you know, he was as surprised as any of us who really know or feel like we know what's in our systems would be. Well, he tracked it down to a commercial Sony CD that he had purchased not long before.
 And when he stuck it in his computer, it popped up an end-user license agreement, this so-called "ULA," and, you know, he clicked on, "Oh, okay, whatever, because apparently it needs its own player in order to play the music."
 "This is a kind of copy protection that a number of audio CDs use now. And by the way, I don't know about this particular one, but in the past, we've just told people, if you hold the shift key down, when you insert the CD, it will prevent the running of any software.
 And that, in the past, has disabled the copy protection and allowed you to play the CD as you would any normal audio CD."
 Well, and apparently, I mean, I don't know whether this has to be installed, or whether it's only for, like, the extended digital rights management stuff.
 But what Mark found was that a whole bunch of files and registry keys and, you know, modifications, you know, deep, I mean, true rootkit modifications were made to his system as a consequence of installing this thing.
 Wow. So, I mean, if, and, you know, rootkit revealer did what it was doing. He had no bugs in his code. It was really showing that something had installed itself maliciously, well, that, well, okay, not maliciously, but really would help give him any sense for what it was doing.
 So, it's being used by Sony to enforce their digital rights management, their copy restrictions on the CD.
 And is there a credible reason for them to hide this? Well, what's, I don't really think so. And what's really interesting is that, I mean, this feels like deja vu, for me, because the, as we talked about before with our original spy awareness podcast,
 talking about the Oriate DLL that was bringing advertising software along and, and going, you know, it wasn't using rootkit technology, but it was installing itself without people really understanding what was going on.
 A side effect of that was that it was making systems less stable. And it turns out, in researching this, I have found that this has been going on, apparently, for at least six months back to, like, March of 2005,
 people have been getting blue screens when they boot their system associated with something called the Ares.SIS driver that the windows complains is a critical system component.
 Well, this Ares.SIS is part of this, of the DRM system called XCP, which Sony is now installing when you buy one of their discs and stick it in your system.
 Now, Sony doesn't make this copy protection scheme. They're, they're licensing it from another company.
 Correct. It comes from a company in the UK, and we'll have links to this company in our show notes. What's interesting is that this thing has caused so many problems that even it, this rootkit technology, has a service pack.
 And how do you get the service pack? Service pack one of this crap you don't want to have on your system anyway.
 But how do you get the service, how do you even know it's there to get the service pack?
 Well, I mean, that's the problem with the software that installs itself surreptitiously in a machine.
 Or, I mean, many people had had these problems and didn't know, and didn't, didn't, like, logically associate it with the fact that they had played an audio CD in their system.
 Well, the box comes up and they click on OK, and off it goes, well, this just installed a rootkit.
 The license agreement implies that you can uninstall this.
 Correct. And there is absolutely no provision for uninstalling.
 Now, they may think you've uninstalled it, but it's still there.
 Well, actually, it's even worse. I mean, again, it's, it's, it's exactly the kind of things you and I have talked about before.
 People have used the rootkit revealer.
 Also, the F-Secure product that we mentioned in our, in our rootkit's podcast, the Blacklight product, it, it showed back in earlier in October last month.
 Some users use black, the Blacklight product from F-Secure to also discover this.
 Well, in trying to remove it, they damaged Windows and lost their CD ROM drive completely. Just disappeared.
 Well, you know, I get a lot of calls on call for help and on my KFI radio show from people who have disappearing CD ROMs.
 I wonder if this could be related to that.
 This has become a very common problem in Windows of late.
 Well, and, and mean, again, we're like reliving history because this is exactly what was happening back, back with the Adaware stuff,
 which is why I wrote OptOut in order to scan for and safely remove the Adaware stuff.
 They had no remover at all. And, and when people would, would improperly delete these things, in fact, you know, I've talked about how even one of our computers at the office
 lost this internet connectivity when a, an anti spyware tool just scraped the programs off.
 In the case of the Sony DRM root kit, it installs a, a filter driver in sort of in, it's called a filter because it's, it's in line between the operating system and the CD ROM.
 And Mark had this, Mark of, of Siss internals had exactly this happen. He deleted this file, this, this Siss file, and his CD ROM disappeared.
 Now he knew because he's a heavy duty techie, how to go around and, and how to go about getting it reconnected.
 But many people have had to install Windows from scratch after removing this thing incorrectly.
 In fact, in some postings over on the F-secure site, they say, yes, black light, our tool, our root kit tool will discover it.
 Do not use its deletion or you will lose your CD ROM drive.
 So, let's talk about, because there's a, there's a number of things, story angles to the story that I think are interesting.
 But first, let's just kind of cover the basics.
 What do we know, what does Mark Rousinovich say this tool does? It looks like it does quite a bit to your system.
 Yes, it's got a, a collection of files and registry links. So, I mean, it is, it is a true root kit technology.
 Now, one of the, one of the problems with this is that it was also not very well written, for example.
 Great. Yes, exactly. It, it has technology to allow itself to be removed.
 That is, it has a driver unload capability. Mark saw in looking at this, that it attempts to do so safely.
 But it can't.
 It's not possible to safely remove something that is hooking the kernel the way this thing does, really down deep.
 There is no safe way to do it. If you do, you'll just get blue screens.
 It's rewritten the system service table. And if you remove the entry there, the system crashes.
 Exactly.
 So, you can't unload the driver. It leaves the system unstable.
 Exactly. Now, even worse, he discovered in his version that it was also the, the drivers were marked as safe boot drivers.
 Meaning that if you reboot windows into safe mode, which is supposed to get rid of anything that could be causing a problem,
 allowing you to do system recovery sorts of work, then you'd be safe.
 Well, this thing now marks itself as safe boot.
 Apparently, it didn't used to because some earlier posts I found had people, they figured out how to work around this DRM.
 That is, you booted into safe mode, then you deleted a file called caj.dll, which was this CD-ROM filter driver.
 Then you boot back normally, your CD-ROM is gone, so you delete it from the Windows hardware list,
 and then tell Windows to re-scan for any new hardware. Windows would re-find the CD-ROM, link it back in,
 and you'd be set to go again with this DRM bypassed permanently.
 So, apparently, people were circumventing the copy protection, and Sony, or the makers of this copy protection,
 decided to make that impossible by making them safe mode drivers.
 Precisely.
 Wow.
 Yeah, tell us more, yeah.
 It also named itself the plug-and-play device manager,
 so that which, you know, which it's not, in order to confuse users who are trying to look at their, at the list of running services,
 and figure out, you know, why their system has started to misbehave.
 This is precisely what hackers do.
 Oh, yeah. And one last thing, what it does is, it hides anything that begins with dollar sign, cis dollar sign.
 Dot, dot, dot. I mean, you know, anything that begins with dollar sign, cis dollar sign, gets hidden by this tool, even things that are not its.
 So, for example, to test this, mark, rename notepad.exe to dollar sign, cis dollar sign, notepad.exe.
 It promptly disappeared.
 Even though it was still in the system.
 It hooks into the rootkit and is now a hidden file that cannot be seen.
 Which means that if this software became prevalent, that junior hackers, who don't have the ability to create a rootkit themselves,
 could simply name their files dollar sign, cis dollar sign, and they would all disappear, courtesy of Sony's copy protection.
 Let me underscore this.
 Sony is installing without your knowledge, and with really very weak permission, a program that allows any hacker, whatever his skills,
 to hide files on your system without your knowledge.
 They're putting a rootkit on your system that could be used by any moron.
 Exactly.
 This is just appalling.
 Now, Sony, as we speak, has not responded to these allegations, but what's good news is that this is being picked up everywhere.
 PC Magazine, PC Pro/Dots written quite a bit about it.
 There's also a good article on the Washington Post.
 The Washington Post has a good security column on there, and the author of that has written a little bit about it.
 It's getting coverage.
 Yes.
 Some guy who was blocking on MSNBC, a regular columnist, wrote a story yesterday about how he was going to be listening to and reporting on a new piece of audio CD that he had.
 He put it in his drive.
 It popped up this Yula, and he clicked No.
 He said, "Wait a minute.
 I don't want software installed on my system in order to listen to an audio CD."
 Then he did a little looking around and realized how glad he was he clicked on No.
 Well, I wonder how many of us have done this and exposed ourselves to this rootkit.
 Do we know which CDs it's on?
 Apparently, Sony's been using this kind of technology for, on the order of a year or more, there was another rootkit-ish technology they were using by a different name before this.
 But at least six months, this goes back.
 Again, the good news is, rootkit revealer that we've talked about before will let people know if they've got this on their system.
 If you run rootkit revealer, what string should you see? We've mentioned before, there are a number of false positives you can get with rootkit revealer that are okay.
 Kaspersky's antivirus.
 Norton's protect, trash protect.
 But is there a distinctive string that you'd see that would let you know that, in fact, you have the Sony BMG protection?
 Yes, you want to look for the dollar sign, SIS dollar sign.
 All of the files, a directory off the system 32 folder, and a whole bunch of registry keys, all are protecting themselves and hiding themselves with this dollar sign, SIS dollar sign.
 Are these the null terminated string registry keys that we had talked about before?
 No, it's just this prefix of dollar sign, SIS dollar sign, that's really the tip off.
 A huge amount of heat from this, they're not saying they're not going to use it, but they do have a page now where they give you a link over to the XCP-Aroora.com site where there is something that will remove this finally from your system.
 I've seen a whole bunch of blog postings from people who have said and explained that what it does is it has to install one more thing.
 It works with an active X control, so you have to give it permission to install an active X control in your system in order to offer you the service pack one upgrade to this heinous bit of software.
 And then if you say no, it has an option for deleting it.
 Brian Krebs, who writes the security fix column in the Washington Post, says that Sony says that any CD labeled content enhanced and protected, and it'd be on the front and the back of the product could contain this rootkit.
 And he said he did a quick search on Amazon.com site, the 24,000 of these CDs out there.
 So it's a serious issue.
 The other thing that's really interesting too is that Mark technically violated digital rights management law.
 The DMCA.
 Exactly.
 The DMCA by figuring this out.
 It was illegal to do what he did.
 And this is the problem.
 This is a situation that our lawmakers have gotten us into because they're in the pockets of the recording industry.
 And the recording industry clearly has no scruples when it comes to protecting their intellectual property.
 Well, I hope that Sony does the right thing and pulls it back.
 Nevertheless, that means there's still probably a lot of computers infected out there.
 Well, and many people have written to the groups and the bands whose CDs did this to their machine.
 Good.
 Typically, these people have responded that they had no idea that it was going to be done.
 And unfortunately, the bands in their defense have no control of this at all.
 I'm sure their contracts specify that Sony can do anything they want on the CD.
 You'd have to be a pretty big band to say no to Sony in this case.
 Well, I think what it means to me is I'm going to be much less likely to you buy a CD from Sony from now on.
 Certainly, if you put an audio or this is, by the way, true of movie CDs in another way.
 There's a player that movie CDs install, the interactual player that is known to disable CD cracking software,
 DVD cracking software on your system.
 So I guess the bottom line is if you're using a computer to watch movies or listen to music,
 and it asks you, may it install some software, say no.
 And I would imagine that holding the shift key down would still work in preventing that software from running.
 That will prevent the auto run now. One other nice feature.
 Again, this goes back to what we often talked about security wise.
 If you do not have administration rights, this cannot install itself.
 Oh, very interesting. Another reason not to run is root.
 Exactly. So many administrators have mentioned in various postings
 that users came to them when they installed some music on their machine or tried to just place some music on their machine at work.
 Because the work machines were locked down and their employees were running without administrative rights,
 this junk would not install itself on their machine.
 And Sony has, on their site, actually has pages explaining.
 Here's how you add administrative rights because you're going to have to have those in order to use our little player
 with our music CDs.
 A Pauling. A Pauling. And this is just, I meant just a Pauling.
 Well, we've met the enemy and he is Sony, BMG.
 I hope people are listening and write to Sony, write to the bands.
 And I think the best thing to do is at this point stop buying Sony CDs.
 In fact, I wouldn't buy a CD that says content's enhanced and protected on it of any kind.
 Do not buy a CD that says it's copy protected.
 Well, in fact, a number of people posting the various blogs said, you know, way to go Sony.
 You've really made me want to legitimately purchase music now.
 Yeah. This is of course what we've talked about.
 We talked about this on Twitch. It's just turning people into criminals.
 You do this. You go far enough. People are going to stop buying music.
 Right. Well, Steve, I thank you for the update on this.
 It couldn't have been more timely that we covered root kits.
 I encourage people to go back to episode nine if they haven't heard it.
 When we talk about root kits and the potential problems, and here it is three episodes later,
 and one of the biggest companies in the world is foisting them on us.
 Well, and what's neat is that, you know, we have talked about and there exist tools that will find these.
 And now, thanks to all the Fuhrer, which is his generator,
 there is a safe removal tool from the authors of this software,
 which, you know, always comes along afterwards just due to end user demand.
 Well, but as we as we know from other soft, quote, removal tools at the spyware companies gave us.
 You can't always trust them to do the right thing and remove this software properly.
 And here's an interesting issue too, Leo. Will the current anti spyware and future anti-root kit scanners label this as a root kit?
 Right. Because of course, in the past, they've bowed to commercial pressures and said,
 "Oh, well, I guess it's not a root kit if Sony's doing it."
 Yeah, I mean, so in terms of the standard non-supertechy root kit scanner stuff, the typical end users run,
 will it deliberately ignore the Sony DRM root kit and not tell somebody that it's on their system?
 Mr. Paul, or not?
 It's just appalling. And in fact, it ought to because whether you think Sony's benign or not,
 it's not merely Sony protecting its DRM. It's so badly done that it gives a back door to any hacker who wants to hide files on your system.
 And has been known to create unstable booting situations where people are getting blue screens every so often
 when they boot for a reason of not being able to find this Aries.SIS driver.
 Once again, I'm going to go out and run a root kit revealer on all my systems and make sure I didn't accidentally install it.
 And if I find any Sony BMG discs, I'm going to put a pile in the back yard.
 Anybody wants to bring theirs over, we'll be burning them later tonight.
 Well, and if nothing happens, between now and next week's Security Now podcast,
 we'll do our third installment on how to be really, really secure with wireless networks.
 Good, unless something else breaks.
 Yeah, but that's part of the mission of this show is to give you the latest breaking news,
 as well as, of course, tutorials and all of the fundamentals of security.
 More information on this topic and all of our security now, podcasts, both in high quality and 16 kilobits versions,
 as well as transcripts are available at SteveSight, grc.com/securitynow.html, that's the URL.
 Steve, I want to ask you to update the podcast URL on your page to the redirect that I use.
 Never changes is leo.am/podcastsn.
 It did point to a site which has been changed, so make sure you use, if you subscribe to this podcast,
 leo.am/podcastsn because we want to make sure everybody gets a copy of this particular episode of Security Now.
 iTunes has it right all the other places.
 If you subscribe through my Yahoo iTunes ODO, Pod Nova, they'll all get you the file.
 And, of course, you can always get the latest file at grc.com/securitynow.html.
 Thanks to the good folks at AOL Radio for broadcasting security now on their podcast channel
 and hosting our files for free so that everybody can get a copy of it.
 AOLMusic.com, thank you AOL.
 And thank you, Steve Gibson.
 Your information couldn't be more timely. This is important stuff.
 Security Now.
