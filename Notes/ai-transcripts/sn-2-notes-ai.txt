 This is Security Now with Steve Gibson, Episode 2 for August 25th, 2005.
 On this episode, we decided to use something a little different.
 Normally, we have used Skype in the past for both this week in tech and security now.
 But of course, yesterday Google came out with its new Google talk.
 And we thought, we should try it.
 We were pretty impressed with the results.
 The entire interview was conducted with Google talk.
 Steve and I both agree.
 The best part is the incoming ringtone.
 Oh, oh, I do like that.
 Listen to that.
 Oh, I do like that.
 That sounds good.
 I mean, that's worth it just for the ring, just for the ring.
 That's very pretty, very, very pretty.
 Wow.
 So what are we going to talk about today?
 Today, we're going to talk about a recent emergence of some technology from
 Microsoft research branch called the Strider Honey Monkey Exploit Detection System.
 Wait a minute, wait a minute.
 Strider Honey Monkey.
 Yeah.
 Try to guess what that is, folks.
 Well, honeypots, of course, are technology that's been around for a while.
 A honeypot is what many, for example, security systems and firms and even just
 people who are interested in internet security set up.
 A honeypot is a computer which is sort of stuck out on the internet and allowed
 to be attacked by hackers for the purpose of finding out what sort of exploits are
 going on, what's out there.
 Basically, it's a system you stick out there to be a victim of hacker attacks and
 it's closely monitored, but obviously it's protected from the rest of the network
 so that nothing that happens to it can infect anyone else's network.
 I guess it's kind of like Winnie the Pooh, you put out a honey pot and see what happens.
 And it attracts the bees.
 See, who sticks their nose in.
 Exactly.
 Well, that's been around for a while.
 They've been in a lot of different...
 That's all technology, but very effective for finding out what's out there on the
 internet, what types of exploits are out there, and for example, that's the way
 these security firms discover new worms is that they've got honeypot or honeypot
 networks of computers that get infected by new worms and that allows them to determine
 what kind of junk is out there cruising around the internet.
 Well, Microsoft decided to experiment with reversing this process rather than wait
 for bad stuff to come to users, they've created a network of machines which they
 call "honey monkeys" and if you're familiar with the old monkey, see monkey do.
 Yeah, the idea that monkeys mimic things that they see, well, these honey monkeys mimic
 users who are surfing the internet with Microsoft's Internet Explorer and getting themselves
 infected by malicious websites.
 Oh, so you mean end users, who are they going for here?
 No, no, they're actually going for malicious websites.
 Oh, the bad guys, I get it.
 Yeah, but the honey monkey computers pretend to be users who are like, for example, cruising
 porn sites and getting themselves infected as a consequence.
 So they pretend to be users in order to find malicious websites?
 Exactly, it's sort of in the same way that a web search system uses spiders to spider
 the web and follow links, these things go out and pull web pages from servers in order
 to literally to get themselves infected, to solicit infections of themselves.
 So instead of a spider, it's a strider, but otherwise the same.
 Exactly, and a stride the net.
 Well, I'm not sure if Strider refers to that because they've got a number of other research
 projects, there's something called the Strider Gatekeeper, which is a spyware detector and
 a strider ghostbuster, which is a root kit detector.
 So Strider seems to be sort of a moniker under which a number of different security related
 projects are put together.
 But what they do is they use a sort of like a VMware or Microsoft's virtual PC technology
 to create a virtual PC, the reason they do this is that once they get themselves infected
 of course, they don't want to have to reformat the hard drive and reinstall windows and everything.
 So a virtual PC, you're able to sort of boot from a file and just wash it away if it gets
 infected.
 So the way this starts is that Microsoft sends some standard, does some standard searches
 to, for example, find hosts files out on the internet which have been assembled by humans
 of sites you want to stay away from.
 They'll also use links in spam and phishing emails.
 Basically because the web is so huge, just 10 billion pages, you just can't go out there
 looking at every single page because most of them are certainly not malicious.
 It's only sort of like the seedy sides of the web, the bad neighborhoods where there's
 a useful expectation that you might have something malicious trying to use an exploit
 in your browser to infect your machine.
 So they sort of start off seeding their honey monkeys with, I don't know, it's fun to say.
 That's more interesting really than it is actually.
 Well, wait till I tell you what the results have been.
 So they've set up these honey pots.
 They've established striders or spiders to search the bad areas of the net net for bad
 guys.
 Then what?
 Well, so the idea is that after running this for one month, that is, seeding their honey
 monkey project with a bunch of potentially bad URLs that they collected from, just doing
 web searches of people's hosts file, which are like URL block lists, essentially.
 Microsoft has found 752 URLs which attempt to infect their Windows Internet explorers by
 using known vulnerabilities.
 Interesting.
 They actually sort of released these honey monkeys on a URL in stages.
 They call it a pipeline.
 They'll first use an unpatched XP, then a service pack one with patches, then a service
 pack two unpatched, then a service pack two with all recent patches in a series of stages,
 and even finally a service pack two that's got all the latest patches to find out whether
 there's any pages out there that have any unknown zero-day exploits.
 Something that Microsoft hasn't yet patched.
 And they have found one.
 They did.
 No, they find this.
 They actually found one which fortunately they knew about but which had never been publicly
 disclosed.
 Wow.
 So what does that tell them?
 Well, yeah, exactly.
 This demonstrates that there are websites out there using exploits that have been discovered
 but kept quiet and are actively working to infect people's machines.
 This addresses something that the security community has for a long time called security
 through obscurity.
 The feeling in a lot of companies, I always thought Microsoft kind of had this feeling
 that, "Well, if you just don't tell anybody, nobody will know there's a problem."
 Well, apparently you don't have to tell anybody, hackers find these problems anyway.
 Well, what they're also doing is they're analyzing the interconnectivity of these exploit sites.
 What they have found is within the top 30 exploiting sites, many of them are owned by
 the same people.
 Oh, interesting.
 And the site registration addresses covers more than 10 countries.
 Wow.
 So you think there's a ring?
 Well, there's a great deal of interaction among these sites with sites referring them
 to each other.
 One guy, for example, owns the number one, the number three, and the number 10 exploit
 sites in terms of strength and 61 other exploit sites redirect traffic to this guy.
 So is this the Osama bin Laden of hackers?
 Well, essentially what's happening is the way this is shaping up is that the notion
 of infecting people's machines with spyware is becoming a business model.
 Right.
 I mean, it's not just hackers now.
 It's people trying to acquire spam bots, as we know, zombie machines, basically trying
 to make money from maliciously infecting other machines.
 Is that why spyware has gotten so much worse and viruses have gotten so much worse because
 now there's money in the equation before it was just...
 To show off.
 It's not just a hacker home from high school in the afternoon, unsupervised screwing around.
 Well, it might be, but now he wants money.
 Exactly.
 It might have been.
 It might still be this kid after school, but now he wants something.
 He's making some money, he's making his, this is his paper route of the 21st century.
 Right.
 Well, and a couple of other things have been found.
 First of all, most of the exploit URLs are pornography sites.
 Okay.
 So the, the, I mean, that's not a surprise to anyone who's been in the, on the net for
 a long time.
 It's a little self-selecting though.
 This is, these are sites that Microsoft has, has, has seeded, right?
 I mean, so we, uh, where do they get these sites originally?
 I mean, maybe that's because that's what Microsoft had, is what I'm saying, right?
 Well, no.
 What they did was they did searches for...
 So they searched the entire net.
 They didn't kind of limit their search.
 Well, they, they, they, they did searches for, for example, on, on using MSN search, I would
 imagine they, they, well, there's your problem right there.
 They did, they did, they did, they did searches for people who had posted their hosts file
 or their, their, their list of known spyware sites.
 So they were sort of, they were going through other people saying this is where we've had
 problems.
 Exactly.
 Cause you'll post your host file asking for help or, or offering actually help saying block
 these sites.
 Exactly.
 So here's a list of all the bad domains that the, I don't let my computer go to.
 So this is what the community has been saying.
 And so these are people sharing.
 Right.
 So interesting.
 So, I guess advice, piece of advice for number one, be stay away from adult websites.
 I think that's probably a really good idea.
 I mean, because...
 That's a honey...
 You bucket of their own, isn't it?
 They're a honey pot of their own.
 Really, if you think about it.
 Hackers are going to put their bad stuff on sites that they know people will be drawn
 to.
 Right.
 Well, and, and we've also seen, apparently there is a shopping site which performs exploits.
 There are now, they've discovered some of these URLs are freeware sites that not only
 offer freeware, where the freeware contains spyware, but the freeware, but the site itself
 is using browser vulnerabilities to directly install spyware in people's machines.
 So just going to a freeware website, you know, one of the obviously low reputation sites,
 but still, you know, that's one thing we're seeing.
 And there are even some search sites which they, they found more than 20 malicious search
 sites where we're using the site to do searches, attempts to infect your machine with malware.
 So to kind of explain this in a little bit of more detail, of course, people understand
 if you download a program, you run the risk of that program being malicious.
 But that's not just, that's not the only way they're infecting you.
 These sites, just by visiting the site, you're getting infected?
 Well, in fact, that's what, in order to test that, that's what the honey monkeys do.
 They have it.
 They take a fresh computer with some level of patching done.
 They simply display the page.
 They go to the URL and wait a few minutes.
 They don't explore links, they don't click on buttons saying yes to anything.
 They just go to the page.
 And then what they're doing is they're using this other technology that Microsoft has to
 detect root kit activity, these other strider projects, this the so-called ghostbuster and
 the gatekeeper to detect any changes that are made to the machine as a result of just
 going to this page.
 And so that's what they're detecting.
 So basically, Microsoft, for the first time, is being proactive in sending windows out
 onto the internet and monitoring whether changes are made, exploitive changes, presumably,
 just by going and visiting a website.
 And you think this is a good technique?
 You think this is a good policy, a way to do it?
 Actually, I'm very excited about it.
 Now, it means a couple things that are interesting.
 They also, in their research report, they check to see whether various search engines,
 like Google and Yahoo and MSN, contained the links, that is these URLs that they found.
 Google and Yahoo and MSN did, Microsoft removed them from their search engine, so that MSN
 no longer contains these bad URLs.
 There's a little ad for Microsoft in there.
 Well, I know.
 I would hope that they told Google and Yahoo as well.
 No.
 Microsoft's very competitive.
 They're there, you and I've talked about how-- So here's the press release.
 Microsoft has found bad sites.
 We're not going to tell anybody, but we'll block them on MSN.
 And exactly.
 Oh, man.
 And, notice also.
 I was talking a lot.
 I don't like them for a minute there.
 Notice also that Microsoft is only checking for IE vulnerabilities, not for Netscape, not
 for Mozilla, Firefox or anything else.
 Interesting.
 So, and the other thing is that Microsoft is now feeding these things to their security
 team.
 To fix.
 It's the ISE, the Microsoft Internet Security Enforcement Team, and getting involved with
 the FBI to go after these sites and begin to corral this.
 Well, that's one thing I wanted to ask you, though.
 A lot of malicious sites open and close very rapidly.
 For instance, the phishing sites are only up for a few days.
 So they're really only catching a certain kind of scammer.
 Well, and the other thing they're doing, it also argues for them not revealing the
 URLs that they're monitoring, because they're now monitoring these sites and they're watching
 them for the emergence of new exploits.
 Right.
 How long has Microsoft been doing this strider monkey pot?
 It's been about six months.
 And the security community a few weeks ago really began buzzing about it, because they
 produced a research report.
 But for example, in the case of this one zero day exploit that had not ever been publicly
 disclosed, the honey monkey discovered a site that was doing it, identified what it was,
 and then these guys thought, "Oh my goodness, here's something we've never told anybody
 about.
 We know about it.
 We're going to fix it when we get around to it, but a site is already exploiting it."
 Well, that within two weeks, 40 other sites were running the same unknown exploit.
 Now, does Microsoft offer any theory as to how those sites, the guy in the first place
 discovered this vulnerability?
 Yeah, it's the interconnectivity.
 I mean, there's a community, a real dark underbelly here that are communicating with
 each other and sharing this information, and for example, many sites will redirect you
 to a different site that uses different exploits to see if some other location is able to
 infect you.
 How about the original hacker?
 How did he uncover this hole?
 That's a really good question.
 Does he have an inside source at Microsoft maybe, or maybe he just banged on Internet
 Explorer to?
 Really good question now.
 And again, one of the really interesting aspects of this is that Microsoft is actively working
 now to clean things up, but only for them.
 Only for their tools, only for their web search.
 What's the reaction of the security community to that aspect of it?
 Well, it's been sort of a mixed blessing.
 It's going to be interesting to see what Microsoft's going to do.
 The security community has suggested, "Well, well, maybe Microsoft's going to go into
 the URL blocking business that other companies are offering to commercial companies and get
 in there."
 Also, it's certainly the case that this factors into Microsoft's anti-spyware and forthcoming
 anti-virus initiatives.
 This is the subscription program they're planning to offer, and maybe that would be part of the
 subscription program is, "Oh, we know something that no one else knows," which is there's
 a problem that we can prevent that no one else can prevent.
 You better pay $29.95 a year to subscribe to it.
 Now, the flip side of this is that because you're not able to spoof the IP of the honey
 monkey and Microsoft monkeys- By the way, ladies and gentlemen, this may be the only
 podcast where you ever hear the phrase spoof the IP of the honey monkey.
 Right now, this honey monkey network has been operating from a certain zone of IPs, and
 you could imagine that one of the things that the malicious website-
 They want those numbers.
 Exactly.
 The malicious website webmasters will block Microsoft's honey monkeys from visiting their
 sites in order to feed the block this out.
 If they could figure out who the honey monkeys are, they have to find those IP addresses.
 I presume that's a highly guarded secret at Microsoft, they're not going to tell anybody.
 Well, you would think that if the honey monkeys are routinely visiting these sites-
 Maybe people will start noticing.
 Now that the webmasters of these malicious sites know to be on guard, that they might
 say, "Wait a minute, here's an IP range, a block of IP addresses that seems to be coming
 back a lot on the other- That is for Microsoft not telling anybody about this.
 Maybe it would have been better if Microsoft had kept this secret.
 Well, it also means that Microsoft is going to have to set up, and they have talked about
 setting up networks around the world to essentially distribute their honey monkeys around the globe
 so that they're much harder to track and verify.
 And not such a bad thing if bad guys start blocking IP addresses out of paranoia.
 Maybe they'll protect some innocent people as well, right?
 Well, I was going to say that- If they blocked everybody from Redmond, Washington, that'd
 be great, everybody moved to Redmond saying, "I'm safe, I'm in Redmond, Washington."
 They might think I'm Microsoft.
 They might think I'm Microsoft.
 They might not.
 Same bucket monkey, whatever.
 You might also argue that somebody who is using a porn site himself or herself constantly
 might have their IP blocked because they're incorrectly being identified as a honey monkey.
 So in fact, your advice would be to use more porn?
 No.
 I think we'd probably want to stay away from those sites.
 The risk is there.
 Now, how do we know these- Now, obviously, Google's not one of the search sites, but
 how would we know if it's a malicious search site?
 I mean, that's kind of scary.
 It is scary that among these malicious sites, there were 20 that were found.
 I mean, it really argues for sticking with the top search engine.
 Go to the biggest.
 Google Yahoo and MSN.
 Yeah.
 Well, sticking with well-known sites in general, I guess.
 Yes.
 Yes.
 Or patching your windows as often as possible, not using Internet Explorer, that kind of
 thing too.
 Well, yes.
 One of the things that many of the pages that we're talking about this we're referring
 to was the fact that this demonstrates the effectiveness of patching.
 Well, whoever doubted the effectiveness of patching.
 Right.
 That's not a question.
 Absolutely.
 You've got to keep patching.
 It's like, "Oh, look how many pages infected us when we just went with a brand new Windows
 XP?"
 It's like, "Yeah, no kidding."
 Yeah.
 Right.
 Well, in fact, you just go online with the unprotected Windows XP service pack.
 One, you'll get SAS or within a minute.
 Oh, it's game over.
 You stick it on the net without a firewall up in your trouble.
 Yeah.
 So is there anything that the average user can learn from this?
 I mean, I guess we've said a few things.
 Stay away from adult sites.
 Be careful where you go.
 Go stick to the kind of major well-known sites.
 Any other things that we know now because of this?
 No, except that I think that it does sort of flip the whole security, you know, Microsoft
 security disadvantage sort of upside down to the degree that Microsoft figures out how
 to protect people from this.
 Well, I would like to see Firefox do this.
 I would like to see other companies do this.
 Well, that's exactly the point.
 I'd like to see Apple do this, right?
 That's exactly the point is that we know that there are Firefox vulnerabilities.
 Apple just released a major security update.
 40 updates, yeah.
 Yeah, 44 different security patches.
 So I guess the point is that Microsoft used to argue that the reason we seem to look
 more insecure is that we're being attacked more often and we're beginning to see, you
 know, non-IE attacks on other browsers and non-Windows attacks on, I mean, and Linux,
 for example, non-Windows attacks on other OS's.
 Yeah, but none of them has been as severe yet.
 None of them have been severe, although there are a lot, you know, there are remote code
 exploits attacks all over, and so you could almost argue that because Microsoft has had
 such a problem for so long, they're finally getting truly proactive and that as a consequence,
 you could foresee the day where Windows is more secure than the others.
 Is something like a strider, honey monkey project, I can't believe I just said that.
 Difficult to do, is it something that other companies couldn't do as well?
 No, and there's really nothing hard about it.
 And in fact, in Microsoft's research report, they do talk about other companies doing this
 kind of thing if they, as a proactive means of finding flaws.
 I have mixed feelings about it.
 On the one hand, I'm glad they're being proactive.
 On the other hand, it kind of makes me mad that they're keeping it to themselves.
 Yeah, I mean, I certainly understand that and for example, that they're cleansing their
 own search engine of those dangerous URLs.
 They're using it to their economic advantage, which kind of makes me a little ticked off
 to be honest with you, wouldn't the tradition of the security community that you share the
 results of this kind of research as widely as possible?
 If you care about security, you don't take advantage of these flaws to boost your numbers.
 It gives Microsoft a competitive advantage and clearly, I mean, the fact that they're
 now in the spyware business or the anti-spyware business, and then they're there now, some
 people might argue that they are in the spyware business, but the anti-spyware business and
 the antivirus business, it's clear that security is becoming a profit center.
 And so Microsoft has come up with, you know, a substantially useful technology.
 The good news is they've published it, everyone understands how it works.
 So other people can certainly set up their own honey monkey systems that they choose to.
 Everybody make yourself a honey monkey.
 Well we've learned a lot.
 I appreciate it.
 More information, of course, as always, at grc.com.
 That's where you'll find shields up, spin right, and the many great pro bono projects
 that Steve Gibson always embarks on to save our bacon or our honey monkeys, as the case
 may be.
 Steve, great to talk to you.
 Always a pleasure, Leo.
 We'll talk again next week.
 See you next week.
 That's it for this edition of Security Now with Steve Gibson.
 I'm Leo LaPorte.
 Thanks for joining us.
 We'll see you next week.
 Bye.
