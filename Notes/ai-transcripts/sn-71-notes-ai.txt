 This is Twit!
 Bandwidth for Security Now is provided by AOL Radio at aol.com/podcasting.
 This is Security Now as Steve Gibson, episode 71 for December 21, 2006.
 Secureable.
 Security Now is brought to you by Astaro, makers of the Astaro Security Gateway, on the web
 at www.astaro.com and by Dell for this week's specials visit twit.tv/dell.
 Time to talk about security and even though the holidays are fast approaching, Steve Gibson
 insists that he's going to catch Twit and so when Twits off, Steve goes crazy and says,
 "Let's do another one, so we'll do two today."
 I think we're only ten weeks behind, didn't you just do number 80?
 Just to number 80.
 Yep.
 In fact, I participated in number 80.
 That's right.
 It was very nice to have you.
 It was fun.
 Yeah.
 You're great to have on Twit and I think you and Dvorak are just fun to have together.
 We do have a different approach because I, generally, I infatuate with things.
 I love technology.
 I'm a little bit of a sucker that way and John is, I mean, is everything.
 Exactly.
 So I think he and I do have a sort of nice counterpoint against each other.
 I agree.
 Yeah.
 It's very good.
 It was a fun show and if you haven't heard Twit 80, please download that.
 We are going to take a couple of weeks off for Windows Weekly because I'm going to Mexico
 pretty much as soon as we finish taping this and then I'll be back and, you know, Daily
 Giz was going to shut down for a couple of weeks after this week and so forth.
 We're going to take a little time off.
 I call it podcast catch up weeks so you can catch up with the ones you've missed.
 And there are a lot of old issues you can go back and look through.
 That's very good.
 I doubt very many.
 I doubt very many people have heard every security now, for instance.
 It's also interesting that I was thinking how much Vista is in every, well, is in our
 minds.
 I mean, you and I are talking about it.
 We're using it.
 Certainly you and Paul are talking about it with, with Windows Weekly yet it's going to
 be a little frustrating for so many of our listeners who are hearing about something that
 they don't yet have and cannot yet get.
 So on the other hand, you know, from a security standpoint, we want to lay down the foundation
 of what I think is going to be a very important enhancement to the, you know, the Windows
 Workstation desktop platform with Vista, I completely agree.
 So what is our topic for the day to day?
 Well today I want to talk about something that I've alluded to over the last few weeks
 that I've been now working on for many weeks, which is turned into, as many of my things
 do, a much larger project than I imagined.
 It's this piece of freeware that I will be releasing.
 It's not yet finished, but I want to talk about what I'm learning along the way, because
 I think people will really find it interesting and because I'm, because of what I'm learning
 is significant, even though I'm not yet really sure what it means.
 So I'll explain all that.
 Okay.
 That's coming up.
 But for some of Rata, I think.
 Yeah.
 Of course, last week, last week, we talked about Tor, the onion router network, which
 generated a ton of feedback.
 And you mentioned that you even had some callers on your, on your weekend show on the radio
 show.
 Yeah.
 Yeah.
 Yeah.
 Now, most of the concern, well, there, there was some issue about the Tor technology.
 And in fact, we're going to cover those questions in next week's Q and A because we have a Q
 and A coming up next week.
 So, so those I'm going to hold off on.
 But the interesting ones that I just wanted to acknowledge them were, you know, the more
 the issue of sort of episode number 69, where we were talking about the policy, the social
 implications of anonymity, for example, and I'm just going to read one person's note because
 it's sort of representative of, of, of this sort of issue that people had.
 He says, free speech does not in all caps require anonymity, exclamation point.
 In the United States, you can say just about whatever you want without anonymity and you
 won't get dragged away by the police.
 There are only a few areas that aren't protected, such as criminally threatening somebody or
 inflicting, well, his, his note says, or, or inciting a riot, which aren't protected because
 these types of speech violate other citizen civil rights in the process.
 Conversely, a person speaking under anonymity in an oppressive country does not have the
 freedom of speech.
 He is simply avoiding persecution from his government, but he never truly had that freedom.
 I almost stopped listening to episode 69 and second, I think he may almost stop listening
 to security now forever.
 He says, after hearing your argument and only later realized that you were parroting the
 bad logic from the FreeNet Project website, they've written software with the sole purpose
 of violating copyright laws and trying to justify it by boiling down a series of bad
 logical arguments to, quote, "You either choose between freedom of speech or copyright
 laws," unquote, given the choice who in their right mind would choose the latter.
 I guess that's what they're banking on if they ever go to trial over this.
 Freedom of speech does not require anonymity.
 Lack of accountability for your speech or actions requires anonymity.
 So you know, there, I got a bunch of postings, you know, like that and, and I wanted to acknowledge
 that, I mean, I understand that argument and, and what we were talking about because we
 were talking about in episode 70, which this whole notion of sort of, you know, infinite
 techno anonymity, which is what the Tor network brings us.
 I wanted to comment.
 I mean, while I completely understand what that guy is saying, and I hope I, I buffered
 some of the absolutism of, of that in episode 69 when we were talking about, you know, the
 fact that, you know, for example, I have no need for anonymity, as you know, Leo, I've
 gotten involved, for example, in my local homeowners association, and I've sent a number of letters
 out to all of the people in the association, 309 homeowners here, signing my name and putting
 my address on it.
 Other people, because it's gotten sort of political, have been leaving anonymous flyers
 on people's doorsteps, and people of the, my fellow homeowners have come up to me and
 really thanked me for my involvement and noted specifically how much they appreciated.
 I put my name and, and address on my communication, I mean, I was taking responsibility for what
 I was saying, which I think makes it much more effective.
 But you know, on, at the same time, we've got people saying, wait a minute, you know,
 you don't need to be anonymous to have free speech, except there is that counter argument,
 which is, okay, there are people maybe who are shy or who, you know, who don't feel that
 they have the freedom to say what they want for fear of, you know, their neighbors being
 upset with them.
 I mean, you know, even that not necessarily your government, we're not talking about
 being being dragged away by the police, but, you know, therefore, whatever reason, they
 don't want to set their name to their feelings, yet they still want their feelings to be known.
 So, you know, I mean, there are there are two sides to it.
 I know that we sort of ventured into political territory with episodes and obviously upset
 that guy, but I, but believe me, all you have to do is say in election, one of the fundamental
 tenets of elections is the anonymity of your vote.
 It's very good point.
 And that's all you need to say.
 It's something that's been built into our constitution.
 It's something that's part of our society.
 Security is very important, otherwise you don't, if you don't have secret ballots.
 Yeah.
 And, and, you know, I hate it when people say, but it's safe here.
 No.
 Well, true, but it's not necessarily always that way.
 Well, I mean, visually, the freedom, you don't just assume we've got free speech.
 We don't have to do anything about it.
 Yeah.
 In fact, it's free.
 It's safe here now because we have had that freedom of an anonymous ballot where people
 were able to vote without any concern that, you know, then it hasn't always been that
 way.
 I mean, there are many times in our own national history where there weren't secret ballots
 and it was an issue, things like the poll taxes, we've got to fight for these things.
 They don't come automatically.
 So for somebody to say, well, it's safe to be, you know, you could say anything you want
 here in this country right now, that may be true right now doesn't mean you shouldn't
 continually monitor this stuff.
 And I think when 10 Doc technology provides you ways to do it, you should do it.
 Now I'm uncomfortable with free net as well.
 Yep.
 I'm not, I'm not running free net for a lot of reasons, but I don't think that there's
 a problem with a tour router.
 I think that this is the kind of thing we've got to have so that we can preserve our own
 freedoms.
 Period.
 And so if the guy doesn't like it, you don't have to listen to security now.
 That's fine.
 You go listen to Rush Limbaugh.
 I'm perfectly happy with that.
 Well, and I also wanted to acknowledge that, I mean, there are, there are levels and shades
 of gray and that absolutely is not black and white.
 Yeah.
 Right.
 I can really appreciate that that there are people, for example, very active people in
 GRC's newsgroups.
 I have no idea who they are.
 I don't care who they are.
 They've established an identity.
 They are, they are completely anonymous.
 And that's just fine because over time I've learned who these people are based on their
 handles.
 We have provided the ability to prevent handles from being spoofed.
 GRC prevents that from happening as I mentioned in, in episode 69.
 So, so, you know, it's like they're entirely effective.
 If they would rather not use their name, I'd rather hear from, from good people who take
 the option that the internet provides in all kinds of different ways of, you know, of
 being unknown.
 Let me ask you the question that our caller on the radio show asked because I thought
 it was kind of an interesting question.
 He's, he listened to the tour router store show and I clearly understood it.
 And he said, but one thing that bothers me is let's say a governmental agency wanted
 to infiltrate the tour router, put lots of tour routers online.
 And then hoped to, at least from time to time, make their router, the last router on
 the tour routing, wouldn't they be able to see your message in the clear?
 Yes, that's absolutely the case.
 They would, they would be able to see the final, the final decryption of your TCP traffic
 as it was leaving and returning from that, that last router in, in the anonymizing network.
 So, so it's, it's not providing encryption.
 Now, of course you could create an HTTPS that is an SSL end to end encryption.
 So you're encrypting everything yourself so that between you and the remote site.
 So, so that would create an encrypted tunnel that was then being anonymized by the, the
 tour network, but there has been the people have noticed a couple things about tour and
 we'll be covering it in some more detail next week.
 For example, if you had a malicious tour router as the, as you said, the last router in the
 onion chain, then there are different things it could do.
 It could even use cookies and JavaScript and inject stuff back into your browser, which
 could potentially then, for example, if, if, if it was able to inject JavaScript in pages
 you were retrieving, JavaScript could run in your browser and reveal your IP back through
 that connection.
 So, so it, there, there are, you know, there are potentially bad things that could be done,
 but the, the technology of encapsulating encryption as we discussed last week in this, in this
 onion.
 But it's very effective for anonymity.
 A high percentage of routers could be compromised and still anonymity would be protected.
 So the thing to understand is that tour is not about encryption.
 It's about protecting anonymity and the way it does, and, and people have to understand
 that even if you use encryption, very sophisticated traffic analysis programs exist that can deduce
 a lot about what's going on just by watching who's talking to whom, when.
 So that's what the tour does.
 It doesn't encrypt your data, it hides who's sending what to whom.
 Correct.
 And in fact, one of the things that there's a really neat page on the tour site, which
 talks about the problems that they acknowledge the network still has.
 We talked about how, for example, all the packets being exchanged are padded out to
 a fixed length, so that you cannot use packet length analysis in seeing traffic coming in
 and going out of a single tour node in order to associate them.
 But because tour is a relatively low latency network, that is, they, they want the thing
 to still, still be functional and, and useful there.
 The routers do not introduce random delays that is in how long they hold the packet before
 routing it.
 If, if routers sucked in packets and waited random lengths of time before sending it on,
 then you would not be able to use timing analysis with any, you know, I mean, it's essentially
 would really render timing analysis fruitless.
 On the other hand, it would introduce tremendous end-to-end delays as the traffic moves through
 the network.
 And so that would be a, you know, a different problem because it would then, you know, drop
 the usability of the tour network and it turns out that their feeling is, okay, you know,
 we need some trade-offs here and keeping, keeping the network fast enough to use rather
 than it just being useless because it's too slow is, is better than, you know, not having
 people use it at all.
 Right.
 Right.
 Right.
 Right.
 All right.
 Any other past items we want to cover?
 I think we're ready to go on to talk about what I've been doing for the last month, essentially.
 Before we do that, I just want to acknowledge some of our fine sponsors.
 I think this may be the last week we'll hear a Dell ad, maybe there'll be one more.
 They've been so good and so supportive to us.
 It's been a great three month run, and we do hope they'll come back.
 But I also want to thank all the folks who bought Dell equipment through our links on
 the Twitch page because we got credit for each and every one of them.
 All you got to do is go to twitch.tv/del.
 Even if you don't see something in the Leo's picks page, you want that the picks page
 is just stuff that I've recently bought.
 You can click any of the links there, go to Dell.
 If you're in the US and I get a number of emails saying, Oh, I'd like to, you know, support
 you from Canada or Australia or Dell's all over the world.
 Yeah, they only count US purchasers.
 So go ahead and buy your Dell equipment, but you don't need to go through our site if you're
 outside the US.
 If you're in the US, I'd appreciate it if you'd go through that site, twitch.tv/del.
 Thanks to you and to Dell for supporting the Twitch network.
 Also thanks to our long-term sponsor, Staro Corporation.
 We're so glad to welcome them back for yet another year of supportive security now.
 They were the first advertiser on the Twitch network and signing another year-long deal
 really shows their commitment to security now, and I'm just so grateful to them.
 Staro, and it's a good relationship.
 They make one of the best security gateways out there, the Staro security gateway, open
 source based, powerful.
 If you're small or medium business network needs superior protection from, listen to
 what it does, spam from viruses, from hackers, complete VPN capabilities, intrusion detection,
 content filtering, and an industrial strength firewall, and it's all in one single easy
 to use high performance appliance.
 This is it for you.
 Contact a Staro AST, ARO.com or call 877, the number four AST ARO 877-4, a Staro to schedule
 a free trial of a Staro security gateway appliance in your business.
 They are, they're great, it's a great product.
 We're glad to have them on the security now show, and we thank them for their support.
 So what is this program you're working on?
 Well, this is an outgrowth of a discussion you and I had about a month ago, I guess, when
 we were talking about 32 versus 64-bit security in the forthcoming Windows Vista kernel.
 You may remember that we made the mistake briefly of saying, well, nobody has 64-bit
 systems, those are big iron server platforms, and so it's the whole notion of the enhanced
 security that Vista offers users of the 64-bit kernel, which is significant and can be significant.
 We sort of saw that as being off in the distance.
 Well, you got a bunch of mail, I got a bunch of mail.
 People were saying, wait a minute, I've got 64 bits now.
 Certainly, there's lots of AMD 64 users who have personal workstations that are already
 64 bits.
 Now they may be still running, and they probably are, in most cases, the 32-bit Windows XP kernel,
 because as we know, compatibility of hardware device drivers has been a problem historically.
 I mean, you know, a 64-bit XP kernel has existed for years, yet its adoption rate has
 been very low because there just hasn't been a demand for it.
 I mean, there's the same sort of chicken and egg thing as like the manufacturers aren't
 doing 64-bit drivers because the users are not demanding them because they're not running
 64-bit XP, but they're not running 64-bit XP because there aren't 64-bit drivers for
 the things they want to do.
 So, certainly, this is going to be solved moving forward because 64-bits really does
 begin, as we have seen, to give us substantially better kernel protection.
 You know, as we've said before, Microsoft has been forced in the name of backward compatibility
 of they've been forced to not fix a lot of things they could fix in the 32-bit version
 even a Vista because it would break things that are coming forward from XP instead they've
 said, "Okay, we're going to make the really robust security enhancements that we wish
 we could make over on the 32-bit platform.
 We're going to make those on the 64-bit platform."
 So, the point was, after all that, I poked around and did some research wondering, "Okay,
 how prevalent, how pervasive is 64-bit support?"
 And what I learned was that, in fact, as people who wrote to us were correct in saying, not
 only are the obviously AMD 64 chips 64-bit capable, but Intel has, as a technology they
 call EM64T, which is full 64-bit support, which they've been shipping for years in,
 well, not me, not ten years, but you know, you were three.
 Yes.
 I remember talking with Andy Grovin, he was so mad that Microsoft wasn't supporting the
 64-bit capabilities of their processors.
 Well, exactly.
 So what I realized was many people who have been purchasing computers recently in the
 last few years may, in fact, have 64-bit support and not know it.
 So, okay, so there was that.
 Then there's this whole issue of software versus hardware depth.
 DEP is the data execution prevention technology, which, and this is where I'm going to spend
 the most of our time today talking about the significance and the quirky details of that,
 which are beginning to be revealed as I'm actually messing around with this stuff, and
 through a whole bunch of our great news group posters over in GRC who have been messing with
 a couple of the early releases of this software already and sort of getting themselves revved
 up and finding out what's going on.
 So there's this issue of hardware versus software support for preventing buffer overruns.
 And that's certainly a very important security feature.
 And then finally, we've talked about the VMX or as AMD calls it, or I don't know, wait,
 is it VMX?
 It's something like that.
 And it can never keep track of all these actions.
 Intel calls it VT, but in either case, they are compatible, these are the virtual machine
 extensions which are now being supported, just now being supported.
 I mean, parallel now supports it.
 I heard that virtual PC, Microsoft's product now supports it.
 Essentially, this allows virtual machines to run at identical performance as the host
 OS is.
 I mean, it's a tremendous performance boost and Microsoft has made noises.
 As far as I know, these are unofficial noises, but that they will be able to use the virtual
 machine enhancements in a future version of probably, and I'm assuming only the 64-bit
 version of Windows Vista may be 32.
 I just don't know, but they're talking about introducing a hypervisor technology to further
 lock down the kernel, because as we have talked about recently, Microsoft's kernel patch
 prevention, the KPP, or also known as Patch Guard, it doesn't actually prevent patches.
 As we've seen every five to 10 minutes, it checks to see if there have been any, and
 if so, it just shuts Windows down.
 So it turns out that that's what Microsoft is doing now, ultimately, they should be able
 to literally lock the kernel using a hypervisor that is to say something running at a level
 even lower than the kernel.
 Well, that's got to be the hardware, which is now becoming available.
 So what I realized or pushing back from this is there are three things which are really
 important security hardware features, whether your chip has 64 bits, whether it supports
 hardware data execution prevention, DEP, and whether it has the virtual machine extensions.
 And so I started to write a program called Securable, S-E-C-U-R-A-B-L-E, which is how
 Securable is your system based on the hardware capabilities.
 And so what Securable does is it's going to be a piece of freeware, probably available
 in a couple of weeks, it's running news group people have been using it.
 I'm pursuing the, you know, the final details, as I was often the case, it's ended up being
 more interesting than I expected because of how much I'm learning about what's going
 on inside of these chips in order to really make this be a really cool little turnkey
 robust utility, you know, like I like all my little freeware stuff to be.
 So what Securable does, it's, I don't know, it's like 626K or something, it's going to
 all in a set of language, of course, although it's going to be bigger because I'm digitally
 signing it and it turns out I've had to write a kernel driver for this also, which will
 be digitally signed.
 I did verify, by the way, Leo, we were talking actually last week in Toronto about whether
 Microsoft's requirement that Windows 64, oh no, it's all Vista, it's Vista drivers.
 All Vista drive, no, we were talking about the issue on 64 whether Microsoft had to sign
 the drivers or just anybody sign the drivers.
 Exactly.
 And it's not 32 bits because that would break everything, it's just 64 bits.
 So Microsoft in Windows Vista, and I think it's also the case in 64 bit XP is that only
 signed drivers will be loaded by the kernel.
 But I do.
 And by whom is the question?
 I did verify Microsoft, Microsoft has a certificate that you can freely download from them, which
 knows about your existing authentic code certificates.
 For example, I have a digital certificate, cost me about $500, which I get from Vera
 sign, and that allows me to sign my exes so that they're recognized by Windows.
 One of the things that Microsoft has been doing is they're beginning to raise the bar
 in cautioning users about running code they've downloaded from the internet.
 And my older freeware, if you download it and run it, it'll always pop up a dialogue.
 Right.
 I've seen it.
 Yeah.
 So I mean, and anyone's software, typically any freeware that you download, Microsoft tags
 it that it's from the internet.
 And so pops up a dialogue saying, hey, this is an unknown publisher.
 Are you sure you want to run this?
 You see that a lot.
 And this is in 32 bit as well as 64 bit.
 Yes.
 And again, so I mean, we're seeing this now in current versions of XP, for example.
 So signing this means that that when you download the software, you still get the dialogue,
 but it said instead of saying unknown software publisher, it says you've downloaded something
 from Gibson Research Corporation.
 And so it authenticates that that's what the software where the software is from.
 It's also doing a full cryptographic verification to confirm that there's been no modification
 to that executable from the time I signed it until it was checked in the user's machine.
 So it really does provide good authentication and integrity checking for that.
 And you're able, I think you're able to say, always trust software from this publisher.
 You can certainly say, don't ask me about this specific program every time I run it.
 And so you're able to say, okay, yeah, yeah, yeah, you know, we know who Steve is, you know,
 we like his stuff.
 We're going to run it without any questions or you can say, well, you know, ask me, but
 only ask me, you know, the first time I run stuff that we download from GRC or whomever.
 So the point is that that that authentication is extendable using another certificate which
 is freely downloadable by Microsoft.
 You sort of double sign this with Microsoft certificate and with the one that you get
 from Verusign or any of the other people who provide this authentic code certification.
 And then without any further involvement of Microsoft, you can sign drivers.
 And so, and I'll know all about this firsthand because this is what I'll be doing here very
 shortly.
 So, okay, so secure is free is the key though, and you don't have to pay Microsoft a bunch
 of money.
 Well, yes, there is that there's we have to get an authentic code license.
 Yes, so it's not free.
 And this is this is being controversial out in the open source.
 Yeah, because if I'm a free program, I have to pay how much is the authentic code certificate?
 It's like 500.
 Hey, hey, Joe, geez Louise.
 And if I didn't might even be more, I might have paid 799, so I think I got it for many
 years.
 That's going to discourage shareware authors, I have to say, and certainly open source office.
 Well, it's, I mean, here we here we are faced with a trade off.
 First of all, only 30 only the the 32 bit systems will continue to work as before.
 So it's only the 64 bit systems that have the burden of requiring signed drivers.
 The flip side is that certainly, I mean, it's it's raising the bar that what what's annoying
 is it's sort of like airport security now.
 It's not clear that you are absolutely secure after putting up with all this because you
 could imagine that somehow credentials are going to get loose in the world and and there
 will be malware, which will be signed.
 I mean, you can imagine that the malware authors are going to find a way to get their, their
 junk signed.
 If that's if that becomes important in order for them to be able to make this happen and
 you could argue then that and this is the argument that's being made is that, you know, it's
 the, as you say, it's the open source, the free source guys who are going to be in convenience
 because, you know, the whole idea is they want this to be a free and inexpensive platform.
 And in fact, I think that's one of the points that's being made by the, you mentioned it
 yesterday on Twitleo or in last week's in last Sunday's Twit that there was the free
 software foundation had launched a campaign against Vista bad Vista dot org bad Vista
 dot org and this is one of the issues they raise is that it's becoming more and more hostile
 to free software.
 You shouldn't have to pay a Microsoft tax to be a software developer.
 It's going to backfire on Microsoft.
 I don't think they understand how important it certainly is on the Mac side and Linux.
 These, these independent, you know, people like you who want to develop good free software.
 Now you can afford to buy an authentic code certificate, but not everybody can.
 That's going to kill that entire ecology.
 And that's important.
 Well, you'll get a kick out of this, Leo, for the longest time.
 I mean, I've had authentic code certificates for years and I've never been able to get
 myself to use them because they increased the size of my code by 4k.
 They double it.
 Oh, okay.
 So from 26 to 30k.
 It just bugged me.
 It's like, okay.
 I mean, it's another chunk of bloatware doesn't have to be if there's nothing that needs
 to be 4k doesn't have to be a big thing because there's nothing.
 It could be a large probably a G.U.I.D. I mean, it's probably not much, much in there.
 Well, the there was some discussion of this in our newsgroups recently and I mentioned
 that, you know, when you put in a minimal PGP signature on a piece of email, that's not
 a 4k blob, you know, it's a couple lines of looking stuff.
 I mean, that's all you need in order to have a publicly signed hash of some content.
 So anyway, it's just, you know, it's people who don't care about size end up with big
 things.
 And so that's what authentic code is.
 So anyway, I mean, that's that bad Vista.org.
 If you want to read more about that, and I'm kind of in there, but in there, you know,
 what will happen is just people won't do open source software for Vista.
 Well, arguably though, I mean, to take the flip side, because I think it's important
 we look at both sides, it will increase security.
 Yeah.
 Yeah, requiring sign drivers requiring that somebody's name beyond this, I mean, give
 away authentic code, have a free authentic code certificate for free and open source developers.
 You can imagine that like source forge would have some some maybe something like that.
 Yeah.
 But the problem is as soon as you do that, as soon as source forge like gets together
 and does a single certificate that everyone uses, well, that's completely available to
 the hackers.
 That's a good point.
 No, this is for me, my authentic code certificate is my private key.
 It is a private key that is associated with Gibson Research Corporation.
 I protect it dearly.
 I would never want to lose control of this because it would allow bad people to claim
 that their software was for me.
 So it's so it's it is something that you know, I keep locked up tight.
 I mean, it is it is in its own encrypted location and protected and I treat it very seriously.
 Yeah, so so so the problem is if we end up with authentic code credentials, which are
 floating around freely and we we know it's going to happen a couple years from now when
 it becomes important that that'll happen, then people are going to have to start looking
 at who it is that signed this, not assume that anything signed is good.
 And then we're going to have to have revocation lists that say, you know, these are the known
 bad keys, which have gotten away and which malware is being signed with.
 So again, it's you know, it's a it raises the bar.
 It's an inconvenience for people.
 It's not a black and white perfect solution because there isn't one, but it's probably
 a good thing to do.
 I mean, you know, ask me, do I would I like to?
 Oh, and you can disable this administratively and you can enable it on 32 bit systems administratively.
 Oh, you can.
 Yes.
 Oh, I'm going to make a note of that.
 So you can tell.
 So you don't have to run 64 bit windows to have the benefit of this signed code.
 And now I have to back off from that because I'm not sure if that's only developer, if
 that might be the development build, you can imagine that developers don't want to have
 to be continually signing their code while they're debugging it.
 So it may be that the debugging build is is I know the more interested in the ability
 to turn it on the ability to turn it off.
 I could see why they want to turn it off, but paternity on is great.
 It's absolutely the case that 32 bit XP and 32 bit Vista XP and Vista can require all
 drivers be signed.
 I think that's great.
 We need to publish the code required to do that.
 I think that's fantastic for 32 bit.
 Turn it on and 32 bit.
 You'll be much safer.
 Right?
 Well, the problem is since it's never been on by default, no drivers are signed.
 Oh, that's true.
 So you'll have the same compatibility issues that you're going to have in 64 bit anyway.
 Now, it's interesting though, because the signing technology is not a big deal.
 If I were really, if I were really uptight about this, I could sign other people's drivers
 just so that they have a signature, then turn that on in XP.
 And then if anything else, if any hostile junk tried to get itself installed, it would
 be blocked.
 And then I could say, wait a minute, what's this that I have not signed?
 So an advanced user could have his own certificate.
 Would he have to have the authentic code or could he just use the free one from Microsoft?
 No, no, no, the free one from Microsoft goes hand in hand with a commercially purchased
 certificate.
 But a business, here's a good use for it, a business, the IT department could purchase
 one certificate, sign acceptable stuff, turn this featured on a 32 bit and then nothing
 else will run.
 Yep, and that's something that you are able to do at the -- what's the name and windows
 for the whole bunch of extra settings that IT control?
 It's not a policy editor.
 Yes, it's a group policy editor.
 That's where you're able to set a policy, and it could be pushed out for a good one.
 I think that's good.
 That is a very smart thing to do if you're in an IT department.
 It's a cool trick.
 Yeah.
 It's worth mentioning though, you were talking about how I can afford authentic code because
 this is what I'm doing because for me, certainly as GRC, having my stuff signed is important.
 But it's not like it's really that free, even now, to develop for Windows.
 It's like, well, yes, you can write code, but I pay Microsoft $2,500 a month, or am I
 sorry, a year for the MSDN package, which is a big blob of DVDs, which they are constantly
 revving.
 Do you have to have that?
 Couldn't you just buy Visual Studio?
 Do you have to have the full MSDN library, is there that much new stuff that you need
 to have?
 No, you're right.
 What I'm getting -- you're exactly correct.
 What I'm getting is all the OSs and all the versions of everything and the developer tools,
 you are.
 You could get a -- Just by Visual Studio, but that's still their development stuff.
 That's still expensive.
 I mean, it's not cheap.
 No.
 In fact, they're increasing the price and they're just like changing the way it works.
 It's many hundreds of dollars for that.
 So I may be wrong, but I just think that an operating system relies quite a bit on these
 independent third parties, sometimes very small, developers, including open source and free
 software developers.
 Those are important.
 Well, and the developer community has got all these tools that are available too.
 So I mean, there are free compilers, there are free libraries.
 You can definitely do it on the cheap, but if you go the normal sanctioned route, it's
 already not free to write software for Windows.
 No, you're right.
 Good point.
 So anyway -- Which, and by the way, the complete opposite on the Mac platform, they give you
 all this stuff.
 No kidding.
 Yeah.
 Oh, very cool.
 It comes on your install desk.
 Well, and for example, there have been other compilers than Visual Studio.
 .com was available, certainly Symantec has made a compiler for years.
 But they're all dead now because everybody uses Visual Studio.
 I know
 that.
 And I know that a lot of people use Visual Studio, but I don't know what that means.
 I know that a lot of people use Visual Studio, but I know that a lot of people use Visual
 Studio.
 I know that a lot of people use Visual Studio, but I know that a lot of people use Visual
 Studio, but I know that a lot of people use Visual Studio, but I know that a lot of people
 use Visual Studio, but I know that a lot of people use Visual Studio, but I know that a lot
 of people use Visual Studio, but I know that a lot of people use Visual Studio, but I know
 that a lot of people use Visual Studio, but I know that a lot of people use Visual Studio
 Studio, but I know that a lot of people use Visual Studio, but I know that a lot of people
 use Visual Studio, but I know that a lot of people use Visual Studio, but I know that
 a lot of people use Visual Studio, but I know that a lot of people use Visual Studio, but
 I know that a lot of people use Visual Studio, but I know that a lot of people use Visual
 Studio, but I know that a lot of people use Visual Studio, but I know that a lot of people
 use Visual Studio, but I know that a lot of people use Visual Studio, but I know that
 a lot of people use Visual Studio, but I know that a lot of people use Visual Studio, but
 I know that a lot of people use Visual Studio, but I know that a lot of people use Visual
 Studio, but I know that a lot of people use Visual Studio, but I know that a lot of people
 use Visual Studio, but I know that a lot of people use Visual Studio, but I know that
 a lot of people use Visual Studio, but I know that a lot of people use Visual Studio, but
 either 64-bit version of XP or the forthcoming 64-bit version of Vista that will definitely
 give you much more security.
 I know that you said in Twit last week, Leo, and we talked about it also up in Toronto,
 you've got the 64-bit Vista, and you're getting, you know, you're rubbing your hands together,
 getting ready to load it and see how it goes.
 That's my project today.
 In fact, I'm just right now, as we speak, Drive Snapshot is making an image of my Vista
 32-bit off the laptop, so if it really is a horrendous experience, I can quickly go back
 to 32-bit, and I've got the Vista 64 disks sitting right in front of me.
 Huge, though, by the way.
 You need a DVD.
 It's almost four gigs.
 Yes.
 It is a lot bigger.
 Sure.
 Well, and even 32-bit is 2.678 gigs or something.
 Why with the 64-bit code inherently bigger?
 What I've heard, and this is just anecdotal, I've heard that the 64-bit system, for whatever
 reason, also includes 32-bit versions of all of the apps, in addition to 64.
 I see.
 So you're getting, you know, double, double to trouble, essentially.
 You may get there before I do.
 I mean, I very much want to be running this.
 In fact, I probably will have to, before I'm able to put the 1.0 version stamp on Secureable.
 My supposition, though, is that Microsoft has accumulated so many drivers for existing
 PC hardware that certainly Vista 32 knows all about the hardware that I've exposed it
 to so far.
 I mean, it's running on all kinds of stuff.
 You know, even an old tablet PC, my old HP TC-1100 is running it perfectly.
 So I would imagine that Microsoft has taken all of those drivers, compiled them in 64-bit
 version and that the 64-bit Vista may be very hardware compatible, which would really help
 it a lot.
 Wow.
 Very interesting.
 So, Secureable will tell you when you run it, whether you've got 64 bits hiding in your
 chip that you may not know, that would allow you to run the more secure 64-bit version
 of Vista, or for that matter, you know, the current 64-bit version of XP, it'll tell
 you whether you've got hardware DEP.
 Now, DEP is, I think, the single most important security feature to happen in a decade.
 I'm not kidding.
 I'm not kidding.
 execution prevention.
 Yes.
 What this is, and we've talked about it in passing, in fact, you and Paul talked about
 it was one of the title acronyms in last Windows weekly a couple of weeks ago.
 What this does is essentially it allows the system to stop virtually all buffer overruns.
 Wow.
 And that's big.
 I mean, all the security problems that we encounter with an incredibly small exception
 are buffer overrun attacks, you know, anyone who's been listening to security now for the
 last 71 weeks has heard buffer overrun, buffer over, I mean, over and over and over.
 These are the kinds of problems which catch programmers.
 And we've talked about how the stack works and as a consequence of the way it works,
 if somehow it's possible to inject a longer string of data or longer, you know, a longer
 response into some sort of control that isn't expecting that, that that doesn't specifically
 limit it and clip it off.
 And more often than not, it's something the programmers have to deliberately do.
 If something's able to do that, it's possible to cause the computer to be remotely compromised.
 And you know, I mean, every second Tuesday, I mean, literally every second Tuesday of
 the month, Microsoft is patching multiple buffer overrun problems.
 They're just all over the place.
 So, so the idea is the, the, the architecture of our computers is, is based on 4K byte,
 what's called pages of memory.
 And the idea is that this, this system deals with memory in these 4K pages.
 It's 4K byte pages, which are swapped out to the virtual memory partition as the system
 is shuffling its memory around everything is done in these 4K pages.
 These pages are controlled by the system's memory management system, which knows which
 pages are swapped and which ones are out where they're physically located in memory.
 Additionally, pages have had the, had bits associated with them that sort of governed
 what the system could do.
 There were read permission and write permission bits, which individually allowed on a 4K page
 granularity, it allowed a 4K page to be marked as readable and or writable.
 So it was possible for the system to protect pages from being written and make them read
 only or to protect them from being read, for example, and make them write only, although
 that's not commonly done.
 And essentially when, whenever any code in, and this is, this is enforced at the hardware
 level, that is in the chips silicon, which is what makes it so powerful, any code that
 violated the rules that had been set by those bits governing that page would, would generate
 a hardware exception as it's called that would yank control instantly away from the program
 that had, that had misbehaved and transfer control to the operating system along with
 information about what exactly it was that had just happened.
 So it doesn't shut the system down.
 It just takes control away.
 Yes, it just says bad code, bad code, bad code.
 So, so what has happened is recently, and this is only in the last couple of years, Intel
 and AMD have added another bit to the page management system.
 In addition to read and write permission, there is now execute permission.
 And this is huge.
 I mean, it is, it is such a, an obvious thing.
 It's the kind of thing you was, it's like, why didn't we have that 20 years ago?
 I mean, it would have been trivial to put in, just didn't occur to anyone.
 Well, there wasn't a problem 20 years ago.
 Okay, well, there was 15 years ago, I mean, yeah, I think there's, there's always been
 a problem.
 I mean, it's just bad code.
 I mean, if it's not a hacker problem, it's just a problem.
 You know, Unix predates Windows, it's 20 years old, it's, it's had root kit problems from
 day one, and those have been buffer overrun exploits.
 Right, so I mean, it's, it's always been a problem, you know, it's just bad programming.
 I mean, it's, it's things like using str copy, stir copy, instead of strn copy.
 There's no range checking.
 It's just, it's sloppy programming.
 That's what gets me.
 Well, you know, I, I don't mean to disagree with you, but as a programmer, I can tell
 you that, I mean, when you're an assembly code, you got no range checking, unless you
 write it.
 By hand.
 Well, yes, but I mean, I'm, I live in fear that I'm going to screw up.
 My point is that it is so easy to take your eye off the ball for just a minute.
 And, and, and the idea, you know, and we've talked about several weeks ago, why is security
 so hard?
 It's that, you know, the programmers, the developers mindset is get this thing to work.
 Now, I mean, I have a heavy layer of, and it better not have any security flaws in it.
 Right.
 And certainly any conscientious programmer who's writing internet code today is got to
 be aware of security.
 That's going to be the forefront of the, in the forefront of their mind, you know, that's
 going to be a focus for them.
 So certainly they're aware of that.
 But it is easy to make a mistake.
 All right.
 So, so, so, so here's what's cool is that this, when the system supports DEP, all of
 the pages, which the system does not expect to have code executing in can be marked as
 non-executable.
 So that would be the stack for one thing.
 That'd be the stack.
 It would be something called the heap, a heap of something we've never really talked about.
 But it's, it's the way the system, the, the system makes memory freely available for allocation
 by program.
 So for example, if I need a 4K buffer, I'll allocate a buffer, I can allocate it from
 the stack, or I can allocate it from the heap.
 Now unfortunately, a lot of programmers put executable code in the heap.
 I mean, it's not an unusual technique.
 Well, I wouldn't say a lot.
 I mean, it certainly is the case that it can be done.
 And even in the stack, I mean, there are some, and that's why those programs break when you
 use DEP.
 Well, yes.
 Historically, in fact, the, the very early Windows GUI when, when, when, you know, processes
 were 4.77 megahertz and, and we were trying, you know, it was just painful to drag a window
 around the screen.
 In fact, in fact, you didn't drag the whole window.
 You just dragged a dull dotted outline because you, you couldn't drag the whole window.
 Right.
 I mean, it would have just been really excruciatingly slow.
 But then Microsoft's clever, there, there was a thing called the bit-blit instruction.
 Yes.
 Or, or, or, or, or the Blitter is the thing in, in, in, in, in old GUI terminology that,
 that moves rectangles of, of pixels around the screen.
 The Blitter was actually written on the stack on the fly in order to make it as fast as possible.
 So, so old Windows actually, you know, by, by policy and by technology used the stack
 as a, as an executable scratch pad.
 So it turns out, though, that, you know, many programs no longer do that.
 And if, as you said, Leo, it's true that some do, it's, it's certainly the case that virtually
 all exploits are buffer overrun mistakes, which all would be caught if the system had
 hardware data execution prevention.
 So, and it turns out that many of the chips introduced in the last few years have it.
 Now, what we've learned, however, is a couple things.
 Many of the biases that, that the people in our news groups have that do on systems that
 have hardware data execution prevention, they've got an option in the BIOS for turning it
 off.
 And in fact, I, I bought a little HP Pavilion here not long ago.
 It has the option for turning it off.
 At least mine was on by default.
 Many people are finding that theirs is off by default, meaning that, that at boot time,
 the BIOS disables the hardware data execution prevention option in the chip, such that when
 the computer looks at it, it believes it's not present.
 So, so anyway, it turns out that there's something called a model specific registers,
 MSRs, which is what the BIOS uses for turning this off.
 User mode code that is like my program secureable is unable to access the model specific registers
 from user mode without blowing up.
 It generates a data exception error and it will shut down the program.
 So I'm unable to see from user mode, whether this bit has been said or not, thus, I've
 written a kernel mode driver, which secureable brings along with it.
 It's still a single XC, it's still small.
 It just drops it out of the bottom of itself, briefly loads it in the kernel and, and, and
 checks the model specific registers, sends that information back up to my little secureable
 app and then removes the driver.
 So it's just, it's, it's just installed in the kernel briefly in a blink, it's removed,
 and that allows me not only to tell users whether the system can see whether they've
 got data execution prevention, but also whether they might actually have it if they think
 they don't, but their BIOS is one of those, which defaults to having it disabled by default.
 So, so anyway, I've, you know, I've rolled my sleeves up.
 No kidding.
 This sounds like sleeve rolling time.
 Yeah, it's, it's been sleeve rolling time.
 So basically it's going to be a complete presentation of these three security features, whether
 you got 64 bits, whether you actually have hardware depth support and whether your system
 supports the, the, the virtual technology extensions.
 And it turns out though that this is also sprung into a second piece of software, which will
 be called, I think it's going to be called in depth D E P T H. And that's going to be
 something that's going to verify all these depth things for users.
 That is, it's one thing to know your system has the capability.
 It turns out though that this depth has many different modes of operation and some of this
 is very mysterious.
 For example, you can run it as you mentioned about opting in and opting out.
 There are opt in and opt out modes.
 The opt in is the normal case and no things are opted in except some of Windows binary.
 Some of Windows code that they know won't run unless you turn it off.
 Oh, no, that they know will run and it's and it's a fault.
 I see, I see.
 Yeah.
 So, so, so they're binary.
 Some of theirs are, are enabled for depth because they know they're safe and they would
 like any buffer overruns that occurred in them to be caught.
 But for example, all, I mean, the rest of the applications, lots of applications are
 where an active X controls are where these problems are.
 It turns out that you can then use a mode called opt out where Microsoft says that everything
 not opted out of will be checked for any buffer overruns, which would lead you to believe
 that everything would be checked except there's a third mode called always on and it turns
 out get this that you would think that always on would be the same as opt out if nothing
 had opted out.
 It's not.
 Many people have discovered that there are programs they use which work fine with opt
 out but do not work with always on.
 Why not?
 So they're not checking those programs?
 It's a mystery.
 It may.
 My hypothesis is that opt the opt in opt out might only be checking the user mode buffer
 overruns and not device drivers.
 But when you use always on, it's checking everything system wide.
 And there are device drivers where there are problems.
 For example, the current build of Adaware fails this.
 There've been, you know, users in our news groups are posting their findings as we're
 experimenting with this.
 I will have a complete comprehensive presentation to offer our security now listeners a few
 weeks from now once I've unraveled all these mysteries.
 But what's interesting is there is zero documentation of this on Microsoft site.
 We mean we have been scouring looking for any explanation, for example, for why always
 on is different from opt out where nothing opts out and Microsoft says nothing about it.
 So it's going to end up being okay, do a bunch of experiments, figure it out the hard way,
 and that's what I'm going to do.
 So anyway, I'm having a ball writing some new free software that came rose from security
 now and it'll be made available to everyone and certainly to all of our security now listeners.
 Excellent.
 Excellent.
 Excellent.
 Absolutely.
 Free as always.
 And a lot of nice features it sounds like.
 In fact, it sounds like the kind of program you'd want to run just to kind of know what's
 going on on your system.
 Well, and one other thing too is that people have mentioned, hey, you know, they could
 send this to someone who's computer, they were going to purchase or you might be able
 to get a dealer to run it or tell me what I'm buying here.
 Exactly.
 If a friend of yours said, hey, I just got a really cool system, you know, from Dell,
 for example, you know, someone could say, hey, well, run opt out.
 I mean, I'm sorry, run opt out is a long time ago, run secureable from GRC.
 Tell me what it says.
 Because I mean, it's a very simple display, it says 64, yes, yes.
 If you've got everything or 64, yes, no.
 If you've got depth, but not the virtual technology extension.
 So I mean, it'd be very a very super quick way of telling you, you know, some things
 you care about about the security of the system you're on.
 Right.
 Great.
 Great.
 Great.
 When we look for that in the next couple of weeks, but you're going to take some time off for
 the holidays.
 I hope please don't work.
 No, no, no, no.
 I'm right in the middle of this.
 I'm having a ball.
 Oh, Steve, Steve, Steve, what are you doing for Christmas?
 Anything?
 I'm just going home for a couple of days up to see my family in San Mateo.
 All right.
 Well, Steve, as always, what a great pleasure having you on.
 And I just can't thank you enough for doing the work you do to secure us all.
 I mean, it's little things like secureable that really you give them away and it makes
 a big difference.
 I think you probably don't even know the kind of impact you have made.
 But I do.
 And I thank you for it.
 I love, love doing it.
 It's been a great year of shows.
 We have one more before the end of the year.
 What are we going to talk about next time?
 Well, it's number 72.
 Oh, we're going to Q&A it.
 It's a mod fork.
 It's our Q&A number 14 next week.
 We will do that next week.
 Unlike all the other Twitter podcast, Steve is sticking around.
 And so is Spinrite.
 And you know, people have hard drive problems even on the holidays, don't they, Steve?
 Maybe even more so when the kids come home from school or they get a new computer and
 is just dead on arrival, Spinrite is the solution is the ultimate disc recovery and maintenance
 utility.
 It's Steve's day job.
 And he works just as hard on it as he does in all the security stuff, S-P-I-N-R-I-T-E.info,
 if you want to know more, a lot of good testimonials in there, of course, g-r-c dot com and Steve's
 site.
 We're going to find the 16 kilobit versions of this show for the bandwidth and paired the
 transcripts.
 Thanks to Elaine and more information as well.
 We'll see you at the next week.
