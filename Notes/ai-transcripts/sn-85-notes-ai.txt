 NetCasts you love, from people you trust.
 Bandwidth for security now is provided by AOL Radio at AOL.com/podcasting.
 This is Security Now with Steve Gibson, Episode 85 for March 29, 2007.
 Cross-site scripting, Part 1.
 Security Now is brought to you by Astaro, makers of the Astaro Security Gateway, on the web
 at www.ASTARO.com.
 And by Nerds on site, looking to grow your IT service business, find out how Nerds on
 site can help visit, I want to be a nerd.com.
 It's time for security now, and that means it's time to say hello to Steve Gibson from
 his ultra-secure, Tempest-hardened layer somewhere in Southern California.
 I hope it's ultra-secure.
 You know about Tempest, right?
 Oh sure.
 The military spec for hardening what, technology devices, right?
 Well yeah, the idea was that anything that's electronic has emissions coming from it.
 That is, you know, anytime you've got current running through a wire, you generate a magnetic
 field around the wire, and when the frequencies are high enough, that ends up generating radio
 frequency emissions, which of course travel much greater distances than magnetic emissions.
 And so the whole concept behind Tempest was, you know, like in the spy era, was that you
 could passively monitor the emissions of things like computers and reverse engineer what they
 were doing, like what literally what was on their screens and what people were typing
 and so forth.
 They call that, I think, Vanek Freaking, at least that's what Neil Stevenson calls it
 in, Cryptonomicon, which we were talking about before we began here.
 But we'll get to, we're going to talk about books a little bit later on.
 Yeah, we have some errata from last week, actually only really one piece.
 Someone commented that I messed up my ports.
 We were talking about SSH and Telnet and, you know, I mean, I know what the port numbers
 are, but you know, I just got myself scrambled up there.
 So just for the record for, you know, in the errata category, FTP uses two ports, 20 and
 21.
 That's where I went wrong.
 I said 21 and you said, no, that's not, that's the Telnet port.
 So FTP is 21.
 Okay.
 Exactly.
 FTP is actually 20 and 21 because remember that the FTP uses two channels, one a so-called
 control channel, which is where the client and server talk to each other about what they're
 going to be doing, and then a separate port is the data channel.
 So they have a control and a data channel instead of create a random port for the transfer.
 And that's why you have to use passive FTP because it's an incoming random port that
 the server sets up.
 I see.
 Well, yeah.
 Yeah, the way it works actually is that in the normal sort of the default FTP is called
 active FTP or non-passive FTP normal.
 What's tricky about it?
 And in fact, this caused problems traditionally for people behind NAT routers is that these
 connections go in opposite directions.
 That is you, the client, you connect into the FTP server and then, and then this server
 connects back to you.
 So the idea being that you would say to the server, "Hey there, I want a connection and
 you can connect to me on this port."
 So you tell the FTP server what port to connect back to you on.
 So the client is also a server in the sense that it's going to accept an incoming reverse
 connection from the FTP server.
 The problem is that if you happen to be behind a NAT router, you don't, you know, computers
 behind NAT routers hopefully don't have to know that they're behind NAT routers.
 They don't have to do anything special.
 So, so the problem was as we know, NAT routers make really good firewalls, hardware firewalls.
 So, so here the FTP client connects out to a remote FTP server and it creates, it sort
 of starts listening on some high numbered port on its computer saying, "Hey remote server,
 connect back to me."
 Well, when this remote server tries to connect back to it, it's blocked by the NAT router
 because the NAT router has no idea that, you know, what's going on.
 It thinks this is just an unsolicited packet.
 So what, so there were two solutions.
 The first was to change the FTP protocol and in so-called passive mode so that both connections
 are outgoing from the client and that solves the NAT router problem.
 The cooler solution, which now all contemporary NAT routers support is they're smart enough
 to see a packet going out to port 20 of the remote FTP server and to literally look inside
 the packet to interpret the packet in the same way that the FTP server will where it
 says, "Make my reverse connection on this port."
 So the router dynamically opens that port for the FTP server's reverse connection.
 So it allows regular active FTP by being basically by participating in the FTP protocol.
 Very cool.
 So, and then just to finish, we said tell that, we said tell that wrong and SSH runks.
 So what are the ports for tell that and SSH?
 SSH is 22 and tell that is 23.
 23, that's it, okay.
 Exactly.
 And yeah, it's funny too because I wanted to, when I was making sure that I wasn't going
 to get myself scrambled here, I said, "Well, I'll just use GRC's port authority.
 I've got a cool facility on GRC.
 I don't even know if you know about this, Leo, but if you just go grc.com/portequalssomething
 like port equals 23.
 My server sees that and any kind of like URLs of that form, it's very flexible and it will
 immediately take you to one of our port authority database pages.
 And so that's why we just go there and we look it up and now we know.
 And now we know.
 And we should have done that in the first place but we were doing it off the top of our
 head anyway.
 Yeah.
 Much further, I just want to mention the great folks as you know who are back sponsoring
 the show.
 The nerds on site.
 We need a little, I think they need a jingle.
 The nerds on site are here.
 The nerds on site.
 I don't know, maybe.
 Oh, Leo, you may not want to ask them for that.
 That could be really scary.
 Nerds on site is actually a neat idea.
 It's a guild or a, I don't know, federation federation, maybe a tech support specialist
 IT experts.
 The idea is you're still an independent contractor, you're in business for yourself, but you're
 not by yourself.
 So you can focus on your passion, not the burdens of running a business worldwide, seven countries.
 In fact, I think they added an eight, eighth country is Canada, US, Mexico, England, Australia,
 South Africa, Bolivia and more.
 And if you're in business doing any kind of thing, whether it's fix it, technicians,
 website designers, your programmers, project managers, even sales, trainers, security experts,
 antivirus, gurus and more, but they, they especially love, of course, those folks, those nerds
 who troubleshoot, tear apart and rebuild their own systems in their spare time.
 Go to I want to be a nerd.com and register for a nerds only meeting in your area today.
 Like minds, building a business, it's a great idea.
 And I'm really glad that we can help them out.
 Nerds on site.
 If I want to be a nerd.com, you know, and I guess since they initially gave us a three
 week, a relatively short three week run, and now have, have re-upped for three months,
 it must be that there is a good intersection between the, you know, our listeners, security
 now listeners and the kind of people that they're hoping to find through this campaign.
 I want to be a nerd.
 A lot of nerds listening, I think Steve, well, speaking of which, I don't want to press you
 or anything, but I think that's the fact that you know, these are our people, they all mean
 of us.
 I'm, I'm one.
 God knows.
 Today we're going to tell the story, which I just recently learned about your, your wine
 seller that you're, Oh, my, my radio telemetry.
 Yes.
 We'll, we'll, we'll do that sometime.
 Steve had a lot of feedback, very positive feedback from people who have, have followed
 our mentions in the past of, of Peter F. Hamilton's books.
 You know, we talked about Pandora star and then the sequel, Judas Unchained and recently
 fallen dragon.
 I've got, we had a bunch of comments back from people saying, wow, I really loved fallen
 dragon and specifically saying, you know, it, you know, what else do you know, you know,
 who else, you know, have you discovered that is, is equally good.
 And, and I have to say that the kind of sci fi I like is, is more along the so-called,
 you know, hard sci fi variety.
 I've never really understand, understood why, you know, wizards and unicorns and things
 are like in the sci fi section of bookstores.
 It's so annoying.
 They got nowhere else to put it, I guess, but I don't think that side's fiction at all.
 I mean, it's fiction, fiction, you know, fantasy and I guess also it's, it's often you see
 like fantasy and sci fi.
 Well, to me, they're, these are completely different genres.
 But I did want to share thanks to, you know, the, the, the quest from people for additional
 authors.
 I wanted to share another one of my finds that I am very excited about.
 This is a, this is a guy who is literally a rocket scientist.
 He designed pumps that are on the international space station.
 He's he's an aerospace engineer located out in Arizona and he writes really good science
 fiction.
 He's got a, he's got a site and we'll put a link to this on our episode notes.
 It's sci fi hyphen AZ.com SCI fi hyphen AZ.com his name is Michael McCollum.
 And actually he and I were just exchanging some, some email because I wanted to find
 out about the, the various formats he offers.
 He has his books in, in paperback.
 So you can buy them that way, but also electronically downloadable, both PDF, Microsoft reader and
 in palm format.
 And he just released the sequel to a book of his that I had read, I don't know, about
 a year and a half ago that I really liked.
 It was called Gibraltar Earth.
 And I was telling you about it a little bit before we started recording that the humanity
 has never encountered any other aliens and we're out in the future exploring around.
 And we stumble upon evidence of a vast intergalactic race that up, that is so powerful that it
 just stops basically in slaves, any other species that it encounters.
 Yeah.
 But, and they don't know, they, they don't know that we found out about them.
 So we scurry back to earth with our table between our legs and the story unfolds from
 there.
 We've just done a sequel to that that I'm, that I haven't read yet that I just discovered
 because I was, I was looking up his site in order to tell our listeners about him, but
 that there's another trilogy, the Antares trilogy, which is just spectacular.
 So anyway, I, I give it my unrestrained, obviously, full recommendation to, I mean, all of his
 stuff is really good.
 He also has some freely downloadable short stories, I've, I've not read them because
 I've just found his regular stuff to be so good.
 So without, without reservation, I can recommend this Michael McCollum at sci-fi-az.com.
 I don't know.
 I don't have any sense for how much people enjoyed the ebook experience.
 You know that I'm a major ebook reader.
 And in fact, you and I leave both just purchased than the new Sony E paper reader.
 I've never even, I've seen it.
 I have, I have not yet used it, but I'm excited to give it a try and see how it feels.
 Yeah, I've been using, I just got it yesterday and I used it last night and I read quite a
 bit of Neil Stevenson's Quicksilver, which I had in hardcover, but I thought, well, you
 know, I don't want to carry these to Canada.
 They're too big.
 Well, especially, especially, you know, Stevenson's books are like, I mean, they're like carrying
 an encyclopedia around with you.
 So I bought the Quicksilver Trilogy and the funny thing is it's only 10 megabytes, all
 three books, which is their three huge books.
 And I put them in a bunch of other stuff and I haven't even, there's a hundred megabytes
 worth of storage to start with on that ebook reader and I still haven't filled it for that.
 It's taken me.
 I'm not used to reading on electronic devices, small and lightweight, very thin.
 And it feels like a paperback.
 I got a little book light for it too, because you know, you need ambient light.
 Right.
 And it's an E paper display, which is to say they actually have, they've got bi-colored
 spheres white on one side, black on the other, and they electro-statically rotate the spheres
 to either have their white face front or their black face front.
 And then the beauty is once you've spun these spheres, they require no power because they're
 in a viscous medium.
 They just hold their position.
 It's very clever.
 Yeah.
 I mean, well, and you know, E paper, we've been reading about it for literally I think
 decades, but it's one of those ideas that's been, you know, it's been on the drawing board
 and hard to actually put into production.
 And but Sony, as far as I know, is the first commercial E paper technology.
 And what's cool about it is battery life issues just go out the window.
 I mean, you know, they say you can read all of War and Peace four times on a single charge.
 So there's just none of that.
 But we'll see.
 I'm going to, I have a lot of books on there and I, I had the Antares trilogy and I'm now
 on your recommendation going to buy the Gibraltar books.
 And unfortunately, I had the Antares trilogy in Microsoft Lit format, which is an incompatible
 format.
 But I'm going to get them in pay PDF.
 I wish more authors would do it.
 There's, there are quite a few books I can't get, including, I mean, only, only Pandora
 Star is the only Peter Hamilton book in the Sony Connect library, but I don't care if
 it's Sony Connect, just put it on PDF and I can read it and I would love that.
 Well, and, and I really appreciate this too.
 I mean, and I know you will.
 Michael does not, um, no.
 No.
 Uh, exactly.
 He, he does not.
 Well, except that I wonder about the lit format is.
 Yeah.
 Yes.
 The, the Microsoft reader would be, but it is a non protected PDF in his, I read his license
 page yesterday also and he said, look, you know, I'm doing this because I, I want to
 trust everybody, you know, please don't post these, please pay for them.
 Don't share them.
 If you like my work and you want more and believe me, I mean, I really want more.
 This guy, his books are just so good.
 He says, you know, pay for them.
 Don't steal them.
 And then this can work.
 Well, I've been twice now for entire.
 So I don't mind.
 It's so cheap.
 15 bucks for three books.
 Come on.
 Oh, and Leo, let me tell you, you have a treat in store for you with this entire series.
 It just, it's so good.
 And now I have too much stuff to read.
 This is a bad thing.
 I've got a, this ebook reader has literally that now 20 or 30 volumes on it.
 Yeah.
 And how did you find, because since I haven't not yet had the, the Sony e paper experience,
 and you know that I don't mind looking at a little tiny Palm pilot screen, how did you
 find that, that screen?
 It's pretty good.
 You know, you could set the text size to small, medium or large.
 And of course, I'm getting old, so medium was good for me.
 It isn't high contrast.
 I would like it if it were a wider background with black text.
 It's a little gray, but it's fine.
 I mean, it's better than a palm, I think.
 And it's certainly a bigger screen than a palm.
 And the only other thing that bugs me a little bit, there are two different ways to turn
 a page neither of which is very natural, at least not for me.
 And there's a flicker when you turn the page, which I find a little annoying, but these
 are minor.
 And I did find it easy on the eyes and I read quite a bit, I read about 20 or 30 pages
 last night and I didn't have any eye fatigue, so I think it's going to work, you know, be
 great for an airplane and great for traveling because I can now have my whole library with
 me.
 Yeah, I'm really fanatical about battery issues.
 And so for like, if I'm reading in a restaurant and, you know, the waiter comes over to talk,
 I have to like, you know, I mean, I do, I turn the power off.
 You won't have that problem with this.
 Well, exactly.
 With this, you literally, you just, you don't even worry about it.
 You just lay it down because it's not consuming any power.
 And it looks a little bit like a paperback, you know, I mean, it's thinner than a paperback,
 but it's not much bigger.
 And so that's kind of, I mean, you don't look like too much of a weirdo.
 Yeah.
 And it plays music too, doesn't it?
 It does.
 I'm not sure how the battery life would be with that, but it would probably pretty much
 kill it.
 Yeah.
 Well, there was one, I had one, uh, spin right, uh, fun story that I wanted to share.
 I'm not going to read Tom's last name because, uh, well, you'll see when I read the story
 why he may, he may not want me to identify him, he said, Steve, I looked all over the
 site and could not find anywhere to leave some feedback.
 So I'm mailing you here.
 I think he must have sent it to our support email and then Greg forwarded to me.
 He said, I'm a Windows systems administrator and I've been dealing with bad hard drives
 for quite a while.
 I've been listening to Twit and security now since the beginning.
 I've been trying to get my boss to purchase, been right for years, but it never seems to
 be in the budget.
 Because I am a father of two small boys and daycare costs are killing me.
 I've not had the funds to purchase spin right for myself, but I have heard and read many
 of the testimonials and would love to try a copy.
 So he says, finally, last week a coworker came to me with his dead laptop.
 He had all of his wedding photos and many hundreds of dollars worth of downloaded music
 on his drive.
 I looked at the laptop and knew for sure that spin right could fix his problem.
 I wonder how he knew that.
 How would you?
 Why would you think that?
 He says, so he says, well, I got a copy of spin right through some nefarious means.
 Oh, shame on you, Tom.
 He says, sorry, Steve.
 And sure enough, spin right brought the hard drive back to a working state and I was able
 to recover everything.
 He says, when my coworker found out that I got everything back for him and made backups,
 he was delighted.
 He asked me what I would want in payment.
 I said $89.
 He looked at me strangely and said, why 89?
 I told him, I told him about spin right and how I got a copy.
 So right then and there, he pulled out his credit card and we went to grc.com and purchased
 spin right.
 I feel a lot better now having a legal copy.
 Thank you, Steve, for the great product and I can't wait to help others in the future.
 It's a nice tool to have because for exactly that reason, you know, people, when people
 come to you, you can say, well, let me try spin right on it and it's really nice to own.
 I have to say it is worth, it is well worth the 89 bucks.
 That's neat.
 What a nice story.
 It's a happy ending.
 He ended up buying it.
 That's great.
 And, you know, frankly, I don't have any problem with that.
 I mean, that's why I read this, you know, technically piracy, well, yes, but I recognize
 that, you know, not everyone who needs it is going to buy it.
 I really appreciate it obviously when people do because it's what keeps me on the air literally.
 Right.
 So, you know, it's a win for everybody.
 That's great.
 Well, thank you, Tom, for sharing your story with us.
 And now, what are we, we haven't told anybody we're going to talk about today.
 No, 20 minutes in and this is a big mystery.
 But it is important.
 Well, if you've if you heard the title and you heard me announce it, I guess you probably
 know.
 We're going to talk about something that is a big security issue.
 Wait, wait, wait.
 Are you announcing this some other time?
 I don't think you even gave us.
 Well, at the beginning, you don't hear it, but at the beginning of every show, I say,
 well, and I tell them the name of the show and the date just so that if you're listening
 on a shuffle or something and you don't have a readout, you know what you heard this one
 or not.
 So they know that this is cross site scripting part one.
 They may not know what that means, but they know what that what we're talking about.
 So what are we talking about?
 Yeah, it's something that we have we have never yet touched on.
 I don't even think at all.
 I mean, most of the time will will like, you know, swing by some topic when we're talking
 about something else and then move on and then later, you know, weeks or months later, come
 back to like really focus on something that we've talked about before.
 What I would I would generalize cross site scripting a little bit more and say that it
 is about web based code injection and cross site scripting is one major way that that
 can happen.
 The other one is buffer overflows.
 Well, no, because that's that's not necessarily web based.
 That's a technique.
 Exactly.
 Well, in fact, we've of course extensively talked about buffer overrun issues.
 The anion in buffer run buffer overrun issues a hacker is is injecting executable machine
 code essentially into directly into some other application over a communications connection.
 So so this kind of so so you're certainly right that that is also remote code injection.
 In this case, we're talking about web based apps, which turn out to have a disturbing number
 of vulnerabilities to this kind of exploit, but but the second type is something called
 sequel injection or SQL injection SQL having pretty much become the de facto dominant database
 language, because it's you know, there's now open SQL, my SQL, Microsoft, of course, is
 is pushing SQL or SQL as it is often as that acronym is also is often pronounced and it
 turns out that because sequel is scriptable, you know, how I feel about scripting Leo,
 yeah, there's all kinds of problems there too.
 So so for a long time, I've had this on my list of things to talk about, but something
 happened last Saturday afternoon on the East coast that sort of said, okay, now is the
 time to discuss this.
 So this is a big topic and because we're doing an audio podcast and I want to make sure people
 are able to visualize this, I'm not going to try to cram too much content into this
 first introduction.
 So so to this week is sort of introduction to this issue, this will be sort of the teaser
 for what I think will be the next two weeks.
 And then the week after that will be back to one of our Q and A's where we'll be able
 to tie up any loose ends and answer any questions that have come about from talking about this.
 So what happened last Saturday was that a guy named Billy Hoffman from SPI Dynamics,
 which is a well-known good reputation security research firm.
 He gave a presentation at a at a funny name to hacker conference called Schmukom.
 It's a three day was Friday, Saturday and Sunday, a three day East coast hacking conference.
 The title of his talk was JavaScript malware for a gray goo tomorrow.
 I like it.
 I don't know what it means.
 But I like it.
 Well, I the gray goo is in that a nano tech problem that people have raised that maybe
 if there were too much nano tech would all become gray goo just become just be reduced
 to gray goo just sort of like a thoroughly homogenized slurry.
 Okay, so leading up to this, there were a couple interesting stories.
 And in fact afterwards, I want to end it that is stories in the news.
 And I want to I want to run through these quickly because they are full of really good
 quotes from from from Billy and other people in in E week.
 There was this basically was covered under the subject tool turns any JavaScript enabled
 browser into a malicious drone.
 Wow.
 A new tool too dangerous to give away can turn any PC windows, Mac, Linux, uh huh, yep into
 any device with a browse or that is to say or any device with a browser into a site attacker.
 The tool called Jicto.
 Now K Jicto J I K T O that's actually J stands for Java.
 There was an earlier tool a web vulnerability scanner called Nick toe of course, Nick toe
 Nick toe is a word a exactly from that.
 The earth stood still definitely have your geek hat on clock to burrata Nick toe.
 That's what you had to tell the robot to save the earth well because the bar the robots
 name was was Plato clock to right clot to and so you had to address clot to and then given
 this coded phrase.
 So so anyway, this is not Nick toe.
 This is Jicto J I K T O. It's a web application scanner that searches for cross site scripting
 vulnerabilities.
 Billy Hoffman, a security researcher with SPI dynamics demonstrated what the tool could
 do at the schmoo Khan hacker convention on March 24th, namely Jicto, which is written
 in JavaScript.
 Okay, JavaScript, you know how I feel about lovely JavaScript, how do you feel about web
 to only on I know that probable, but this can surreptitiously latch onto a browser and
 remember any browser windows Mac Linux that has JavaScript enabled after silently inserting
 itself to run inside any browser, be it that of a PC or even a cell phone, Jicto can then
 search sites for for for cross site scripting vulnerabilities and report its findings to
 a third party without the user of the infected browser being aware.
 So get this you you go to a site that it that is, you know, with JavaScript enabled, which
 we understand most people have to have to get the functionality of web to owe and you
 know, all the fancy stuff that's being done these days, or you receive email and you're
 using a web based email viewer as most people are by default.
 One way or another, this JavaScript runs it basically it commandeers your browser on the
 spot turning it into a scanning tool, which will which will then scan other websites for
 vulnerabilities and report what it finds to a third party.
 It said and so Hoffman says it can also replicate itself onto sites containing cross site scripting
 vulnerabilities, meaning that it has the capability of also being a worm, which can self propagate
 and then spread via latching on to other visiting browsers.
 This is something that JavaScript wasn't supposed to be able to do, but unfortunately Hoffman
 says it can and he demonstrated it.
 So so that was one that that that's part of one story.
 Then I wanted to do some more good quotes in a a guy named Joris Evers who reports for
 Cnet News wrote a story before and after and there was a bit of controversy stirred up
 by his first story, which was, you know, there were blogs about it because he either he either
 made a mistake or believed one way or the other that this that that Billy Hoffman was
 going to release the the JavaScript code for this at the conference.
 Maybe maybe they said so, maybe they changed their mind is not clear, but but but but Joris
 is first story says a security researcher has found a way hackers can make PCs of unsuspecting
 web servers do their dirty work without having to actually commandeer their systems.
 That's possible with a new security to called Jicto.
 The tool is written in JavaScript and can make PCs make PCs of unknowing web surfers hunt
 for flaws in other websites said Jicto creator Billy Hoffman, a researcher at web security
 firm SPI dynamics Hoffman who developed the tool as a way to advance web security plans
 to release Jicto publicly later this week at the schmoo con hacker of any Washington
 D.C.
 Quote, this is going to drastically change the scope of evil things you can do with JavaScript.
 End quote Hoffman said quote Jicto turns any PC into my little drone your PC will start
 attacking websites on my behalf and you're going to give me all of the results with the
 advent of online applications hackers have shown increased interest in breaching web
 security through vulnerability such as cross site scripting bugs and SQL injection flaws
 which have been around for years such even though these have been around for years such
 security problems are increasingly being reported and exploited Jicto is a web application
 vulnerability scanner it can silently crawl and audit public websites and then send the
 results to a third party Hoffman said Jicto can be embedded into an attackers website
 or injected into trusted sites by exploiting a common web security hole known as cross
 site scripting flaw vulnerability scanners by themselves aren't new hackers often use
 such tools to find holes that let them break into systems Jicto is like nikto a web application
 bugs scanning tool popular among hackers the difference is that nikto is a traditional
 PC application while Jicto runs in a web browser and distributes the bug hunting task across
 multiple PCs like setty at home for hackers exactly well exactly or you know like we're
 all familiar with the whole problem of bot fleets and distributed dos attacks now we've
 got distributed vulnerability scanning courtesy of of Jicto which is just written in JavaScript
 which was you know originally designed not to be able to do this kind of thing now he
 didn't release the code he just demonstrated it working so correct we don't know exactly
 what it's doing it may in fact be calling a nikto server somewhere in fact I suspect
 it probably is so you wouldn't write nikto in JavaScript you couldn't really make that
 something you could well the code has the code has leaked oh it has oh well well code
 out now we'll find out and the reason I mention that is because if it does do something like
 that and this is an example of why security this happens all the time that they demonstrate
 these flaws at security conferences but they don't give enough details to really know and
 for instance if this requires a nikto server somewhere it would you would be caught red
 handed at some point because it would be calling your server and you you know people would
 know who you are yes and again I'm I've not looked at the code as a sample of a potential
 flaw that you wouldn't know until you saw the code well and the other thing too is certainly
 if it's if it's going to be returning its results back to for example it's a good it's
 originator yeah then then certainly you're able you're able to look at the code and track
 that down to the problem of course is that these could be sites where you've got an unfriendly
 nation or an uncaring nation you know with whom we don't have a relationship you know
 I mean or if they could use the same sort of obscuration techniques that the IRC chat
 servers do for example it could log to an IRC chat channel and send its results into
 the IRC cloud where it just disappears because it's been it's being relayed autonomously from
 one IRC server to another and the biggest problem is that as is always the case with
 these things once someone knows it's possible it's not hard to recreate it that is to say
 just the fact that this has made the news that we know we're talking about it it's been
 blogging all over the place you know if you put Jicto into Google now it's you get just
 pages of this stuff so so now it's known that someone did this and once you know that someone
 did this it's just not difficult you just you know I mean everybody is smart out there
 who's who's involved in this and so it's just not difficult to recreate these kinds
 of results and you said you know it's leaked out so even if yes even if you weren't smart
 that's what I worry about I don't worry about the guys who are smart enough to figure it
 out I worry about the script kitties who aren't but we'll use this maliciously well
 yes and in fact it's interesting because there are there are papers that have been written
 by researchers as much as 10 years 10 years ago in fact I've got I've got one here that
 was put together by a bunch of Microsoft guys in early February of the year 2000 and I want
 I just want to read verbatim what they say about cross-site scripting they say under
 consequences of the attack and I'll put links to this whole paper and we'll be talking about
 this again and we're gonna get into the real detail the nitty gritty of what this is next
 week and the week after all the week and we may talk about SQL injection because it's
 related but not the same but Microsoft writes assuming that a particular web server is vulnerable
 to cross-site scripting attacks the attacker can run a script in the wrong security context
 this means that cookies can be read locked down plugins or native code can be instantiated
 and scripted with untrusted data user input can be intercepted any web browser supporting
 scripting is potentially vulnerable as is any web server that supports HTML forms and
 even HTTPS that is you know secure sockets connection a secure connection provides no
 immunity data gathered by the malicious script can be sent back to the attacker's website
 for example if the script it has used the DHTML object model it is dynamic HTML to extract
 data from a page and it can send it to the attacker by fetching a URL as long as the user
 navigates within a given domain with that is within the same domain a robust exploit script
 can follow the user this attack can be used against machines behind firewalls many corporate
 local area networks are configured so that client machines within their land trust servers
 on the land but do not trust servers on the outside internet however right right uh-huh
 so it's a way of breaching that truck those zones of trust it says however a server outside
 of firewall can fool a client inside the firewall into believing that a trusted server inside
 the firewall has asked it to execute a program to do this all the attacker needs as a web
 server inside the firewall like the corporate intranet server that doesn't check fields
 in forms for special characters only one page on one web server in a domain is required
 to compromise the entire domain and network this is true even if the vulnerable web server
 doesn't hold any important data because of course it can be used as a jumping-off point
 it can still be used as part of an attack on other machines within the same domain all
 web servers should guard against this attack even ones that don't perform critical tasks
 so okay in a nutshell and this is what we're going to expand upon next week the big problem
 is sort of a gotcha that the originators of html and web never thought about and that
 is what happens when for any reason at all users that is clients of a of a web server
 are able to provide anything that is going to be re displayed and that's that's the fundamental
 flaw in in the web architecture that is originally in day one of the web as we know web servers
 were serving static pages that is users would go and you know you just clicked on links
 and you looked at pages that that the webmaster and his people had created for people to download
 and view that is browsers were simply browsers they they looked at static pages that never
 changed every time you went back you saw the same page then of course little editions were
 made like web counters like you know how many visitors have been to this site or or how
 many visitors have you this page so there were we were seeing a little bit of dynamic
 content but of course the whole big explosion in the net came or in especially in the web
 came from making sites interactive you know any kind of a forum is an interactive site
 you know dig is an interactive site where you know anytime users are able to post content
 to the server which it will then serve to other users it radically changes the rules
 because what happens is you immediately get an interaction between the notion of trusted
 content coming from a server and the fact that you are displaying content from an untrusted
 source that is you know anybody can log on to an open forum and post their comment when
 they do that text that they've provided is then being stored by the server and is being
 re displayed to other people who visit the site well here's the problem the there is
 no separation between textual displayed content and executed scripting content that is because
 of the evolution of the web there was no there was no really clear and clean delineation
 between text that the web server sent your browser which you would see and text which
 it would execute in fact all you have to do is have a an open an open bracket you know
 less than sign the words script and then a closing bracket and then anything after that
 until the slow the closing script tag is treated as scriptable content then arguments to that
 script tag tell tell the browser what kind of scripting it is what language what version
 and so forth so that it's able basically to turn its scripting engine loose on whatever
 this text is in between these tags and there are turns out there are a bunch of different
 tags that will end up causing the interpretation of text as script which is to say you know
 to run scripting and that all you need to do is to all a an attacker needs to do is figure
 out some way to get a web server to serve this script when it thinks it's serving just
 non executable text and even after this problem was known it turns out that there are still
 very clever ways of finding holes in in the prevention of this for example you would imagine
 that you could simply tell your web server strip out any bracketed things that is anything
 with a bracket and a closed bracket well there are normally exceptions people want to be
 able to put italics in their postings or underline words in their postings or do you
 know I have some formatting controls and it turns out that that exceptions in the way
 text is parsed has still allowed holes to be found and that's for example what these
 so-called web vulnerability scanners are scanning for is there looking for any sorts
 of active content historically web servers even came with a bunch of default pages and
 default scripts which were vulnerable so you could just have for example there were
 some versions of Microsoft's IIS where they're when you installed the server it gave you
 a whole bunch of like starter pages which many of us you know like sample pages which
 many people left alone and they were vulnerable to cross site scripting so people would immediately
 be able to leverage them and in fact this is one of the ways you know you were always
 hearing about web sites being defaced you know sites being changed home pages change
 and so forth it has been these kinds of of cross site scripting which allows those kinds
 of defacements to happen that that's been the enabling technology well I guess we're
 going to have to rethink the enabling technology then I mean it's well of course scary it really
 is scary and I mean it's yes it's powerful that you can have inline scripting just mixed
 right in with your text but the fact that you can do that the fact that for example scripting
 isn't somehow sequestered completely separate from content but it in fact is just a form
 of content and it is I mean to say it's active or alive I mean that's almost an understatement
 it's it's hyperactive yeah and and it really does it really does create an opportunity for
 exploits so we're going to continue to cover this subject in the next a couple of episodes
 give you a more some more in-depth look at how cross site scripting works and so forth
 like what are we going to talk about next time next time will be some some exact examples
 of of all the very few things that a web server the little the few mistakes a web server needs
 to make in order to allow cross site scripting exploits I'm going to get very specific very
 specific with some examples and walk our listeners exactly through for example how how you could
 end up with another with an attacker capturing your cookies which is your log on credentials
 for a site like Amazon or eBay which would allow them to then assume your identity and
 take it from there and meanwhile you might want to download nikto and iKTO and run it
 against your sites and see if you've got any of these vulnerabilities I presume nikto
 does a good job of it I don't know of other programs that can do the same thing but that
 very interesting very interesting it makes you it makes you want to go out and get a
 Starro's security gateway right now and run it everywhere you can this spot show is part
 to you as I mentioned and I do mention every week by the good folks at a starro security
 they make the great a starro security gateway which is a security appliance that runs on
 open source software the newest version version seven is out now with the email encryption
 at the at the server side on the so you don't have to worry about on the client side at the
 at the device also secure remote access via SSL VPN which is fantastic and scalability
 via clustering stars developed a unique brand of active active clustering that enables a
 load distribution for as many as 10 gateways eliminating the need to install additional
 load balancers is very cool it's a patent pending technology which really increases the
 speed and reliability of network traffic so you know when you invest in a starro security
 gateway you you can you can grow it as your enterprise grows and don't forget by the way
 home user licenses are available for free for the v7 package including all subscriptions
 in a star of today that's a that's a great deal a starro find out more by visiting on
 the web at www dot a s t a r o dot com or if you're so inclined you can also find out more
 about a starro in fact even subsets uh... go to them and uh... and sign up for a free
 trial of the star a security gateway uh... in your enterprise uh... by going to eight seven
 seven for a starro when we check that to make sure that's right because i actually don't
 have it sitting in front of me i have this all memorized now
 as it sounds very familiar
 it sounds like the right number but let me let me just uh... let me just look it up
 in the meantime while you're doing that i'm going to correct
 my own irata from uh... the beginning of the show even as i said it i knew i was misspeaking
 and so for anyone who's already sent off email telling me that i could still got my
 the port still got my i still got my FTP ports backwards i mean i know so well that
 the server listens on port twenty one and i'm sure that i said it listens on port twenty
 which i know is not the case of you know f_t_p_ is the main is this is a control channel
 for f_t_p_ the server is on port twenty one and then and then it's port twenty that is
 the data the the reverse yes the reverse channel did data change i always i always said it was
 a random port i i must have misunderstood the spec when i was looking at it that they will
 it's random at the client end but because okay yeah yes yes so so it's whatever port the
 client is able to be assigned by the o_s_ remember that that service ports are only able
 to be opened that the ok service ports are those ports from from ten twenty four and lower
 those are only able to be opened for listening by privileged uh... processes in unix so so
 that clients are unable to listen for example on twenty one and twenty they're able to listen
 on high-numbered ports so the idea is that that the that the client makes the remote connection
 to the server on port twenty one and says i've just opened port whatever three two six five four
 um connect back to me and so the server connects from its port twenty up to the client's
 specified port number ok got it and fixed my own mistake there and the number for a star is
 i was right eight seven seven the number four a s t a r o or free trial in your home we thank
 them for their support well i think now we have a we this is the first time we ever uh had an
 irata correction in the actual show correcting an irata at the beginning of the show so that's
 impressive the turnaround is getting very quick on these irata uh... steve lots of fun we'll come
 back next week talk more about cross-site scripting and of course uh... your your questions should
 uh... continue to flow to g_r_c_ dot com he's got a form there i'm sure it's safe tested for cross-site
 scripting you yes because i'm because i'm not displaying anything that anyone posts although
 leo i have to tell i have to say i will confess that that g_r_c_ did have a cross-site scripting
 vulnerability uh... years ago back back when i i s microsoft's i_i_s_ was having so much trouble
 with um... with its own u_r_l_ parsing remember there were all kinds of exploits where you're able
 to to like to put funky um... Unicode characters in the u_r_l_ in order to get i_i_s_ to misbehave
 and i was unhappily using i_i_s_ and i didn't have any sort of filter so i wrote my own
 u_r_l_ pre-parsing filter to intercept any and all incoming u_r_l_s_ before they got to i_i_s_
 and what i did was i had a page that that would intercept and say oh i called it the uh... apf the
 advanced prophylactic filter because it was a prophylactic for i_i_s_ that that would you know
 basically protect i_i_s_ from any badness trying to get in um and what it did was it was it was a
 when when you got intercepted by this it showed you the u_r_l_ that was illegal
 oops because what that meant was that you that the user was providing a what was with providing
 something anything which could cause the server to re-display it even as an error message
 and so there was a scary that created a cross-site scripting vulnerability
 which someone pointed out to me and i quickly changed so it's like yeah i mean it's so easy to
 do it is i mean you have to be just ever vigilant i mean it's very much like although different of
 course from the buffer overrun problem where you know it just it requires so much vigilance
 and so the problem is with with all of our contemporary um sort of next-generation web
 two oh applications which are all about like you know wikipedia and dig and online forums and and
 communal blogging any situation where the server can has any reason to display what someone provides
 that creates real trouble due to the fact that text and script they are they they're able to
 co-habitate on a page right right right right right well go to g_r_c_ dot com look at that form find
 a whole find a flaw and let us know and meanwhile while you're there you can download 16 kilobyte
 versions of this podcast and Elaine's great transcription so you can read along on complicated
 subjects like this i think it's always helpful to read along as you're listening to steve you can
 refer back to it show the boss explain why you have to recode the entire site all of that all of that
 is at g_r_c_ dot com along with all of steve's free security software and the great spin right
 the world's finest this will have remained into time steve will wrap this up or we'll reconvene
 in the week what do you say yep we're going to need everybody to have their propeller caps on
 next week okay thanks steve see you then
