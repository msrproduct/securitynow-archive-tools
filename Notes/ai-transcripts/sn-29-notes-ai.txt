 [MUSIC PLAYING]
 This is "Security Now" with Steve Gibson, episode 29
 for Thursday, March 2, 2006, "Ethernet Insecurity."
 [MUSIC PLAYING]
 From his fortress of solitude, deep
 within Irvine Mountain.
 Are there mountains in Irvine?
 Yeah, actually, the Saddleback Mountain
 is like the big famous mountain range.
 Deep within Saddleback Mountain.
 Buried under 3,000 feet of granite.
 Steve Gibson, you don't have this--
 I just imagine you in this kind of basalt bat cave.
 I'm surrounded by screams.
 That's about it.
 I've got a monitor showing bandwidth.
 And it's funny, too, when you have too many screens,
 it's hard to find your cursor, because it's like, OK,
 where did this go?
 Which screen is the mouse cursor on?
 So the screens, you can move your mouse across the screens.
 And are you-- what are you using for that, synergy?
 No, I mean, I've got three screens
 on a single system.
 But then I also have other systems monitoring other things.
 Like, I'm keeping a track on the IP turnaround
 between you and me right now.
 We're about 30 milliseconds round trip time for our package
 so we can see what's going on, packet loss, and so forth.
 So I've got screens showing bandwidth monitoring
 over at level three.
 I can see how many people are connected
 and what the CPU utilization is.
 It sits bizarre.
 You're your personal lab experiment
 on the dangers of RF radiation and the human biology.
 Yes, fortunately, I don't think that'll be a problem, though.
 Hey, he's fit.
 He's healthy.
 He's doing great.
 It's harmless.
 But you have all LCB panels now by now, I'm sure so.
 Oh, a long time ago.
 Let me tell you, that really cut down on the air conditioning
 bill because, you know, those big huge--
 I used to like large CRTs.
 And boy did they generate heat.
 Yeah, and you were getting a bit of radiation in those days.
 Yeah, those things were bad, especially--
 they fired them out back, apparently.
 So it was behind the machine that was bad, not in the front.
 I had some cats for a while, and they
 loved to curl up on top of the CRT.
 It was like a heating pad.
 And then their hair fell out.
 And it is, you know, exactly.
 Just kidding.
 So do we want to--
 I don't think we need to, but let's--
 I mean, since you answered a lot of questions last week,
 but is there anything we need to loop back around for last week?
 I think we're all clear to start.
 Yeah, I mean, usually when you answer questions,
 you don't get more.
 Let's talk then about ethernet insecurity.
 In a way, this is part two of our conversation
 from episode 27, yes?
 Well, yeah, we have several episodes
 we talked about earlier about WAN technology,
 how the internet works, how it uses a hierarchical addressing
 space.
 And in fact, they did have somebody asking me a question
 that basically about, you know, why ethernet couldn't
 be used on a WAN?
 But if ethernet's addressing is so cool,
 because you just have unique addresses,
 why not just use it out on the whole internet?
 And then you wouldn't have a problem with, you know,
 spoofing and NAT and all this.
 You're talking about using Mac addresses instead of IP addresses?
 That's what he was talking about.
 That's an interesting idea.
 Well, because, you know, we know that Mac addresses are unique.
 As we know, a Mac address is a 48-bit number, which is 24 bits
 of, that is assigned uniquely to a manufacturer.
 And the other 24 bits is like the manufacturer's serial number
 so that none of its adapters ever had the same Mac address.
 And because a manufacturer has 24 bits of the total and then
 they have their own serial number within those 24 bits,
 the concatenation, which is a 48-bit binary number,
 is guaranteed to be unique in the world.
 And so he was thinking, hey, why not just use that?
 Well, the problem is we absolutely depend upon IP addressing
 being hierarchical.
 That is, when an IP address, for example,
 has 68 dots something, something, something,
 all the routers in the world know that anything
 beginning with a 68 needs to kind of go in that direction
 to go aim those packets toward that network.
 So it's just like the way our US postal system works,
 where you have a state, and then a town, and a street,
 and a number, where the first thing that happens
 is the mail gets sent to the right state.
 Then it gets sent to the right town,
 then it gets sent to the right street.
 Well, that's a hierarchical system.
 Mac addresses are just, you know, a NIC will have any random 48-bit
 number.
 So if you had that on a WAN, that is, on a global network,
 there'd be-- you'd have no way of knowing from the address
 any idea of where that particular network interface
 card was located.
 So specifically, it's the hierarchical nature of IP
 that makes the WAN work, whereas Ethernet LAN, because it
 has what's called a flat addressing space, that is,
 just a single 48-bit, you know it's on your LAN,
 but-- and you don't need to know where,
 because the whole LAN is one big network, one big sort
 of solid chunk of wire.
 And you just address a packet to this 48-bit address
 on the LAN, and all of the network cards hear it,
 and then only the one that has the matching address
 responds to it.
 So you couldn't do this because it'd be too inefficient
 to do it globally?
 Yeah, I mean, to do it, every single router
 would have to have the complete address list
 of every single Ethernet adapter in the world.
 And the fact is--
 That's not going to make sense at all.
 No, it just couldn't work.
 I mean, scale well, yeah.
 Exactly, exactly.
 So, you know, and his point was, hey, you know, 48 bits
 is bigger than 32 bits, Ethernet addresses being 48.
 They've got, like, a whole lot more addresses,
 whereas, you know, the IP space on the internet being 32
 is obviously a lot less.
 So wouldn't that give us more?
 And so the point is, I mean, it's a really cool concept,
 because, you know, like, yes, from that standpoint,
 that's certainly true.
 But it is exactly the fact that the internet addressing
 is hierarchical, that is that the higher bytes,
 the first bytes in the address, give you location.
 I mean, that simple fact is the only reason
 the internet works is that--
 We better not change it, then.
 Oh, no.
 Is that that way routers only-- you know,
 it's like 68 dot star dot star dot star.
 That is anything beginning with that byte
 they send in this direction.
 And so since there are only 256 first bytes,
 you know, possible values for the first byte, 0 through 255.
 And actually, a chunk of those are not even routable.
 They're like, for example, we know that anything starting
 with 10 is a private address.
 So a router sees-- if it receives something with a 10 dot,
 it just throws it away.
 There's nowhere for it to go.
 And so the beauty of the hierarchical addressing
 is that it tells you where to send it.
 Whereas a MAC address is just a 48-bit number that
 has to be unique on the LAN.
 But nothing about it tells you where to send it.
 The power of hierarchy.
 Yeah, it's really a cool concept.
 So it's like--
 It's zip codes.
 You don't do individuals-- we talked about this
 a little bit before, but you don't do individual zip codes
 for every locale.
 You have a hierarchy.
 9 means west coast and 0 means east coast and so forth.
 Well, a good example of sort of a zip code-ish thing.
 Imagine that paper mail was addressed
 based on your social security number, which
 is assigned when you get a social security number
 to each person who has one.
 But the number doesn't tell you anything
 about where they live itself.
 It's just-- it's a serial number.
 So if you tried to deliver mail based on a serial number,
 you'd have to look them every single one up.
 That wouldn't work.
 And so it just wouldn't work.
 OK, so what's very cool about the ethernet is--
 or about the ethernet or ethernet technology
 is probably the proper way to say it.
 First of all, it was designed 33 years ago back in 1972
 by Robert Metcalf, Bob Metcalf when he was--
 I don't remember where he was.
 Is this our fry or BBN?
 Oh, wait.
 Yo, he was at Park at the Palo Alto.
 He was at Xerox Park.
 And they were experimenting with locally networking computers.
 And so these are-- the computers cost $100,000 back then.
 And they were all hand-wired and built with chips and things.
 I mean, these were real expensive machines.
 So the concept he had when it was brilliant back at the time
 was to just put all the computers that they
 wanted to talk to each other on a single link that
 is on a single wire, essentially.
 And you remember that the original ethernet used coax.
 It had the RG, whatever it was, 57 or 70.
 I don't remember now what the number of the coax was.
 But it was that big--
 It looked like the same kind of--
 Exactly, the same thing that people's cable modems
 are connected to, that kind of coax.
 Because he needed what's called transmission line behavior
 where you'd have a single run of coax,
 and you would terminate it resistively at each end.
 And then all the computers that wanted to be on this LAN
 would basically have like a T adapter.
 They would just have an electrical T connection.
 They would run up to their card, and you would hook
 all these machines together.
 And I remember how fragile that was.
 I learned how fragile that was, because once I disconnected
 my computer, and I broke the whole ring,
 and everybody went down by disconnecting
 the wrong part of the cable.
 You want to keep it together.
 Yes, exactly.
 And you break that, and you end up with two segments
 that were unable to talk to each other.
 Now, there were some other local area technologies,
 and IBM had one called token ring,
 where you literally passed sort of a virtual token, which
 was your talking permission, around and around this ring.
 And so the machine that had the token
 was the one that was able to send data out.
 Bob came up with a different approach, which was substantially
 simpler, and as often happens, the simpler ones end up winning,
 although it does have some failure modes.
 It's Bob's talk comes a razor.
 Exactly.
 And Bob's approach-- and I've mentioned--
 actually, I mangled this acronym the first time
 I talked about it months ago--
 was Collision Sense Multiple Access with Collision Detection,
 CSMA/CD.
 The idea is that on the LAN, all the computers
 are connected to the same wire.
 So they listen for a time when nobody is sending data.
 They're not receiving any data from anybody else
 who's on this single wire.
 So when the wire is quiet, they will
 put a packet onto the wire that is bound for some other machine
 on the LAN.
 There is a chance, though, that two computers that we're both
 listening for silence will, when silence occurs,
 both put their packets on at the same time.
 So you could have a collision of these packets.
 What happens is that the voltages that result from two
 cards talking at the same time is easily sensed.
 So they're able to each determine that, whoops, I stomped
 on somebody else's transmission.
 So they back off and wait for a random amount of time
 and then retransmit the same packet.
 Well, since they're waiting for a random amount of time,
 the chance that they're going to collide a second time
 is relatively low.
 So basically, all the NICs, the network interface cards
 on the LAN are listening all the time
 and waiting for a time to talk.
 So it turns out that that approach
 is simple enough to work really, really well.
 And that's what all of our LAN technology today uses.
 All of this-- nobody in their homes
 has IBM's token ring or any other LAN technology
 that's filled by the wayside.
 Everybody's using ethernet because it ended up
 just working well enough.
 Now, what's interesting is it does have a failure mode
 when the overall level of traffic on the LAN
 starts to increase, as you might imagine,
 since there isn't any formal permission
 giving for people to speak on this common shared wire.
 Then what happens is the percentage of collision,
 the probability of collisions occurring,
 starts to go up as the amount of traffic on the LAN
 segment goes up.
 And so what happens is due to collisions
 being fatal for the data, the LAN adapters
 will back off a random amount of time and try again.
 Well, there might be another collision for their retry,
 if not among them, among other cards.
 So if you look at a curve of collision rate versus bandwidth
 for ethernet, it does, as the segment gets busier,
 you have a higher rate of collisions
 and your overall throughput starts to drop.
 And of course, once people are having collisions
 and retransmitting, that in turn causes more collisions
 and thus more retransmission.
 So it sort of fails badly.
 It doesn't survive well when it really gets busy.
 But that's never really been a problem
 because most ethernets are not that heavily loaded.
 And in fact, the solution, if you do have an overly loaded
 ethernet, is to use a switch.
 Now, what I've been talking about, for example,
 is in the original ethernet topology
 was a single coaxial wire that all of the nicks clamped onto.
 We went from that so-called 10-base-2 technology ethernet
 to 10-base-T, which is now what virtually everyone is using,
 T as in twisted pair.
 So we changed from literally a physical coaxial cable
 that would loop around the building.
 We switched to the ethernet wires that everyone
 is now familiar with, where you click them into a hub.
 The first technology we had was a hub technology.
 And the idea was that anything that the hub received,
 it would send out on all of its outputs.
 So basically, the way 10-base-T works,
 instead of having literally a single copper wire
 surrounded by a shield, which is what the coaxial cable is,
 with 10-base-T, you've got a pair of wires for transmitting
 and a pair of wires for receiving.
 So-called twisted pair, thus the T. So an ethernet connection
 is a four-wire connection, even though our plugs have eight wires.
 Those RJ45 jacks are eight connector plugs.
 If you look closely and count them, you can see eight.
 Only four of them are used, two of them for receiving
 and two of them for transmitting.
 So when we are using a hub, everything that everyone sends
 into the hub over their transmission wires,
 the hub simply rebroadcasts brainlessly.
 It doesn't do anything about it all.
 It's just basically all of the incoming wires are received,
 and everything is ordered together and then sent back out.
 Well, naturally, you could still have collisions,
 because, again, two cards could be transmitting at the same time.
 They would collide in the hub.
 The hub would send out this garbled nothing message,
 and they would both go, oops, because they're listening
 to everything that the hub is sending.
 They would realize their message had not gotten through,
 and they'd do the same back off and rescind.
 So switching to the original 10-base-T technology
 did not help with this ethernet saturation and collision
 problem.
 However, what then happened was we changed to switches
 instead of hubs.
 A switch is actually an intelligent device,
 which is the reason they're more expensive than hubs,
 traditionally.
 And we're beginning to see hubs going away
 as the price of switches are coming down
 just because of manufacturing efficiencies.
 A switch actually learns the MAC addresses
 that are on each one of its segments, whereas the original
 older coax and a hub had like a single segment that
 is every NIC in the LAN could directly hear every other one.
 In a switch, it actually segments the LAN
 into individual pieces represented by its ports.
 And so you could have multiple computers on a switch's port
 because the switch actually has a table of RAM.
 And if you look at the specifications for a switch,
 it'll say something like up to 4096 MAC addresses.
 It's able to memorize, meaning that in there
 is a 4K table of MAC addresses.
 And it learns which adapter is on which one of its ports.
 What happened before K?
 Are you saying that each MAC addresses-- it's more than a byte,
 isn't it?
 Well, 4K would be 12 bits.
 But the idea would be that you could
 have 4,000 computers on the switch.
 And obviously, a switch that's got eight ports,
 normally only has eight computers, so they got a lot.
 But you can chain switches together.
 So you could have a switch that's got eight ports going
 to eight switches that each have eight ports going
 to eight switches that each have eight ports.
 So that switch up at the top, it would
 have to know the MAC address of all the computers
 in the hierarchy of switches down below it.
 But this is the point.
 It does.
 So now, when a computer is transmitting,
 its data goes to the switch, the switch
 actually reads the MAC address that it's addressing its packet
 to and retransmits it only out of the one port
 that it knows has that MAC address.
 So it does a huge job of dealing
 with the potential problem of ethernet congestion, which
 really is the one Achilles heel of the ethernet
 from a fundamental technology standpoint.
 We're going to be talking about a much worse problem
 with ethernet, but it's not about the fundamental data
 carrying ability.
 So essentially, that's what switches do,
 is they chop this one LAN into multiple electrical pieces.
 And they actually learn which MAC addresses
 are living down which of their ports
 and only send the data to the proper location.
 Now, one variation on that, or a further detail on that,
 is what's known as the broadcast address.
 Most LAN adapters will only respond to their own MAC address
 or to the broadcast address.
 Now, if you've ever looked at the underside of your router
 or maybe on the printer on the back of some computers,
 you'll see the MAC address.
 It's always expressed as six pairs or six sets of hex paired
 digits.
 For example, 0, 0 colon, 0, 2 colon, 0, 5
 would be the starting of the MAC address,
 would be the manufacturer serial number assigned to it
 and to add us to that manufacturer.
 And then the next three sets, which could be anything,
 would be the serial number of the adapter
 from that manufacturer.
 So you see it's like six pairs of hex digits
 separated by colons.
 That's the MAC address.
 So an ethernet NIC will respond to its own address
 or to the broadcast address, which by universal agreement
 is all ones or in that MAC address addressing.
 It's FF colon, FF colon, FF and so on, six sets of FFs.
 The idea is that that's the way systems
 are able to find each other on the ethernet.
 If through some technology or by reason of some technology,
 it's necessary for one computer to locate another.
 It's able to do a broadcast on the ethernet.
 And all machines that receive that
 will take a look at the data.
 That also means that a switch, which
 is normally providing some isolation,
 must rebroadcast out every one of its ports,
 anything that it receives that is addressed
 to that broadcast address.
 So one time that the switch looks like a hub
 is if it receives something, an ethernet packet
 addressed to the broadcast address,
 it just sends it everywhere.
 OK, so let's talk now about how the internet's IP technology
 that we've been talking about, the hierarchical addressing,
 how does that work within an ethernet
 land and what problems does that create?
 The biggest problem with ethernet,
 and it's certainly not the fault of its designers
 33 years ago, because again, they
 did this as an experiment at the Palo Alto Research Center
 run by Xerox just to sort of see if they could.
 And this is the technology that is so often the case.
 The one that worked, we just kept using, never really
 intending it for prime time.
 There is no notion of authentication.
 Essentially, there is absolutely no security with ethernet.
 The assumption always was that it
 would be used in a land setting where
 you knew and trusted everybody on the network.
 You were one big happy company or you
 were your little network at home or whatever.
 But the idea was that in a land, it's local.
 It's inherently local.
 The problem is that as new applications for our technologies
 have occurred, this ethernet land, which
 is fundamentally insecure, has been
 used without really giving this any thought in non-secure
 and semi-public settings.
 For example, when you visit a hotel and you plug your traveling
 laptop into the hotel's ethernet connector, which
 hotels increasingly offer, you're on the hotel's land.
 And any trouble, any security problems
 that ethernet has are now hotel-wide
 and you are subjected to them.
 Similarly, in a hotspot, when you're using a wireless--
 we've talked about Wi-Fi extensively--
 well, Wi-Fi is running on top of ethernet,
 meaning that it's vulnerable to the underlying insecurity
 of ethernet when you're in any sort of a Wi-Fi setting.
 And of course, the same is true even in a corporate land.
 Somebody who wanted to do something
 malicious in a corporate land, which
 is certainly going to be connected by ethernet today,
 they have a tremendous amount of latitude
 for being able to cause mischief by bringing a computer
 into the network and just clicking it
 into the company network, because ethernet has no security.
 Now, what I mean is that there is no authentication,
 meaning that there's the adapter's are addressed just based
 on this 48-bit MAC address.
 OK, well, we know that everyone today is using IP addressing.
 We're on our own local networks.
 We might have 192.168, that's something that's something
 or 10. or whatever.
 Even out on the internet itself, routers
 are interconnected very often using ethernet links
 from one router to the next.
 That's just the way ethernet has turned out to work so well
 and be so inexpensive when you integrate the circuits
 and all the technology that it's just sort of the universal glue
 for all of our computers.
 Well, OK, the way ethernet works is
 that packets have to be ethernet packets
 in order to travel across the ethernet, which
 means that the IP data, the IP packets that are coming into a LAN,
 have to be encapsulated.
 They're basically wrapped in an ethernet packet
 that contains the MAC address of the originating adapter
 and the destination adapter.
 Inside that is the IP data that shows the source
 IP and the destination IP, but the ethernet LAN
 doesn't use that at all.
 It is all based on MAC addresses.
 So what has to happen is that there's
 this relationship and association between MAC addresses
 and IP addresses so that, for example, any computer on a LAN,
 a contemporary ethernet LAN, will have its IP address
 that it's been assigned by a DHCP server
 or manually configured.
 And inherently, it'll have a MAC address.
 So there's basically two addresses.
 There's the more global hierarchical internet IP.
 And also, what we talked about, this non-hierarchical
 just sort of 48-bit fixed MAC address that
 is how data gets to it on the LAN.
 What this means is that the computers on the LAN,
 in order to send IP data to each other, which is really
 what they want to do, they need to have a table that
 says this IP is assigned to the computer with this MAC address.
 And this IP, another IP, is assigned to such and such
 computers.
 So there's basically an association table
 that maps the IPs to the MAC addresses.
 What happens when a packet comes in from the gateway,
 say that it's coming in off the internet,
 and it's addressed to a certain IP, the gateway, the router,
 or whatever it is that is the way the LAN connects
 to any other networks, it'll look at this destination IP
 and look to see if it knows what this--
 which MAC address is associated with that IP.
 If it does already know, because it
 sent some data to it in the past,
 it simply wraps that IP packet in an ethernet packet
 and sticks it on the LAN, addressed to its destination,
 that machine will hear it and accept the packet,
 take the ethernet wrapping off, and there's the IP packet
 that it has been sent.
 If, however, the gateway doesn't know
 the address that doesn't have the MAC address associated
 with that IP address, it needs to ask the entire network,
 who has this IP?
 Well, that's where this thing called
 address resolution protocol, ARP comes in.
 ARP protocol is the way MAC addresses and IP addresses
 are associated and essentially glued together in a LAN.
 The router sends what's called an ARP request,
 and it sends it to the LAN's broadcast address,
 that FFFFF, basically all ones that
 has been reserved for this purpose.
 So it basically says, hey, who out here on the LAN
 has this IP?
 Somewhere, because it's broadcast,
 every machine on the LAN will receive that query.
 We'll hear it.
 The one machine that is assigned to that IP
 will respond to that.
 And since the broadcast was sent to liken to everybody,
 but it was sent from a specific MAC address,
 that is from the router, the ARP reply
 is just sent right back to the router.
 It just said the card who does have that IP sends back,
 hey, I've got your IP.
 So what happens is that's the way on a LAN,
 the gateway is able to learn the IP address
 or addresses, because it's possible for one computer
 to have multiple IPs of every machine on the LAN.
 It's a very cool and slick technology,
 but it's got one real problem.
 And that is, there is absolutely no way
 to know if this ARP traffic is valid,
 or if perhaps it's been spoofed.
 So imagine just to reiterate how this works when it's
 working right, is that the gateway will send an ARP
 request, broadcast it to every machine,
 asking who has this IP?
 Well, similarly, when any one of the machines on the network
 wants to send a packet outside of the LAN,
 or even to another machine on the LAN,
 individual machines will also generate these ARP requests,
 saying who has this IP, the machine that does responds.
 The way the ethernet works is when
 receiving an ARP reply, the receiving machine
 simply fills out this table entry,
 and what's called the ARP table, not surprisingly,
 and puts the information in.
 It turns out that a malicious person anywhere on the LAN
 could send any other computer an ARP reply,
 and the computer would believe it was real and change
 the entry in its ARP table, basically
 updating the entry with this new information.
 So there's no attempt to validate the sender at all?
 Well, there's no way to validate.
 I mean, it's literally-- there's just like no way.
 There's nothing you could ask.
 Yeah, exactly, there's no--
 this was never considered, never thought about,
 back in the original design of the net.
 So did they make the assumption that no one who has direct access
 to your LAN would be malicious, or what?
 There was no assumption.
 They didn't even think about it.
 It wasn't even on the radar.
 We see that a lot with security issues,
 where just nobody even thought about it,
 because nobody had done it, or there
 were no exploits to that point.
 Exactly, exactly.
 So let me make this clear, because this is really important.
 If a malicious person sent a computer on the net,
 an ARP reply saying, I am the IP of the gateway,
 that would replace that entry for the LAN's gateway IP
 with the MAC address of the intruder,
 from that moment on, any traffic which that computer wanted
 to send out to the internet would be addressed
 to the MAC address of the intruder.
 So you've effectively stolen the connection?
 Yes, you have stolen all the traffic
 that is bound for the gateway, similarly.
 Well, go ahead, I just thought--
 OK, a problem, because if you're stealing it,
 it's not going to get to the gateway.
 Well, exactly.
 So part two is, this same intruder then turns around
 and sends one ARP reply to the gateway,
 pretending to be the IP of the other computer
 that it's intercepting that will replace the table entry
 in the gateway.
 So anything from the gateway bound for that other computer's
 IP will instead be sent to the MAC address,
 that is to say, to the computer that
 wants to intercept this.
 In order to keep the connection alive,
 the interceptor has to forward any traffic it receives
 onto the original MAC address.
 So it's basically, it spliced itself
 in what we know is called a man in the middle attack.
 Makes sense.
 It's impersonating both ends, one to the other,
 and taking all the traffic.
 Well, and I mean, get this.
 It's as simple as sending one packet
 to each of the computers whose traffic you want to intercept.
 So I'm guessing there are lots of automated tools
 that will do this.
 Yes, for example, there is a tool called Kain and Abel.
 And is it now at version--
 Our old friend.
 Kain and Abel, it's at now at version 2.81.
 And if I read from one of their boasting features,
 they say the latest version is faster.
 And oh, well, good.
 So you can intercept traffic even faster than before.
 And contains a lot of new features like APR.
 That's their own acronym.
 And they say that stands for ARP poison routing.
 And they go on to say, which enables sniffing on switched
 lands and man in the middle attacks.
 The sniffer in this version can also
 analyze encrypted protocols such as SSH1 and HTTPS
 and contains filters to capture credentials
 from a wide range of authentication mechanisms.
 Wow.
 And then--
 Oh, I know.
 And it's freely available on the net.
 Oh, yeah.
 Kain and Abel--
 Everybody has it.
 I have a copy.
 Everybody has a copy of this.
 OK, and I mean, actually, it's a beautifully written piece
 of software.
 And it's very useful for a lot of things.
 Yes, well, also on version 2.8, we've
 talked a lot about Windows Remote Desktop Protocol,
 terminal services, RDP.
 They say in their features list for 2.8,
 RDP V4 session sniffer for APR.
 And it says, Kain can now perform
 man in the middle attacks against the heavily encrypted
 Windows Remote Desktop Protocol RDP.
 The one used to connect the terminal server service
 or a remote Windows computer.
 The entire session, to and from the client and server,
 is decrypted and saved to a text file.
 Client side keystrokes are also
 decoded to provide some kind of password interception.
 The attack can be completely invisible
 because of the use of ARP, poison routing,
 and other protocol weaknesses.
 This is a side light, and I'm not
 going to go too far down this rabbit hole.
 But I just want to point out, people will say, well,
 how could this program be legal?
 How is there any legitimate reason why you would want to own it?
 Why don't they shut it down?
 Well, a lot of security experts use this program.
 Right?
 Well, for testing.
 Well, in fact, it does many things other than this.
 Well, it does with web cracking.
 And I mean, it does all the bad stuff,
 but it does-- it's a very useful program.
 And just because somebody has it,
 doesn't mean that they're a bad guy.
 Right.
 There's another free tool called EaterCap.
 And from quoting their homepage, EaterCap
 is a sweet for man in the middle attacks on land.
 It features sniffing of live connections, content filtering
 on the fly, and many other interesting tricks.
 It supports active and passive dissection
 of many protocols, even ciphered ones.
 And includes many features for network and host analysis.
 And then they have screenshots showing it doing all of this.
 Now, you can't fault these guys.
 I mean, this is a well-known haul.
 This art poisoning.
 And it's easy to do.
 And so, of course, somebody's going to write a tool for this.
 Well, and so this is the lesson is that we see over and over
 and over that which is possible will happen.
 Now, so once again, I just want to just--
 because I want to make sure people get this.
 Anybody on a land, any malicious software
 can send two packets, one to each other computer,
 lying about its MAC address to each of them,
 and receive-- basically, receive all the traffic
 they intended to send to each other.
 It receives.
 If it then forwards it on, it has spliced itself
 into the connection, and nobody will know.
 This can happen at a wireless hotspot.
 I mean, one bad person in a hotel
 could arrange without much work to literally intercept
 all the traffic going to and from the hotel's gateway
 so that all of the email conversations, all
 of the traffic of any sort that is being transacted
 by every other hotel guest, they're
 able to monitor and intercept.
 And in some cases, where you have weekly authenticator
 protocols, like Windows Remote Desktop
 that really doesn't provide any kind of authentication,
 man in the middle and complete decryption attacks
 are easily performed.
 I mean, it is really bad.
 And trivial to do.
 And if I wanted to just check into a hotel
 and put all my system on the ethernet
 and just start running these programs, it'd be--
 it's easy, it'd take you minutes.
 Well now, about half of the hotels out there
 are still using hubs.
 As we know, all the traffic a hub receives,
 it sends back out to everyone else.
 So if you're on a hub, you don't have to do anything active.
 There's no active attack you need.
 You just plug your computer in and start sniffing.
 Now, remember I mentioned that a NIC
 will respond to something addressed to its own MAC
 address or to the broadcast address.
 That's almost always true.
 However, NICs can also be put into something
 called promiscuous mode.
 All that means is you just switch the adapter
 into promiscuous mode, and that says, just receive everything.
 And so that's what these sniffers do.
 Any sniffing tool simply puts the MAC, the NIC,
 into promiscuous mode.
 And everything on the wire comes in and gets
 logged and decoded and checked out.
 There was someone we quoted a few months ago
 when we were talking about this briefly that said that she
 was a security expert out of curiosity--
 oh, and she also traveled a lot.
 Out of curiosity, she plugged her laptop into hotels
 wherever she goes, turns on some of this, quote,
 security software, unquote.
 And in the typical evening, she's able to receive several hundred
 email logons and passwords.
 She knows what they're logging onto, who they are,
 and what their password is.
 She's probably got mine.
 I mean, it's just-- it's wide open.
 That's why I use VPN now because of you and learning this.
 Yes, well, if a VPN is the only way to solve this problem,
 because then, because a good, a properly implemented VPN
 will completely defeat not only passive sniffing,
 but also any man in the middle attack.
 Because the problem is-- and we're
 going to be talking about this, I think, next week,
 where we're going to finally start talking about what
 is all of this encryption, how does encryption work,
 and what is authentication, and signatures,
 and signature authority, or certificate authorities,
 and all that, certificates, and signing, and all that.
 We're going to lay all that foundation.
 But anytime you don't have authentication,
 anytime that somebody can come along
 and pretend to be anyone else participating
 in the conversation, you've got trouble.
 And Windows Remote Desktop Protocol
 doesn't have strong authentication.
 They've got some, obviously, not very well working,
 because there's free software that
 is able to just crack the conversation
 and log all your keystrokes.
 So Windows doesn't provide substantially and significantly
 strong authentication, so that the entire dialogue can
 be monitored, unfortunately.
 But a VPN that is designed right does.
 There's no man in the middle attack for VPNs for SSH or--
 Well, what's interesting is that users can be exploited
 in this, and we'll be talking about security certificates
 and verifying security certificates when we're talking
 about state-of-the-art encryption,
 because what can happen is that once a connection is being
 filtered with a man in the middle,
 if you go, for example, to PayPal and you try to establish
 a secure connection, there is no way for a man in the middle
 to truly spoof the PayPal certificate.
 But they can-- that is, there is no way for them
 to not raise an alert on your browser.
 But many users will incorrectly respond
 to a fraudulent certificate, not recognizing
 that it is such, and give it permission to connect.
 And then when that happens, you're in deep trouble.
 As long as they can continue to simulate the PayPal experience,
 I guess once you've entered the password and log,
 and they don't need to anymore.
 They could still go connection.
 Thanks very much.
 See you later.
 So it is really necessary not to give your browser permission
 to connect when you shouldn't do so.
 Now, I have a question for you, an ethical issue.
 We've talked about cane enable and eater cap.
 Should I put a link to cane enable and eater cap
 in the show notes, or not?
 I have them all over my page, Leo.
 I think there is no reason not to anybody.
 I mean--
 Can you use Google?
 You can find it.
 Of course, you just put in ARP spoofing.
 If you can't use Google, then forget it.
 You'll never be a hacker.
 You put in ARP spoofing, or ARP poisoning, or ARP cache,
 and all of this stuff comes rolling out.
 I have a really great page, which is our show notes page
 for this episode.
 I put it together, actually, in early December,
 and I've been waiting till now to really talk about it.
 It's grc.com/net/arp.hpm.
 So slash nat/arp.hpm.
 And we've got a link to it on our page.
 You should link to it too, Leo.
 I basically, I explain all this.
 I have some nice diagrams that show how this works.
 And because the reason I put these links to these tools
 on the page is it's important for people to recognize,
 we're not making this up.
 I was reading just from the boasting
 that these tools offer.
 And so I think it's important for people
 to recognize how very prevalent this issue is,
 and why, connecting in a hotel or in a hotspot,
 there's just no security due to the fact
 that ethernet was designed back in an era where it wasn't even
 on the radar.
 No one even thought about it.
 And it works great, but there are some issues,
 and now you know what they are.
 You know how to handle it, because we've
 talked about VPNs in great detail.
 Yes, and in fact, I'm at work on the VPN notes.
 I just don't know what I'm going to have done.
 I'm doing a really thorough job.
 And I'm working with a neat German guy
 who's making some changes to some ethernet bridging,
 some free ethernet bridging technology
 that's going to make the configuration of open VPN
 even easier, and so we're doing a little software development
 here in the process.
 Very cool.
 Well, all of this information is, as Steve said,
 in his show notes, and I'll have a link on our show.
 It's at twit.tv to that and everything you need to know.
 Congratulations, by the way, Steve.
 We just got stats back from America Online,
 and we crossed kind of an important threshold.
 A hundred thousand listener.
 Yep, I saw that.
 Yep, that's very cool.
 Very exciting, secured enough.
 25 in three weeks had a hundred thousand listeners.
 Generally, the way it works is we get about 60,
 65,000 in the first week, and it goes half and half again.
 So it takes us about three weeks to get a hundred thousand.
 But what's interesting, particularly about security now,
 is even the first episodes are still
 being downloaded in the thousands every week.
 So the number of climbs-- and I imagine each of these episodes
 will be in the long run, listen to several hundred thousand
 people, because they're valuable.
 They form together, as a whole, a complete course
 in internet security.
 Right.
 grc.com/securitynow.html, that's the place to go where Steve
 has everything you'd want to know.
 Links to these individual show notes,
 but also transcripts, thanks to Elaine.
 16 kilobit versions for the bandwidth impaired,
 and lots more, of course, security help.
 He's been doing this for years, helping people protect
 their systems with shields up, and shoot the messenger,
 and de-comb-bobulator, and unplug and pray,
 and so many other great utilities.
 And of course, the king of all utilities,
 the ultimate disk maintenance and recovery tool,
 I tell everybody to get it, spin right, all at grc.com.
 Are we going to have a birthday cake or something
 for a hundred thousand?
 I think we have to do something to celebrate.
 It's great.
 It just is really good.
 Yeah, it's just been fantastic.
 And I'm not surprised.
 This is something everybody wants to know,
 and needs to know.
 And I sometimes know it's a lot of work,
 but that's when the transcripts come in handy.
 Well, and not to break your flow here,
 but there will be people who will write and say, oh, my god.
 So yes, it's possible for our cash poisoning to happen,
 and man in the middle attacks, but how likely is it?
 And again, who knows?
 I just want people to understand what the reality
 of their connections are, what the reality
 of the security is, and let them decide
 what kind of measures they want to take.
 Well, I think it's so easy to do.
 And there are a lot of tourists who would do this
 just for fun, like the woman you quoted.
 But it's so easy to do.
 I think it's only prudent, especially when
 you're using a hotel or a Wi-Fi, a public Wi-Fi
 connection, it's just only prudent.
 I'm not plugging my laptop into a hotel
 without some protection.
 And I've started using HotSpot VPN all the time.
 And it just makes me feel better.
 And I think it's just the prudent thing to do,
 just the right thing to do.
 I want to thank the great folks at AOL Radio, who always are,
 are so generous, and we really appreciate it now
 that we've crashed others' servers.
 We really know what we're getting from AOL Radio.
 They broadcast us on their podcast channel,
 and of course, provide us with a bandwidth
 so we can bring this to you, aolmusic.com/podcasting
 for more information about that, or to subscribe to.
 I think really the best internet radio out there.
 Steve, we'll come back next week.
 We'll talk about authentication.
 Very cool.
 That'll be fun.
 Have a wonderful week.
 Talk to you then.
 OK, for Steve Gibson, I'm Leo Goport.
 Thanks for joining us on Security Now.
 [MUSIC PLAYING]
 [MUSIC PLAYING]
