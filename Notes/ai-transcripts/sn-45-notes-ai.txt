 Bandwidth for Security Now is provided by AOL Radio at AOL.com/podcasting.
 This is Security Now with Steve Gibson, Episode 45 for June 22, 2006, The Host's File.
 Security Now is brought to you by a Staro, makers of the Staro Security Gateway on the
 web at www.astaro.com.
 Now I'm feeling guilty. I pressed Steve into service a day early. I'm taking a little
 much needed break this week off at the beach house.
 It's funny because you said you were on vacation. I said vacation from what?
 Like I don't do nothing. Oh yeah, you work in Stiffs don't understand. I have a complicated
 life. I guess those of us who don't have a boss are sort of, you know, we're actually
 we're never on vacation because say, do you ever take vacations?
 No, I don't. You just don't even need a vacation.
 I'm just bored. I love what I'm doing. And you know, if ever I go somewhere, it's like
 I'm just spending all my time thinking, hmm, did you think all the things I could be getting
 done if I was still home?
 Here's a man who loves his work. Doesn't he consider it work?
 I really do. Yeah. Well, when you came up to Canada, that was kind of a two day vacation.
 I can't get him on a geek cruise, folks. I've tried and tried and he says, I'm not going
 on any boat.
 Actually, I really liked those, the two day, the two day Canada turns because I had a whole
 day going, you know, across the country to the other side of the world to read and to
 do research and things that normally I just don't give myself the opportunity to. So there's
 like little forced breaks.
 See, see, it's good. Actually, it's one of the things I like to go to Canada. I pretend
 that it's the other side of the world. And I tell people, oh, I won't be able to do anything
 for the whole next week because I'm going to be out of the country. Of course, it's not
 really out of the country. Exactly. It's pretty easy to reach me in Canada. But I pretend,
 oh, oh, now my secret's out. I'm going to have to get a job in Alaska. I'm going to
 get a job in Timbuktu. So today we're going to talk about something that people, everybody
 has everybody's got one. Many people don't know they have one. It's free. It's free. It's
 can be very can be very effective. It'd be a very useful tool in fighting bad guys. We're
 talking about the hosts file. Yeah. What is the hosts file?
 Well, it's interesting. It's it's been around from the Dawn TCP. As far as I know, the hosts
 file as it's called H O S T S is present in any system which is connecting to the internet
 that has a TCP IP stack, that is, you know, the standard internet protocol glue that we
 all use for for hooking things up. UNIX uses at Linux, uses at Windows, uses at Mac, uses
 at OS two, used it. I mean, it's pretty universal. Yeah. And essentially what what it is, it's
 sort of like a first DNS lookup, which which any TCP equipped system will will reference.
 And here's the key before it goes and uses the the official DNS system to map a domain
 name to an IP address. Interesting. So when you type in www.grc.com, normally, I mean,
 we normally think of it as going out to the DNS server of your internet host or maybe
 of the main domain servers and saying, well, where is grc.com? But you're saying it checks
 this host file before it even does that. Well, a few things happen when you you enter a domain
 name into your browser. Systems are now maintaining a local cache of these names. So for example,
 if so, so, well, so, so that it, it knows it just recently looked up one way or another.
 It looked up the address for a domain name and it doesn't have to go and make another
 query because it would be crazy to be to have your computer constantly asking your ISPs
 or whatever DNS server you had configured, what the IP address was for a domain name.
 So, so certainly it makes sense to to cache those locally. That is keep a record of them.
 In fact, these are timed so that the system knows how long it's been since it last updated
 its own local cache so that it so that it can if the if the IP address were to change,
 it would know that, hey, I've had this for three days. I ought to make sure that, you
 know, this is still the still same IP address, but actually they've been problems with the,
 I remember the XP cache because it didn't handle it properly didn't flush it properly
 and if it but so it does the cache persist across a reboot or no, it won't persist across
 a reboot. There have been problems. In fact, one of the annoyances is called negative caching
 and and what that means is that if your computer asks a remote server for the IP address of
 a domain name or a remote machine and the for whatever reason the request fails the the
 system will will it's called negative cache. It'll say there is no IP for this domain.
 So it essentially remembers a negative and that's a problem because you might have a
 momentary glitch somewhere or something something on the internet might have failed that would
 cause you to get a false negative domain name and then your system won't go out and try
 it again. It thinks it knows better. There actually is a command that you're able to
 execute from the command line to flush your local DNS cache and in some cases doing that
 restores connectivity, but it's it's nuts that that's that's what you have to do.
 I thought they'd fix that but I so it wasn't a bug it was actually or was it so it's a
 feature. It's a feature. It's not a bug it's a feature. So anyway, the idea is that you
 know there's a lot of plumbing going on in just in DNS on our own systems. The the really
 interesting thing is that prior to any of this remote access, the a simple text file
 is checked that exists on all of our systems. I mean, even if it's even there by default
 it's installed when you install windows, most people never who are not who are not into
 all this kind of stuff never go any further never pursue it never even know about it,
 but it's there. It's under your windows directory that might be you know, when NT or windows
 depending on what whatever your system calls it, then all of our systems have us in windows
 have a subdirectory called system 32. Under that directory, strangely enough, it's under
 a subdirectory called drivers and then et cetera. Yeah, that is to say, ETC. Right. So it's even
 an in an obscure location. Any location is actually where Unix and Linux stores it in
 slash ETC. Right. And in fact, it makes sense. I mean, it's sort of like, you know, extra
 little stuff to go along with TCP or with or rather with the IP protocol. So what this
 is this text file and anyone listening to this who doesn't know about this who's curious
 can can look at their own hosts file under their system 32 slash drivers slash ETC if
 they're in windows or windows is going to warn you. Well, you shouldn't be looking in
 here. What are you looking in here for? Don't be going in there and all other stuff. But
 yeah, just so you know, that's that's what's going on. It's okay. All it is is it's a simple
 table that that is very much like DNS. It matches IP addresses to domain names. So for
 example, a very commonly used name is local host local host by sort of IP gods is is is
 is used to refer to your own machine that also has an IP address of one two seven dot
 zero dot zero dot one. We've never talked about this before. And we're probably ought
 to spend some time at some point talking about some of that, you know, the these things related
 to the to the local host and then the local network. But but 127, the IP address 127 dot
 zero dot zero dot one is in all IP stacks, a self reference. You're you're it's another
 way of talking to you about your own local IP. So the hosts file will have an entry there
 that that just says 127 dot zero dot zero dot one is the same as local host. So if you
 use the word local host, just like a domain name, it that that relationship between local
 host and 127 zero zero one comes from the hosts file. And and as the way this was used
 initially was within a land with that is within a local network. This is a nice way of associating
 machine names and their IPs. For example, I use it myself. Actually, I did in the past.
 Now I have full blown DNS locally, but but I used to have all of my machines named and
 then and then they had fixed IP addresses. So I had a hosts file which I installed in all
 of these machines and by installed, I mean, just you know, copied one host file to all
 of them. And that allowed me to refer to the machines for like, for example, for file sharing
 and things, not needing to use IP addresses, not even needing to use windows browser technology,
 which can be sort of flaky and and has some version dependencies. But it would use the
 hosts file. Basically, I was providing my machines with with names and allowing them
 to determine what the IP addresses were for each of the machines in my network. So it's
 a cool thing. Now, so so you you don't need to mess with this. It's handled kind of automatically.
 In fact, by default, it only has one line, which isn't the local host, but you decided
 to use it. Well, I decided to use it and it works great for for that purpose. Do you recommend
 people do that? Well, I mean, I wouldn't recommend someone who's not into networking and stuff
 to do it. But but doing it really does work. And in fact, if someone gets into it more,
 it turns out that there's a way you can put an entry in a hosts file to refer to another
 host file sort of an include facility where you say include a file from somewhere else
 in my host file. What that allows you to do is actually have a single master hosts file
 that all the machines in your network will will automatically pull theirs from. So I didn't
 so I didn't want to get too complicated here. But but in fact, I had one copy of a hosts
 file on my network, all the machines knew where to get theirs from. That is, in their
 host file, I had a reference to this sort of an included file. And so as I added or
 move machines around, I made one change. And what was convenient was it is a really robust
 solution for for for machines. Now again, the problem is most people are using DHCP behind
 their own NAT routers. So the IP addresses of their machines may be floating around. That's
 one thing I'm not doing in my network, I don't use DHCP. All of my machines are known IPs.
 So this is only really applicable in a case like that. But but the reason we're really
 talking about this is from a security and a privacy standpoint, because very clever people
 have figured out how the hosts file can be used to prevent machines from accessing domains
 you don't want them to. And I mean, having said that, a lot of people who are listening
 to this are not going, Oh, I know how to do that. I mean, essentially you you edit your
 host file to, for example, I'm just looking at mine right now. And for example, I've got
 an entry that says 127 dot 0 dot 0 dot 1, and then that's your local mission, my local
 host. And then tab and it says fast click dot net or mediaplex.com. These are the exactly
 these are the people we would rather not have our computer contact. We would for whatever
 reason, we don't want cookies, we don't want ads, we don't want, we don't want our computer
 for any reason to go touch double click dot net or link exchange dot com or value click
 dot com. I mean, I've got a whole list of these. And and the beauty of this is it is
 solid and robust. And my machine, anytime I go to a site that has references to those
 domains, the browser is going to say, Oh, what's the IP? So it can go get an ad or get whatever
 it, you know, who knows a web bug or a or spyware or anything that it might be pulling
 from those domains. The first thing the computer does is look up in the hosts file to see if
 that domain has been defined. If so, that's the address it uses. In other words, 127 0 0
 1, meaning itself. So that request goes nowhere. It's immediately canceled. And the browser
 goes about trying to do, you know, load the rest of its web page. So it's a it's a very
 clever, simple and very efficient means for preventing your machine from ever going elsewhere
 to or to mean to to an expanding or evolving or growing list of like bad or banned domains.
 Now just as you've used it to block bad guys, bad guys also use it. There's spyware that
 modifies the host file. Yes, of course, we could accept, we could expect that anything
 valuable like this that could be used for good would also be grabbed and used for bad.
 There are you're able to, there are ways you can protect your host file from modification.
 For example, you could write protect it or remove right privileges from the from the file
 so that a only the administrator of your system which you should not normally be running under
 would be able to modify the host file. Then if some spyware got into your system that
 was not running as as an administrator, it would not be able to change the file. Sometimes
 just clicking the right protection flag is enough to defeat these things. We should say
 though that what has evolved is sort of an interesting it's not really a subculture but it's a bunch
 of people who manage public host files. That is there are lists of host files on the net that you
 can download that are being maintained by people and contain a huge directory of places you probably
 don't want your computer to go. That's where I got my list from some time ago and those domain
 names don't tend to be changing very often. So if anyone was curious about this approach,
 they could just put hosts file into Google. I think you mentioned that Wikipedia has a great
 discussion about the host file. And if you use spy bot search and destroy or I'm sure other
 spyware programs, it also will do that. In fact, there's a command in spy bot that just says
 populate my host file and it will add a whole changed host file that blocks all of those well-known
 sites, really hundreds of names. And I think it then locks it down as well. It would make sense
 that it would because again, there have been exploits that modify the host file. On the other
 hand, remember that once something bad gets into your system, you're pretty much hosed anyway.
 You can never really know what was done to your machine. So it's certainly the case that
 something nasty getting into your system could modify your host file. On the other hand, it could
 modify anything that it wanted to if it's able to modify your host file. The power of the host
 file is not so much that it's an absolutely perfect solution, but that it's because none
 exist in the Windows environment. Or in fact, in any but an ultra secure system, which is sort
 of becomes no fun to use, depending on how tight the security is, the beauty of it is that it is
 an extremely reliable, very efficient means to prevent a computer from going places you don't
 want it to. And it's simple to manage and maintain. Its format is just IP address and then a tab
 character or a space or something. Mine's all lined up nicely because I have 127.001 tab and then
 the domain name. So it's very easy to add and remove items. And it just simply prevents your
 system from asking the internet for the actual IP address of any domains that are listed there.
 So you can just neuter these things. And I mean, it's a tremendous little tip. One little word of
 warning, if you are running a web server on your local system, as I do sometimes for test purposes,
 mapping the local host will have an unpredictable result because your web server may attempt to
 fill that request. So in that case, you might want to use 0.0.0.0. Or I understand you can just use
 zero. And it'll still have the same effective. Yeah, just exactly nowhere. It just stops the search.
 It nips it in the bud saying there's no reason I want anybody, you know, I ever want this system
 going to double click. And it just it can't get there because it's given a bogus IP address.
 I think Windows Defender also will monitor your host files. That's the new Microsoft spyware or
 anti spyware program. And I'm just looking at the Wikipedia article and they mentioned that.
 That was how my doom worked to block your access to Symantec and other antivirus sites. You may
 remember, if you got that bad virus, you couldn't then do any research on how to get rid of it because
 you couldn't get any antivirus sites. And that's exactly how it did it. It just modified the host's
 file. It just puts a bunch of entries in there for for the anti spyware and antiviral vendors and
 prevents your computer from going there too. And in fact, you know, it's probably worth having people
 take a look at the host file just to make sure that it still looks benign. Absolutely. That would
 be a sign of tampering, wouldn't it? Yeah. All right. Well, there it is. Everything you ever wanted to
 know about host files. And if you want to know more, the we'll put a link to the Wikipedia article
 in our show notes. But you might also check there because there are additional links in there to a
 lot of other good resources, including, you know, somebody who says, you know, it's a myth that the
 changing your host file will protect you from malware. Obviously it won't. It'll help, you know,
 it'll help reduce your impact of malware. Yes. And again, I want to make that point because I
 think it's a good one. It's that it's that it's that it can predict the hosts file being set up to
 block a whole bunch of malicious domains can prevent you from getting that malware in the first place.
 So it's an and a non compromise system. I mean, there are there are a lot of places that are not
 they're they're not malware. They're just, you know, they're they're heavy duty marketing internet
 marketing companies that are using cookies and technologies to track you around the net that
 you'd rather not have any contact with. They're just, you know, sort of gray zones. They're not
 black. They're just gray. So the host file just prevents your machine from from touching those.
 And again, it it it can be abused, but you know, so can everything. Right. This is it's a process.
 And there's no one silver bullet in security. I wish there was I mean, it's sort of like it's
 sort of like the argument we touched on. We were talking about open ports about, you know, there
 are people who say that that stealthing your system doesn't provide you any security. It's like,
 well, okay, I mean, I've heard the argument a lot. It's better to be invisible. I think why not be
 it's it doesn't cost anything to be invisible. And you just don't fool yourself that you've done
 everything you can do at that point. Well, it you or that you've that everything that you've done
 is going to make you absolutely invincible because you know, that we can't achieve. I'll
 also mention that my own security now page, I'm going to put a whole bunch of hosts file references
 on that page of stuff that I use and that I have found over time. So anybody who's interested in
 pursuing this independently can not only check Wikipedia and the link you're going to have Leo,
 but but the it's been a long time since actually since I've put together some notes for a show,
 because most of what we've been doing hasn't involved off show resources. But but here in the
 case of the host file, I think we really have there. There's just so much that it's been done.
 It's a tremendous resource. And once you understand it, I mean, I think this is something people
 don't even know they have. So once you know you've got it, this is worth kind of learning more about
 and we'll put all that in the show notes. Of course, show notes are at grc.com slash security. Now,
 that's where you'll also find a transcript of this in every show. Thanks to Elaine, our wonderful
 transcriptionist and 16 kilobit versions for the bandwidth impaired. You know, I you started
 something, Steve, because I've started doing 16 kilobit versions of a tweet as well. And my
 radio shows, because people like if you're on dial up, people like to be able to download it
 and still listen, even though I'm really glad to hear that, Leo. I mean, I know how popular they
 are. They are. You know, oh, they're incredibly popular. I mean, I think maybe it's easy to be
 a bit of a bandwidth snob and to say, Oh, well, yeah, you don't have cable. You don't have DSL.
 But there's a lot of people still using a modem. You bet. And I'm not so much a bandwidth snob as
 an audio snob. I listen to those 16 kilobit versions and they I go, Oh, gosh. Oh, I know. But you get
 the content and that's the and that's the most important thing. So we do put those up. We also
 thank our great friends at Astaro for providing the support, the sponsorship for this podcast.
 We mentioned a couple of weeks ago, the Astaro command center V1. It's out now free for users of
 Astaro's great security gateway. If you're a network administrator, you should see this thing.
 It is a great way to manage and control multiple gateways from just one dashboard and a beautiful
 world map. And it just looks great. It's free in the products section at Astaro.com.
 And of course, Astaro is a great solution for any smaller medium business network that needs
 superior protection from spam from viruses from hackers, as well as complete VPN capabilities
 intrusion protection, content filtering, and an industrial strength firewall in an easy to use
 high performance appliance, contact them at one eight, seven, seven, the number four,
 AST, ARO or again, AST, ARO.com. And don't forget that there is a solution for home users too.
 That's absolutely free. Let's see what else. I guess that's it. I guess security now.
 And now Oh, Oh, I forgot the most important thing.
 Spin right, ladies and gentlemen. Yeah, Steve never takes a vacation. That's because
 his his his product is always being improved. Spin right is free is not free, but it's available
 from grc.com. It is S P I N R I T E. And you can read more about all the testimonials on spin
 right at spin right dot info S P I N R I T E dot I N F O. I think anybody who has a hard drive.
 That means everybody should have a copy of spin right the ultimate disc recovery and maintenance
 utility from spin right dot info. Have I mentioned everybody? I think so.
 I think it's the time has come. I hate to say it to say goodbye, but we'll see you next week.
 Thank you, Steve. Absolutely. And in the meantime, people can check out their hosts file. There's
 it just such a neat little perfect solution for keeping your machine where you don't want it to go.
 Yes. Yes, you're a good host. Take care, Steve. We'll see you next Thursday.
 Right on security now security.
