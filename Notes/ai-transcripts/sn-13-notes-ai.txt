 This is "Security Now" with Steve Gibson.
 Lucky episode 13, "Wireless Encryption Part 2."
 Steve Gibson is back, the hero of the hour.
 Did you get a lot of calls about the Sony rootkit?
 Yeah.
 I mean, this was a big story.
 We covered it last week.
 If you missed it, do listen to episode 12.
 This is the Copy Protection Scheme.
 Sony's putting on some of its Sony and BMG music,
 or putting on some of their audio CDs.
 That is a hacker toolkit.
 Well, in fact, CasperC Labs reports today in their virus news
 that there is now a new back-door Trojan program using
 that is leveraging the Sony DRM rootkit to hide itself in user systems.
 If it gets into the system, they're calling it B-R-E-P-L-I-BOT.B.
 I don't know why, but it's about a 10k byte size file
 that renames itself dollar-signsys-dollar-sign-d-r-v-dot-e-x-e.
 And as we know from last week's episode,
 if you have the Sony Copy Protection on your system,
 any file name, dollar-signsys-dollar-sign, will be rooted.
 It'll be invisible to every tool.
 Right.
 Any file beginning with the dollar-signsys-dollar-sign string
 just disappears.
 So we already see, I mean, and we predicted last week
 that this was going to happen, never having seen one.
 You know, that this was a serious potential danger
 for what Sony had done, because rather than only protecting
 specifically its own files, the authors of this,
 that were not Sony, they used a subcontractor,
 the authors arranged to cause anything beginning
 with the string dollar-signsys-dollar-sign to disappear,
 including registry keys and any kind of files
 that are stuck in the file system.
 That's just so sloppy.
 I can't believe they leave that hole on there.
 Now, how does this Trojan spread?
 It looks like it spreads by spam email messages.
 So opening an attachment.
 So don't download files.
 It opens a back door on the user system.
 Don't download files from unknown sites.
 Open attachments.
 Be very careful.
 Now, here's a question for you.
 A number of people asked me this.
 There are some anti-spyware programs
 that claim to detect the Sony rootkit.
 Kaspersky must be able to.
 If it's a rootkit, how can they do that?
 Well, for example, the Sony rootkit is easily detected.
 You could simply rename a file to dollar-signsys-dollar-sign.
 If it disappears, you know you've got the rootkit on your system.
 You don't even need to use rootkit revealer as we were talking
 about now several times in order to do a scan of your whole system.
 Somebody shortly after we put out the podcast mentioned that and said
 he's created a file on his desktop called dollar-signsys-dollar-sign-canary
 like the canary the old miners used to take down.
 But if it ever disappears, you've got trouble.
 So it's easy to detect.
 Is it easy to remove?
 That's the problem.
 Now, we were part of the initial uproar at this time last week.
 In fact, you know, we did our podcast a day early
 because we wanted to make sure this message got out as quickly as possible.
 Sony has responded to the pressure.
 They're doing some butt-covering PR spin saying that there's really nothing wrong with it.
 But we'll put something on our site that people can use to remove the hiding behavior.
 The DRM technology stays there, but the hiding behavior at least will be shut down.
 Now, the other revelation since last week
 is that a market system turnals has confirmed a report that he heard.
 And I have not yet myself.
 I've ordered one of these CDs that I'm going to be infecting myself with here in a couple days
 because I want some first-hand experience with this myself.
 But the Sony technology is also phoning home.
 It uses the user's internet connection on the fly
 when they're listening to any of the discs that they've purchased using this built-in player.
 It sends a message back to Sony saying that this particular song or album is being played.
 Apparently this is for some sort of like banner rotation technology that it has to present something to the user.
 But the problem is this is classic spyware phoning home behavior.
 It is not disclosed by Sony.
 And in fact, Sony specifically says that's not being done.
 Yet it's been found in packet capture traces.
 And Sony's saying, "Well, but if we're doing it, then we're not keeping any of the information."
 We're not doing it, but if we were to do it, we wouldn't keep.
 How can you trust a company that does that?
 That's terrible.
 It's so bad.
 All right.
 So this isn't the primary topic of our show today, but we did want to kind of update you all on that.
 And so what should we do?
 I still am kind of baffled about all that.
 Well, I think it's a function of how concerned individual users are.
 Our goal here with these podcasts is not to tell people what they have to do ever, but to say,
 "Look, here's the truth about what's going on.
 You decide for yourself how concerned you are."
 As long as somebody knows that this content-enhanced Sony CD technology is installing technology on their system,
 which does allow known Trojans to hide themselves.
 Well, okay.
 If that's what they want, I have no problem with that as long as they know.
 Right.
 So, you know, we do know that you can go to Sony, you can submit your email address to them to get a link for a remover,
 which will remove this from your system.
 So you've got to go through some tools.
 You can't get it any other way.
 You can't just remove.
 You can't just go to the XPC Aurora and download it.
 I guess I think you can do that too.
 And get this removed from your system.
 Then, if you ever make the mistake of installing one of these Sony audio CDs into your computer,
 as you said last week, Leo, hold down the Shift key.
 Or, if you're a more security-concerned user, you might have already disabled the CD auto-run feature in your system,
 which otherwise causes this thing to present you with a EULA.
 If you ever see the end-user license agreement because you forgot to hold down the CD,
 decline the installation and play the CD normally or hold down shift when you put it in to prevent this thing from being reinstalled.
 Right.
 Okay. It's too bad.
 There are lawsuits, class action lawsuits.
 I suppose some aggressive district attorney in some state or country might actually go after them first.
 I think there is some governmental action I heard in Ireland somewhere,
 and there's an ambulance chasing, class action, happy law firm in San Francisco
 that's filed against EULA, Packard and Toshiba and everybody you can imagine.
 And they're, you know, rolling up their sleeves to go after Sony now.
 Okay. So, you know, I have to say, I'm actually pretty disappointed with Sony's response to this.
 They have minimized consistently. They've lied, obviously.
 Well, it sounds like they've lied anyway about the phoning home issue.
 And they're really not taking responsibility in a way that I would hope they would.
 Well, it's certainly been a good object lesson for other people who will hopefully not follow these footsteps.
 And, you know, I don't think we've seen the end of this.
 I'm going to take a look at the CD myself.
 I may have one suggestion next week in next week's podcast,
 which you and I will be doing from Toronto again.
 That's right.
 Otherwise, I think this issue is behind us.
 All right.
 Anybody who's interested, by the way, can just put Sony Space Root Kit into Google and stand back.
 You'll find plenty about it.
 Well, yeah. And it was kind of timely because we had just talked about root kits.
 So I'm glad we talked about them because then lo and behold, it became an issue.
 But we had also started a conversation about protecting yourself on a wireless network.
 And that's a very important conversation day in, day out as well.
 So let's get back to that.
 When last we spoke, we pretty much debunked the notion that MAC address filtering had any impact on security.
 SSID hiding useless, web encryption, encryption broken and next to useless.
 It sounds like the best way to do this is WPA.
 In fact, the only real way to secure a wireless network is with WPA.
 Just to clarify the issue of SSID and MAC filtering because I got a lot of mail from people after I said,
 you know, it was not useful for security complaining about my position on that.
 So, what I wanted- Wait a minute, wait, how could they complain about your position on it?
 What you were talking about is factual.
 Well, yeah. Did they dispute that at all?
 Well, I guess maybe the problem is what I mean by security.
 MAC address filtering and SSID hiding and also changing the SSID from the default,
 which typically is Lynxis or D-Link or Netgear or whatever.
 Those are useful for preventing inadvertent use of your access point by a neighbor
 who just has, you know, not implemented any security themselves.
 Many people were the feeling like, hey, you know, encrypting my home network is a pain
 because I have more of a pain than MAC address filtering?
 No, that doesn't make any sense.
 At MAC address filtering you get the MAC address of each device you have to enter in.
 You enter in the password once in WPA encryption and that's it.
 Well, but for example, if, you know, what I'm citing from people is they've got friends
 who come over with a wireless laptop who want to use their access point.
 Yeah.
 So, I guess, you know, somebody who's into this is able to add their MAC address of their
 wireless NIC on their laptop to their permissions list on their access point.
 They know how to do that flexibly and so forth.
 They don't have to modify their friends laptop at all.
 Just give your friend the password and he can log in.
 I know.
 It doesn't.
 It's not logical.
 These people are not being logical.
 You either know what I want to clarify.
 What I want to clarify is that the use of MAC address filtering is not secure nor is SSID
 hiding or changing your SSID from the default because both of those are easily
 obtainable just by sniffing the air.
 However, they are useful to prevent inadvertent use by a neighbor of your access point.
 I have an analogy for this, Steve.
 Okay.
 Let's say you don't want to lock your door because you want your kids to come in and
 out of your house freely.
 So, you don't lock your door.
 You have no security.
 But just to kind of discourage burglars, you put a big sign up front that says you have
 an alarm system.
 Now, in fact, you don't have an alarm system and the door isn't locked.
 But you've put a sign up that says you do.
 That's that kind of security.
 I think it's not particularly logical.
 If you ask me, give your kids a key and lock the door.
 Well, again, it's not secure.
 It's prevent--
 It's pretending to be secure.
 Well, maybe we need another word.
 I mean, it's very weak authentication is what it is.
 And authentication is different from security.
 It's not authentication of your wireless devices that cannot be broken, which is to say even
 that can be breached.
 But it's weak authentication, which is better than none if you want to prevent your neighbors
 from inadvertently using your system.
 But it should never be confused with security.
 And that's what we're going to talk about with WPA.
 So let's say how to protect your system for real, not by putting a sign up that says it's
 secure, really, but we're actually securing it.
 How do you do that?
 As we talked about, when we talked about how badly broken the whole WEPWP original legacy
 encryption for Wi-Fi was, I was talking about all the different ways that it could be compromised
 to the point where there are now competing hacker tools that run on Linux platforms that
 allow people to sniff your traffic, induce your access point to spill keys at a much faster
 rate than it normally would that allows them to be analyzed in order to crack your key.
 So WEP encryption, again, it's better than no encryption at all.
 It does provide a much better barrier than leaving your system wide open or even protected
 by MAC address filtering or SSID hiding, but it can be cracked.
 The reason I make this point is that WPA, even the weakest form of WPA encryption if it's
 unproperly, is absolutely uncrackable as long as no one gets your key.
 The WEPP is so badly broken that when they thought, oh, okay, let's really fix Wi-Fi
 security seriously this time.
 They got heavy duty security experts involved and they created a next generation encryption
 technology called WPA.
 It has a number of different ways it can work and unfortunately it's an acronym soup that
 gets very confusing very quickly, but specifically WPA, sort of all an end user needs to really
 appreciate is that if you use a really good pass phrase, and we've talked about passwords
 before, a really good pass phrase, you are virtually uncrackable.
 Now, there's TKIP, which is a temporal key integrity protocol, which basically changes
 the keys often enough that existing encryption, that is, the RC4 encryption that was in the
 early Wi-Fi can now be used safely.
 There is more industrial strength WPA, also called 802.11i, also called WPA2.
 And sometimes I've seen as enterprise WPA as well.
 Exactly.
 That's the same thing.
 That's why this is also confusing.
 WPA2 uses AES encryption, which is the new NIST encryption standard.
 So it doesn't use the RC4 encryption.
 Some people think, "Oh, well, that's better."
 The fact is, RC4 encryption is an extremely strong cipher.
 Absolutely strong enough, as long as it's used correctly, and WPA technology uses it correctly.
 The reason we're still using RC4 is that there's a very good chance that older technology
 systems can be upgraded, with if older routers can be upgraded to WPA security, even though
 they've got older hardware.
 The problem with AES encryption, which is this next stronger level, is that it's much
 more hardware and processor intensive.
 And so only newer hardware that was designed with this technology from scratch will probably
 be able to run it.
 So give me a shopping list in order from least secure to most secure.
 And I presume you would choose the most secure you had as an option, right?
 Well, maybe, but from all the feedback we've received from users, people are very sensitive
 to any sort of inconvenience.
 Well, we know that inconvenience and security are always fighting each other.
 I have to say, though, my experience with WPA is it's much less inconvenient than web was.
 Well, it's a simple pass phrase.
 You enter it once in most implementations.
 You don't have to enter it again.
 Well, that's true, except get a load of this.
 It turns out that passphrases are much less secure than they seem.
 Typical passphrases are, you know, per character of a passphrase due to the fact that case is not
 changing randomly, that is, upper case and lower case, that passphrases are normally
 not highly mixed with letters, special symbols, and alphabetic.
 And there's generally a lack of randomness in a passphrase.
 The typical strength of a passphrase is 2.5 bits of security per character.
 Compared to a random strength.
 So we're used to thinking in terms of a character as being of 8 bits worth of strength.
 So less than a third is strong.
 Right.
 So, for example, if you had a 20 character passphrase, it turns out that's only good for 50 bits.
 Again, because there's some organization, the best password or passphrase is totally random.
 Well, exactly.
 So what this means is that there is an attack which WPA any, well, which pre-shared key
 WPA can be subjected to, and you're right, we have to talk a little bit about what this means.
 The easiest to use most practical and workable encryption is called PSK.
 Sorry, PSK, pre-shared key WPA.
 And that's what you've been talking about, Leo, where you simply make up a really good passphrase once.
 You assign that to your access point, to any wireless equipment you have in your home, and you're done.
 It's very easy.
 Now, the enterprise stuff.
 I'm worried it's not secure.
 Right.
 The enterprise stuff adds another level.
 It uses a technology typically known as radius technology, where there's another server somewhere
 that authenticates the user and dynamically creates keys for them so that each user has a separate key sort of assigned on the fly.
 One consequence of normal pre-shared key WPA, this PSK WPA, is that all devices in your environment will be using that single pre-shared key.
 So they're able to cross decrypt each other's traffic if they wanted to.
 Meaning that in a corporate environment, if you had a bad employee and the whole corporation access point was using the same pre-shared key,
 employees would be able to spy on each other's traffic.
 Now, in a residential environment, we know that's not going to be a problem.
 So this is where you have to kind of be aware of what your needs are and choose appropriately.
 So in a business, you should probably not use PSK, but in a home environment, PSK would be acceptable.
 Well, in a business environment, you're going to probably be spending more money or have a bigger budget, or in a serious corporate environment,
 you've got a whole IT staff that are going to be doing this.
 But also in a corporate environment, you still have the advantage of you entering it once and your system remembers the past phrase, right?
 I mean, you don't have to re-enter it every time you log onto the base station, do you?
 Oh, absolutely. In a corporate environment with a radius-based server and dynamic key assignment, the user is authenticated
 each time against this main central server, and then keys are dynamically assigned to the access point and the user on the fly.
 So it's not burdensome in any way.
 Give us, if you can, before we go much farther, I'd just like to understand all the flavors, all the players involved,
 and then if you would, can you talk about the pros and cons of each?
 Yes. Okay. So with WPA, we have either a static pre-shared key or in corporate environments keys which are being assigned by a centralized server
 where the users authenticate themselves with their own password and credentials, then the server creates the keys used for their connection.
 No users at home or even in a small office environment are going to see that or be involved with it,
 but I wanted just to say that it exists and it's there and it's super high-grade security.
 And the purpose of that is to keep people from snooping on each other within the network.
 Correct. Also, if you had an ex-employee who left and had the knowledge of what that pre-shared key, a single global pre-shared key was,
 that would create a vulnerability also. So in a corporate environment, this WPA, using a central server for like key distribution,
 solves cross-user snooping and the problem of keys not expiring from people being fired or leaving the company and so forth.
 Got it. Okay. That makes sense. So in a home environment, everyone is going to be using a single pre-shared key which is completely safe.
 As long as the passphrase that generates the key is safe and that's how we'll wrap up our dialogue here in a few minutes.
 But first, I'll say that so we have the issue of a single key or dynamically signed keys.
 Everybody in the home is going to be using a single pre-shared key.
 Then another aspect of WPA is which encryption technology is being used. Older hardware, which is not as strong,
 will tend to be using the RC4 encryption, which has been made safe by changing its keys all the time using something called TKIP,
 the Temporal Key Integrity Protocol. TKIP makes RC4 safe where it wasn't safe before in WEP legacy style encryption.
 Alternatively, newer hardware that is stronger might be capable of using a different cryptography technology called AES.
 So, for example, my new Belkin router does offer me AES encryption.
 So if the XP client that I was using also supported AES, I might choose to use it.
 It is more processor intensive. Technically, it will be putting more of a load on my computer.
 I haven't chosen to use it because TKIP is absolutely safe enough. It is a more efficient technology and protocol.
 And if someone came over with a slower laptop who I wanted to briefly allow to join my network,
 TKIP is for sure what they're going to be able to use within this WPA umbrella.
 Okay. So that really wraps up the choices.
 And I guess the key is you've got to kind of know what your security needs are and you can choose.
 But for most home users, any form of WPA would be good enough, yes?
 Yes, and exactly. So the lowest common denominator will be WPA with a pre-shared key using TKIP technology encryption,
 which drives RC4.
 Like I said, it's an acronym. Take notes, kids.
 Okay, so the last thing that is important, and this is critical, is passphrase quality.
 The reason it's critical is WPA is subject to what's called an offline attack,
 meaning that someone could sniff your traffic and only needs a little bit of traffic to sniff.
 They don't need a lot. They then take that home to a big computer and run an offline cracking utility,
 which basically it does a brute force or dictionary attack against your passphrase.
 So because it's possible to do this to put as much time or energy as necessary,
 since you're bothering to do WPA anyway, it absolutely makes sense to choose a good passphrase.
 And what that means is somehow come up with just a jumble of arbitrary special characters.
 You're able to, WPA passphrases, you can use anything printable.
 You know, asterisk, dollar signs, you can look like a comic book swearing person.
 Upper, lower case, numbers, you name it.
 And use the full length. A passphrase can be 63 characters, and that's what I'm saying.
 This is not somewhere where you want to type in a sentence that you like to use.
 That can get cracked offline.
 You want just a nightmare jumble of junk.
 And then you just use copy and pasting in order to paste the same thing into each of your machines at access point.
 And when a friend does come over, you paste this jumble in, they can't memorize it.
 So, you know, before they leave, you delete that from their wireless adapter and it's safe just by obscurity.
 No way that anyone is going to, either you, even you, are going to be able to memorize the 63 character hodgepodge of just static.
 Now, let me ask another question.
 And this is, I think, really where the criticism comes from on what we were talking about last time with MAC address filtering and so forth.
 People say, "How real is this threat anyway?
 Aren't we kind of spreading a lot of fear unnecessarily?
 How many people are getting hacked?"
 I don't know how to respond to that because, again, our goal is just to explain the technology.
 So, it's important for people to know that WPA is subject to offline cracking so that if they were in a situation where they thought they were secure using a few English words strung together as their passphrase,
 maybe it's useful for them to know how that can be broken and that it really can be broken.
 That, you know, if I were in their facility and I wanted access to their system, I could get it, even though they've used WPA.
 And then you can decide, folks, whether you really want to worry about this or not.
 I mean, that's, I guess that makes sense.
 Yeah, I think that's any of the information. That's our position. I know from the people who write to us, Leo, that there are people who do think we're going overboard.
 I mean, you can imagine, I got a lot of mail when we were talking about listening to keyboard clicking noises.
 Well, we know that that's silly, but it's possible.
 We just want to let you know. I mean, we thought that was a case of, well, I think it's interesting.
 I don't think we ever implied that somebody was going to do that to you.
 I'm not worried about that. On the other hand, I do have an extremely strong WPA passphrase that I can't remember.
 It's in a file on my computer, and when I need to set up a new device, I copy and paste it into the device.
 There's no way I could even type it again, but it's absolutely never going to get cracked.
 The reason is that passphrase ends up getting hashed 4,096 times into a 256-bit master key.
 256 bits is way long for a master key.
 So my point is, while you're doing WPA security, if it's okay with your lifestyle to have a key that you can't remember,
 but because you can't remember it, that demonstrates how strong it is, then take the time to do it once,
 and you never, never need to worry about it again.
 So then our recommendations, if I can summarize our, certainly use WPA.
 If you are concerned about Wi-Fi security, use WPA because it works.
 Use a completely random password of 64 characters.
 That's the maximum?
 Actually 63.
 63, and that's the most you can use, and randomize them.
 Don't use a phrase, even though that's easier to remember, but since you're just cutting and pasting, you don't need to remember it.
 And it only has to be done once.
 And you don't have to worry about temporal key, TKIP, because that's really more for a business situation where you want to provide security
 between people who are on the same network or maybe protect yourself against former disgruntled employees in a home environment.
 That's probably not necessary.
 There actually is some firmware that can be downloaded into the Lynxis, that WRT54G, that nice little router that a lot of people have.
 Everybody has?
 Yes.
 That are using and running Linux.
 It does have like a little mini radius server technology in it.
 If somebody really wanted to get into this in a home environment.
 You could implement temporal key.
 Not a typical application.
 And if you don't use WPA2, you don't worry about that.
 Nope.
 Not at all.
 Simple old WPA is fine.
 All right.
 Okay.
 And again, folks, if you want to put a sign on your front lawn that says this house protected by guard dogs and keep your door unlocked,
 be our guest.
 We're not telling you not to.
 We just want you to know what the risks are when you do it, right?
 Or how about a little sign on the window that says using strong WPA with a passphrase you will never figure out.
 So go away.
 And then you can just leave it wide open because who cares?
 All right, Steve.
 Hey, it's always good to talk to you.
 And I think that this was important.
 And we apologize to those folks who wanted to hear more of the wireless encryption.
 I was worried about the Sony rootkit for a little interruption or a little intermets.
 So last week, we did think that was important too.
 Yes, people really wanted guidelines for how to really lock down their security.
 I mean, I'm responding to the mail that I get.
 People wanted this.
 So that's it.
 That's the story.
 Next week, unless something happens, we're going to finally talk about VPN technology to be safe no matter where you are using wireless.
 And we'll come to you from Toronto next week, of course, via podcast as always.
 For more information, visit our show notes at grc.com/securitynow.htm.
 You'll also find two versions of security now there.
 The normal 64 kilobit version and a 16 kilobit version for those of you with slower download speeds or less file space.
 As well as transcripts.
 And I think it's great, Steve.
 You've got them in text and PDF form so people can read what we say and understand it.
 Sometimes it helps to read it in addition to listening to it.
 And there's one thing I meant to say that I forgot to say, but it's very important.
 WPA may not be available on your platform.
 It's officially available in XP.
 There is a free WPA client software that runs on all versions of Windows 95, 98 and on that used to be from a company called Wireless Security Corp.
 That apparently McAfee recently acquired.
 But if you put free space WPA space client into Google, it'll take you there.
 And I'll have a link to that on the security now page on GRC and also I'll send it to you for the show notes.
 Because it will allow people who have a WPA capable router but who are running OS's that do not have a WPA client to for free
 add WPA technology to their system.
 And that's very important.
 That's nice.
 And as we said when we talked about web, if all you have is web.
 Web is better than nothing.
 You know, use that, but just understand the risks that you're running.
 And you know, next week we'll talk about using VPN.
 And even if you're using web, VPN can be very handy in securing your system.
 Steve Gibson, thanks for joining us.
 Our hardy deepest thanks to the folks at the AOL Radio Podcast channel who not only broadcast,
 this podcast, but give us the bandwidth so that you can all download it easily and freely at AOLMusic.com.
 I'm Leo Laport.
 We'll see you next time on security now.
 [Music]
