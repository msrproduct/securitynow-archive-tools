 This is Twit.
 Bandwidth for Security Now is provided by AOL Radio at AOL.com/podcasting.
 This is Security Now with Steve Gibson, Episode 70 for December 14th, 2006, FreeNet and Tor.
 Security Now is brought to you by Astaro, makers of the Astaro Security Gateway, on the web at www.ast.com.
 And by Dell.
 For this week's specials, visit twit.tv/dell.
 Time for Security Now with Steve Gibson, the security guru from grc.com.
 And we are so glad to get you back on every Thursday, Steve.
 We have not missed an episode.
 We're never going to, Leo.
 I just, I mean, I'm willing to, you know, we recorded last week's actually yesterday,
 which was three days early for last week's episode.
 And now we're recording this one on the following day on Tuesday for a week and two days early,
 because you and I are going to be together in Toronto next week.
 But I appreciate your doing that and your willingness.
 And, you know, while most, much of the Twit network is going to go to sleep for the two weeks of Christmas and New Year's,
 you continue on.
 Well, there'll always be a security now if you're getting desperate.
 And you know, Leo, I'm very competitive and I'm watching the fact that our episode numbers are creeping up
 on Twit.
 You're going to be every time Twit, you know, takes a pause or a little hiatus.
 It's like, whoa, good.
 I get a couple numbers closer.
 So you were going to beat them.
 Yeah.
 Twits it.
 You're at 70.
 Twits at 7980.
 So the other one won't take much longer.
 I think we'll take a week or so off because I'm going to Mexico for Christmas.
 So I think we'll take a week or so off for Twit.
 Well, they'll only lose you one or two episodes.
 Yeah.
 I'll lose a few more just for you.
 Okay.
 So last week, we talked a little bit about anonymity on the internet, how difficult it
 is to achieve, first of all, but also the political ramifications and that, you know, they're pros
 and cons, but I think we concluded ultimately that if you believe in free speech, you have
 to support anonymity of some kind.
 Right.
 I felt a little concerned that last week's episode might have been a bit of a fluff episode
 that is, you know, not deep security technology.
 We're going to make up for that today, but I really wanted just to take the time to talk
 about the issue, I mean, like the social side of this because, you know, it is important
 and we're talking about very, very significant technologies that powerful entities like the
 RIAA and the government with the DMCA copyright stuff and, I mean, foreign governments that
 want to regulate free speech, don't take this issue of anonymity and privacy with a grain
 of salt.
 I mean, they've got organizations that are all about preventing people from being able
 to speak freely.
 And as we know, our own US government has now disclosed that they're recording and wire
 tapping as, you know, as much of our country's telecommunications as they're able to.
 So in a non-political point of view, we just learned that the government is going to start
 requiring businesses to save all emails and instant messages for three years.
 So, you know, even at work, you don't have any privacy, especially at work, perhaps,
 not even even.
 So I think it's important that we did talk about that mainly because we often in this
 business talk about the technology, but don't talk so much about the ramifications.
 I know when I sit down with Phil Zimmerman of PGP and we did a number of times on the
 screen savers, I always tried to bring up this issue.
 And he's good about talking about it, but frankly, as most engineers are, he'd rather
 talk about the technology.
 So I think, yes, it was fluffy, but we needed to do it.
 Yep.
 Well, that's behind us now.
 So let's now get ready.
 Exactly.
 And in fact, we're going to be using a lot of the foundation that we established.
 I guess it was either early this year or late last year, all of that crypto stuff.
 We spent a number of episodes talking about public key asymmetric and also so-called private
 key or symmetric cryptography.
 We're going to need that foundation.
 And remember at the time that I wanted to lay that foundation so that we would be able
 to have then conversations that assumed people understood that stuff so that we could talk
 about the all the fascinating ways that this kind of crypto is able to be assembled and
 put together in different, well, essentially to achieve different sorts of goals.
 We're going to get to our subject in just a moment.
 But first, a short commercial break for a Staro and Dell.
 As always, this episode of security now is brought to you by the good folks at the Staro
 Corporation, makers of the Staro security gateway.
 If your smaller, medium business network needs a superior device to protect you from spam,
 from viruses, from hackers, as well as complete VPN capabilities and intrusion protection
 and content filtering and an industrial strength firewall, all in a very easy to use high performance
 appliance.
 You want to check out the Staro security gateway, ASTARO.com, or you can call 877, the number
 for ASTARO, and schedule a free trial of a Staro security gateway appliance in your business.
 Really see what it can do for you.
 They know once you try it out, you're going to know what one.
 And by the way, non-business users, you can use their software absolutely free.
 It's open source and available at ASTARO.com.
 We thank them for their support of security now.
 Also, we want to thank Dell for supporting us.
 Dell's been advertising for the last three months with great success and we really think
 that Twitter audience, the Twitter army for making it so, we've used Dell for so long
 on the TV shows, and I own Dell computers, in fact, my new laptops at Dell.
 In fact, what I've done is put some links to the newest Dell's.
 We just got both of the TV show and me personally on our Leo's Pix page, it's twit.tv/dell.
 Just go there, visit, take a look, click the links.
 If you want to buy something else, let's say one of those great Dell 24-inch monitors.
 I love those.
 Steve has a bunch of them.
 Just click the link at the top there that says, "Go to Dell," and anything you buy after
 that point is credited to Twit, so we do appreciate that.
 That's twit.tv/dell, and now back to Steve Gibson and security now.
 It's crypto always the foundation of anonymity.
 It has to be scrambled, I guess, to be anonymous.
 Well, I guess, I mean, if you look at a real-world example where somebody would just write something
 on a piece of paper, if they wrote it with the other hand that they normally use and
 they passed it through three or four people, none of whom knew the person before the one
 that they'd received it from, and so no one knew who they were going to be giving it to.
 You could invent real-world anonymizing solutions which are non-crypto-oriented, so I would say
 that in general, crypto is not necessary, but it turns out that in order to make it, certainly
 on the internet, in order to achieve the goals of not being able to associate the sender and
 the receiver of information, crypto really does play a strong role because it allows you
 to have provable enforceability of these things.
 Let's step back a little bit and just notice that one of the reasons anonymity is so difficult,
 and one of the first things I said last week was anonymity, internet anonymity, is much
 harder to achieve than most people appreciate.
 The reason internet anonymity is so difficult is essentially, like so many things, the internet
 was not designed to provide.
 It was never designed to provide anonymity to people.
 That just wasn't in the design specs.
 It wasn't part of the plan, and the most perfect example of that fact is that IP addresses
 are the way packets route from one end to the other.
 As we know, all internet endpoint systems, machines, routers, whatever, are identified
 uniquely on the net by an IP address.
 Well, I mean, that's technically it's anonymous in as much as it doesn't tell you the name
 of the company or the name of the person with the IP, but it is a tag that can be used to
 uniquely identify every sender and receiver of traffic on the net.
 So it's the first thing you want to get rid of in anonymity?
 Yes, exactly.
 I mean, it is the way the net is structured and the way data moves is there's never been
 a notion on the net of the internet being about anonymity.
 So the point is, anything we do to add that is a layer on top of the existing structure,
 which was just never designed to be anonymous.
 So I mean, it's a hard thing to do.
 Another example from things we've discussed before is SMTP headers.
 We've been talking about, for example, if I send email through Google, but from my
 own system's email client, rather than from a web page at the Google server, there are
 headers which are added that identify my IP as the originating IP.
 And in fact, that's the case even if you use Hotmail or Yahoo, and you use their browser
 interface, the IP you sent from is there.
 And in fact, the SMTP protocol that the protocol for routing email across the internet in order
 to avoid the potential for routing loops, that is where email is sent from one SMTP server
 to another, it sends it to a third, and due to some misconfiguration, the third server
 sends it back to the first, well, if there wasn't some way to prevent, to record the
 path the email had taken so far, then it would be possible for the email to get stuck forever
 being forwarded through, you know, multiple SMTP servers in some sort of a routing loop.
 So the very structure of the internet requires real identification.
 Exactly, exactly.
 I mean, many things about the net are assuming that you're going to create some sort of a
 record of the path that the data took, or certainly the IP that originated the data so
 that you're able to send something back.
 So as a consequence, the all the technology we've got in place is about being non-anonymous,
 not necessarily identifiable to an individual or corporation, but certainly back trackable
 to the physical sort of electrical source of the data.
 So two technologies we talked about last week are different in what they achieve.
 I want to talk about free net only briefly, because there isn't that much to say about
 it, and then we'll sort of finish out by talking in detail about how Tor works.
 As I mentioned also last week, many anonymizing systems deliberately don't allow people to
 anonymously create content.
 That's not what they're about, the famous anonymizer.com system, which has been around
 for a decade, they're about allowing users of their service to anonymously visit websites.
 And so those users are pulling existing public content, but they're the identity that, well,
 their own identity, their IP address, and presumably cookies and other bits of debris that might
 be part of the HTTP transaction, those are being deliberately cleansed and filtered by
 this anonymizing proxy, and their actual address is being hidden.
 We remember also that by default a proxy will include the IP of the user for whom it is
 performing the proxy service.
 For example, cable modem companies use a caching proxy in order to minimize their use of bandwidths
 for all their consumers who are, for example, going to the same page or wanting to download
 the same gifs and so forth from web servers.
 If the caching proxy has the data, it doesn't need to ask the server for it again that minimizes
 the ISP's transit bandwidth and allows the ISP to keep the bandwidth within its own organization
 for which it, you know, pays a much lower cost because it's using its own infrastructure.
 But when requests leave that ISP, almost always there will be a tag in there saying I am making
 this request on behalf of the following IP.
 So again, that proxy is not helping anonymity at all and it's very possible then for the
 website to see where the request really came from.
 So an anonymizing proxy that is a proxy that is deliberately designed to hide the identity
 of someone for whom it is making the request, it will not add those sort of those optional
 headers which really don't have to be there anyway and it will make the request just as
 if it was making it on its own a half and then turn around and send the response back.
 So that's a, you know, there's anonymity being provided there.
 But as we also mentioned last week, it's not very good because, I mean, it really wasn't
 meant to be ultra robust.
 Well, isn't there?
 I mean, doesn't the server know where it came from?
 I mean, that's part of the problem of the server can keep track of that.
 Well, yeah, certainly their own records, if they were maintaining records, they could,
 but imagine an external agency, for example, a government that wants to know who is making
 request, who is making up exactly who is, who is using an anonymizing proxy in order
 to hide their identity.
 All that person would have to do is analyze the traffic patterns coming to and from.
 Okay, I mean, okay, in the simplest case, imagine that only one user was using the proxy.
 Well, if one user was using the proxy, packets would go to the proxy, they would come out
 the other end, go to a web server, their responses would come back from the web server and they
 would go back out of the other end of the proxy back to the user.
 So obviously, anyone looking at the traffic could determine what, you know, which user
 was visiting, you know, that, you know, they would know.
 Yeah.
 But that's the trivial case.
 I mean, there's a lot more than one person using these things.
 Well, and so I wanted to point out, though, that that's the level of, I mean, that that's
 the way this can be busted is not only using timing, but using packet sizing, because another
 way to associate incoming and outgoing traffic is to look at the packet sizes, which may,
 you know, may or may not be changing dramatically in size.
 So, so, so my point is that, yes, when many users are using a single focal point, then
 it's more difficult, but, but more difficult still not being, I mean, still being a way,
 way short of being impossible by doing traffic analysis.
 So traffic analysis is something that the people who built the Tor network, for example,
 and to somewhat lesser degree, the, the, the free net network, that's something they recognized
 as an Achilles heel for anonymity busting, and they've gone to substantial links to get
 around that.
 And that's, that's what we'll be talking about when we talk about Tor, but, but free net
 differs from many of these other anonymizing systems, because it is all about storage.
 That's what it's about.
 It's about basically creating dark networks, as they call them, of, of storage.
 Users of free net give up, they, they've, they basically share unused hard drive space
 to participate in this free net database.
 In, in sort of in the same way that the people who run the SETI screensaver, are, are contributing
 their unused CPU cycles, and, and sort of the way that, like, users of traditional peer
 to peer file sharing, like, like, you know, kazah and, and lime wire and all those, they're,
 they're basically allowing unused band, they're unused bandwidth and also their storage in
 some cases to be used, similarly, free net users are saying, okay, I want to participate
 in this distributed database.
 So I'm going to give up a chunk of my hard drive in return for being able to use chunks
 of everybody else's hard drive in this network.
 The way the system works is, and, and probably since so many people are probably familiar,
 at least in passing with kazah, for example, or any of the traditional file, peer to peer
 file sharing systems, those systems have a number of problems.
 First of all, and, and probably mostly the, the data being sent back and forth is not
 powerfully encrypted, so it's possible for, for someone to, to create a, you know, a sort
 of a pseudo user and obtain known copyrighted files from somebody else, and you know who
 has them, the files stored on people's hard drives are not encrypted, they're just the
 regular file, and they bear their regular file name.
 So it's very easy for the RIAA to issue subpoenas, cause, you know, the police or the FBI or
 whatever law enforcement to visit someone's home, you know, grab their computer, do a
 directory listing, and see all of the copyrighted material these people have.
 So what FreeNet has done is they have completely solved all of that problem.
 That is, as, as we were saying last week, I mean, it's a, it's a fact that, that you
 cannot have enforceable copyright if you have freedom of speech.
 So, and I want to make very clear that I'm not advocating any breaking of copyright.
 I'm just talking about the technology week, you know, we covered the social and political
 aspects last week.
 So I'm just, you know, I'm wanting to explain how this works rather than, you know, running
 around cheering it on.
 That's, that's not what I'm, I'm here for.
 What the system does is someone who wants to submit a file, whatever kind of file could
 be, you know, political agenda, it could be anything.
 I mean, FreeNet basically is a, is a very secure and now anonymizing distributed database.
 Somebody submitting the file generates a, a hash of, of whatever they want to call it.
 So they, they could call it, you know, Batman begins DVD dot ISO.
 That's what they can call it if they want to.
 But that it is hashed using 160 bit SHA one hashing and we know from, from prior security
 now episodes where we've talked about that what that does is a cryptographic hash takes
 a string of plain text that is to say the name of the file and converts it to a, a very
 likely to be unique hash that is 160 bit that looks just like random data.
 If you change any character in the name, the hash ends up having, if it's a good hash about
 half of its bits will get flipped and it'll just look like it's a lot, like it's a random
 flipping of bits.
 There's, there's no way, and this is the key, there's no way to go backwards.
 That is you, you, you put the file name, you know, Batman begins DVD dot ISO into this
 hashing function out the other end comes 160 bits.
 Well, every time you put the same name in, you're going to get the same 160 bits out,
 but there is no way to having the 160 bits to reverse that process.
 You can do a, what's called a dictionary attack that is to say you could guess that
 something was this name and put it in and see if the 160 bits matched.
 And if you got a collision, there's a high probability that the same string was used,
 but it's not provable that is even then, even when you get what's called a hash collision,
 meaning that you are, you put something in and you got the same result out, there's never
 a way to prove that the, that there, well, because in fact, mathematically we know there
 are a great many strings in theory that can generate the same 160 bits.
 So you have provable deniability there.
 Well through this process of encryption and, and hashing of, of descriptive keys, free
 net is able to provide anonymous storage of anything people want to store.
 There's a problem with what's called a flat namespace, meaning that all people who are
 using free net were using sort of like the same hash.
 So there, so what they've done is they've created this notion of, of private namespaces,
 meaning that an individual user will have their own handle.
 And so their own handle is used along with the, the, the filed name or, or, or file description
 that they want to submit to create a hash.
 And that prevents somebody else from, you know, with their own handle from, who, who
 submits a file that happens to collide in terms of hashing, it prevents that collision
 from happening because individual users have, have, have distinct handles.
 There's also, I mean, it's, it's such a complex protocol.
 I've, I've looked at it, I've, I've understood what they're doing, but it's really not necessary
 to get into the, to the minutiae of the details of how they perform encryption.
 But I do have a link on our, on our show notes for a PDF that completely describes this.
 If this description ends up interesting, someone who wants to really get into it, because these
 guys have worked out the system such that, that a free net system of, of these nodes,
 all nodes are peers, they're identical, they don't have knowledge of each other beyond
 their own local neighbors.
 And that's a deliberate measure to increase anonymity.
 So the idea is when someone inserts a document, a file of any type and, and description into
 the system, it just gets absorbed by this distributed network.
 There are indexes running on nodes that index based on the, the proximity of the hash.
 So the system self-organizes and it, it means that when, if you were to tell somebody else,
 go get this file from free net, they are able from their, no matter where they are geographically
 to, to, to, in, into their own node to say, I would like to retrieve this file.
 They do it using the, the plain text strings they were given, meaning the user's name and,
 or the user handle and the, the file description, the, the free net hashes that into these, these
 indexes from the, from that and from other material.
 They're able to generate cryptographic keys, which are able to decrypt the file because
 all the contents is stored encrypted in a way that is really secure.
 So there isn't a way if someone did bust down someone's door and say, Hey, we know you're
 running a free net node, you know, we want what's on your drive.
 Well, all that's there is a bunch of random bits.
 Now, I have to say, I mean, this all sounds really good.
 And I guess we talked about this last episode.
 I just want to kind of underscore this because I know people are thinking this as they listen.
 Okay.
 So I'm allowing people to store pirated movies on my hard drive.
 Why is that a good thing?
 I mean, and, and, and, and that now Leo, now that I've sort of better explained the power
 of this, now you can understand why I wanted to spend some time last week and say, well,
 you know, I, and, you know, and this is also why I just said I'm not advocating this.
 I bet there's a lot more pirated stuff or maybe illegal stuff than there is dissent and,
 and you know, documents from whistleblowers and things like that.
 I think that's probably the case, like 99.99%.
 I mean, it is a powerful archiving system for, for, for trading and, and, and, and posting,
 you know, anything and you can, you know, mean, you know, and, and, and again, we, as I said
 last week and this comes from the free net papers.
 If you have, if you have in order to get free speech, you must have anonymity because speech
 is not going to be truly free if it's not anonymous or if you at least don't have the
 option of it being anonymous and, and similarly, copyright requires enforcement, but enforcement
 requires a lack of anonymity.
 Otherwise, there's no one to enforce against, which means that if you're going to have free
 speech, you are not going to have copyright enforcement.
 And so you did say that last week.
 Now I understand why.
 Right. And, and, and so the point is these free net guys, the, the people who have designed
 this and put it together, I mean, they're, they're adamant about the necessity for free
 speech.
 Free speech means anonymity and anonymity means non enforceability of copyrights.
 And I mean, and there just isn't a way around.
 I mean, it is a, it is a legal, social, political dilemma, but, you know, our society has lots
 of those.
 And so here's one more.
 But, but yes, I'm glad you, I'm glad you reinforced the idea that, I mean, what this
 really means is people who participate in free net, who, who want the option of, of accessing
 this data and who are contributing a chunk of their hard drive, their hard drive is probably
 storing really bad stuff because just, I mean, in general, bad stuff is the stuff that has
 to hide and this is all about hiding, you know, it's about anonymity and hiding.
 Yep.
 Yep.
 Okay.
 Cause you know, after we talked about it last time I, I went and I looked at the site and
 I thought I'll download this and saw it because I want to support freedom, but I, I decided
 not to for that very reason I thought, but I don't know, I don't know if I want to support
 storing other stuff.
 Yeah.
 It's a very tough choice, you know, and as, as we talked about, I mean, anonymity, even
 anonymity by itself is a, is a double edged sword in my own, in my own news groups.
 I know that the anonymity I freely offer people who post helps them to say what they want
 to say.
 And I want to know what they really want to say.
 Right.
 I don't want to hold them accountable.
 I don't want anyone to be able to hold them accountable.
 So it's completely cool with me if, you know, if unknown people are posting things because
 it's a good thing at the same time, we, in the past, as I mentioned, we've had trouble
 being trolled by people who were in, in everyone's opinion there were abusing that anonymity
 and, and causing problems as a consequence of, you know, posting content they wouldn't
 have posted if their identity was, or, you know, was enforceably known, which, you know,
 it isn't.
 I mean, I mean, it is a mixed blessing, but it is, it is a powerful technology that exists.
 And I wanted to talk about it.
 And I'm glad you did.
 And so it's a tough one.
 I just don't know what the answer is.
 Yeah.
 I know.
 Okay.
 So Tor, let's talk about Tor because that was free net.
 All right.
 That was free net, free net being a distributed, anonymizing, encrypting, you know, database
 that runs on free net nodes, scattered far and wide, designed to allow people to anonymously
 securely share any content of any kind whatsoever.
 And I'm, and they, and they've achieved it.
 Okay.
 Tor is different.
 And Tor is something that interests a lot of people.
 We talked about the vulnerability of using a single proxy as an anonymizer, because in
 fact, traffic analysis while complicated is, is, is, you know, like in cryptographic terms,
 it's trivial.
 If you take the case of one user using a proxy, it's obvious who they are and, and what sites
 they're visiting, because anything they do is being done on their behalf by the proxy.
 Okay.
 So now that's easy.
 Now two users are using the proxy.
 Well, it's a little more difficult, but by looking at the timing of the arrival and, and,
 and the departure of packets and the relative sizes of the packets, you could still probably
 disambiguate the, the, the actions of two users across a single proxy.
 So now we increase it to four and five and six and so forth.
 Well, okay, clearly the more active it is, the easier it is, or I'm sorry, the more difficult
 it is to, to disambiguate queries.
 But it's not difficult on a, like a really, really, really hard scale.
 Also you have the ability of storing the traffic and, and doing an analysis of it after the
 fact.
 You could just capture a huge blob of traffic and then take your time analyzing it to any
 level of detail needed in order to make your determinations about who was making queries
 where.
 The point is that using a single proxy is just not sufficiently anonymous.
 There, there isn't a way to, to make it work well enough.
 So knowing that this notion of a network of proxies was created and that's what Tor is,
 Tor stands for the onion router, T O R the onion router.
 And, and as I got into this, I realized, okay, we do, I really have to explain how this works
 because it is so cool.
 I mean, it is very clever.
 At the moment, there are nearly a thousand onion routers operating in a network.
 The EFF, the Electronic Frontier Foundation has been a major sponsor and funder of this
 because they want to promote this notion of, of anonymity.
 I mean, and, and actually promote the, the actual execution, I mean, the availability
 of anonymity on the internet because they believe in free speech and, and think that
 this is something that is, is worth, you know, making sure we don't lose.
 So, so you've, we start with a massive network of, of onion router nodes.
 Somebody wants to create a connection through this network to a remote server.
 They want to use it for web serving.
 They want to use it for, for sending messages, for email or whatever.
 They, the, the Tor system, which is in a second generation now, is a general purpose TCP conduit.
 So instead of being protocol specific, for example, like a proxy might be an HTTP web
 proxy and proxying web requests.
 The onion router system is a, is a general purpose TCP transmission system.
 So you're able to potentially run any protocols through it that you want to the, the originator
 of a connection chooses at random some number of onion routers that are in the network.
 And these things, since there's nearly a thousand of them, they're scattered far and
 wide all over the globe.
 Now, the more you choose, the more hops your traffic will have to go through.
 So the greater latency you'll have in your communication.
 That's a complaint people always have with anonymizer too, which works in a similar
 fashion that it slows you down.
 Right.
 Well, and there's just, there's no way around the fact that it's going to slow you down.
 One of the really important features of this system is that is, is that by, by going from
 hop to hop where these hops between routers have been carefully designed, and that's what
 I'm going to talk about next is, I mean, exactly how this works by, by going from hop
 to hop with, with this protocol, this onion routing protocol, that's where you get the
 power of real anonymity, even, and the system is robust, even in the face of many routers
 being compromised.
 I mean, bad people, governments, you know, anybody who was, you know, not acting in the
 best interests of the people using the system could set up a, a malicious onion router.
 This system, however, still functions robustly, even in the presence of malicious onion routers
 that are being, are deliberately being run in order to try to break the system.
 I suppose there's no way that they could prevent that.
 I mean, people are going to set up malicious onion routers.
 Well, yes, and in fact, or spying onion routers.
 It's one of the attractive things about this is that because you've got nearly a thousand
 of these, and they're in all kinds of different countries, they're being run by, you know,
 many of them by really trustworthy organizations where you just like, okay, I trust the EFF
 to be, you know, really to be on my side.
 But for example, a company like Anonymizer, I don't mean anything against them.
 This is, it's a great service they provide.
 And if the government issued them a subpoena and they're the sole controller of their anonymizing
 service, they could be forced legally to do something they would rather not do.
 The beauty of, of this massive network of nodes controlled by all kinds of distributed
 entities all over the globe and, and, and foreign countries and, and the need not to
 trust individual nodes, I mean, it really is the perfect solution.
 So the way this works is somebody who wants to create a circuit through multiple onion
 routers chooses the, the routers they want to use and the order in which they're going
 to, their traffic is going to move from router to router.
 There's probably default setting, right?
 I mean, not, you don't have to go through this every time.
 But I don't mean that the user manually chooses, I mean, I mean that the system chooses for
 you.
 But I sort of operating down at the protocol level, the way, the way the system works is
 a random set of routers is chosen.
 All routers have a, a public key pair.
 That is, they have their own private key that only they know and they have a public key.
 Now as we remember, the way this functions is something can be encrypted using their publicly
 available key, which everyone can know, and once encrypted, that data can only be decrypted
 using the matching private key that, that, that, that that router never divulges, that,
 that's its secret key that matches its public key.
 So all routers have these asymmetric or, or, or public key pairs.
 What happens is the, the user starts at the, the, the far router.
 I mean, the, the, the user is, is going to build what's called an onion and, and the,
 the term onion is used because we're used to onions being, being created in layers.
 Having skins.
 Yeah.
 Yeah.
 Having skins and you successfully peel off the layers of the onion.
 So, so we'll go to, it's like an onion.
 So, so conceptually, you didn't see Shrek, so you would, I did not see Shrek as a big,
 green thing.
 That's all I know, anybody says ogres are like onions, they've got many layers.
 Okay.
 So, and so are our routers.
 So our tour wrap.
 So our tour routers, yes.
 So, so the users preparing the onion takes the, the, the, the, I really throw you with
 that.
 Didn't I?
 I'm sorry.
 I won't say anything more about ogres and onions.
 This is really, it's really complicated.
 So, you know, so I want people to pay attention.
 I mean, this is really, it's really complicated, but really good.
 So the user takes the public key of the last router in the chain that they've chosen.
 And they, they, they take a randomly generated symmetric key, which is, is going to be used
 to decrypt the traffic it receives.
 And they encrypt that symmetric key with the route, that last router's public key.
 So now they have a blob that, that contains a, an encrypted symmetric key that only the
 last router is able to decrypt using its private key.
 That makes sense.
 Okay.
 Okay.
 Now they take that blob.
 They, they come up with another, they, they just randomly generate another symmetric key,
 which the second to the last router is going to use to decrypt the traffic it receives
 and the symmetric key they gave to, I'm sorry, yeah, to decrypt the traffic it receives and
 the identity of the next router that is the last router in the chain, which is the one
 to which the second to the last router will send its traffic.
 So, so there's another symmetric key and the routing information for the second to the
 last router and the blob, which that, which we have from our first encryption.
 Yes, we, we encrypt this entire thing using that second to the last router's public key.
 Now our onion has two layers.
 Now we step back to the third router.
 We invent, we randomly create another symmetric key, which it will use to decrypt the traffic
 it receives and we give it the routing instructions for the second, for the, for the router second
 to last, meaning the one it will forward its traffic to and that entire blob we had before
 that, that two layer onion and we encrypt the whole thing using that third to the last
 router's public key.
 Now our onion has three layers and we continually step backwards building this onion, this nested
 multi layer encryption, each layer encrypted with a successive router's public key, which
 only that router knows how to decrypt and each layer containing a symmetric key, which
 was generated randomly by us at our end.
 When we're finally done, we, we have this, we, we stepped back through the whole chain
 back to the, the onion router that we will be using to inject our traffic.
 And so now we've got this, this thing called an onion.
 We, we give it to that first router.
 It uses its private key to decrypt the outer layer of the onion.
 Only it is able to do so.
 Nobody listening in on the traffic is able to see that happen.
 Only it internally knows how to use its private key to take the wrapper off of the onion.
 When it does so, it has an opaque blob that it doesn't, that it cannot decrypt because
 only the next router in the chain has the matching private key to decrypt the next layer.
 But when it decrypts it, it, it finds a symmetric key which it will use for decrypting traffic
 it receives and the routing instructions for the next router.
 That's so, so even somebody is there, there's no way to even know by looking at the onion
 what the path will be.
 Only the router that decrypts its layer knows the identity of the next router in the chain.
 It knows nothing about any other routers in the chain.
 It doesn't even know how many other routers there are.
 It knows nothing except its own local, I'm going to receive data decrypt with a symmetric
 and where do I send the result?
 That's very slick.
 That's so slick.
 Oh, it's so cool.
 So, of course, this thing then, it now knows where to send the remaining blob to, it knows
 which router to send the remaining blob to, the so-called onion.
 It sends it to that router, that router receives it, uses its private key which is the only
 key which can be used to take that, the next layer off the onion.
 That from that it gets its symmetric key for this connection and the routing instructions
 for the next router and it forwards this thing down.
 So, this onion which was built once in the beginning, it then moves through the network,
 basically informing each node of the onion router system, only the information it has
 to have, I mean literally, only the information it has to have, how to decrypt what you receive,
 who to send it to, each onion router only knows one step in the chain and no more.
 That seems impervious to any kind of, including a corrupt router.
 I mean, it is just deliciously robust, I just love it.
 However, it seems like there's also a lot of overhead.
 You've got a lot of encrypting and decrypting going on.
 Now, that's the other beauty of this, is remember that asymmetric encryption is very slow.
 Public key crypto is on the order of a hundred times slower than symmetric.
 So, all of that work only needs to be done once.
 What we just did was we established a circuit.
 We have not sent any data yet.
 Oh, okay. The onion is not a data carrier, it's just a circuit creator.
 It's a route, basically.
 Exactly.
 It is an incredibly cool, secure route that also manages to supply symmetric keys to every
 router along the way.
 Now, we want to send data.
 To send data, we take the actual data we want to send.
 The first thing we do is pad it out to a fixed size.
 That's one of the other cool things these guys did.
 They recognized that traffic analysis could use the packet size for disambiguation as
 we saw in the simple single proxy case.
 So they completely solve that so that no matter how big the packets actually are, we're going
 to pad them out to full size so that all packets moving among the routers within the
 onion router system are the same size.
 You can no longer use size to give you any clues because they're all the same.
 PGP does that too, that's a great technique.
 Yes.
 So the next thing we do then is we take the data we want to send.
 We use symmetric encryption, remember, that's very fast.
 Symmetric encryption is very, I mean, it's like not a concern anymore, it's so fast.
 We first encrypt it with the last symmetric key that is with the actually the first symmetric
 key we generated, which we gave to the last onion router in the chain.
 Then we encrypt that with the second to the last symmetric key, we encrypt that with the
 third to the last symmetric key and so on working ourselves back up the chain.
 So we have something still the same size, that is, it is the because symmetric encryption
 doesn't change the size, remember, it just flips the bits.
 So we've got something which has been encrypted n number of times where n is the number of
 routers in our onion routing chain.
 We then give this blob to the first onion router.
 The last encryption we did was with its symmetric key.
 So it's able to decrypt it, but remember all it's doing is decrypting a layer of encryption.
 It's still a blob, that is, it's still encrypted n minus one times.
 Using keys, it has no knowledge of it because those keys were buried in layers of the onion,
 which were encrypted using the public keys of the other routers that can only be decrypted
 using their private keys that no one has any way of knowing.
 So it takes this and simply so it runs a very fast symmetric decryption on what it receives
 and forwards it to the next router that in the circuit because it's maintained a circuit
 awareness of what its next router is, remember, it knows nothing other than the next router.
 That router receives it, sees what circuit ID it is, looks it up in its table, it uses
 its symmetric key to again perform the same decryption on this data packet, which it then
 forwards to the next router.
 The beauty of this is there is no way for anyone looking at an onion router to have
 any clue what's going on.
 Not only are the packets all the same size, but because a symmetric decryption occurs
 between incoming and outgoing data and we know that state-of-the-art encryption just
 looks like randomness, there is no correlation between the data of the packets coming in
 and going out.
 It looks like packets of noise came in, packets of noise went out and because this is a richly
 interconnected system, packets are coming in from all these onion routers all over and
 going out to all these onion routers all over, but there's nothing to help you determine
 which one is which, I mean like where the circuits are, there's just no way to figure
 that out.
 But when this data packet finally gets all the way through its multiple hops, it is finally
 decrypted with the last symmetric key by the last node and that is again the text or the
 data that you originally put in at the front end and baby that is anonymous.
 And by the way, you've more than made up for, if anybody thought last show was fluffy,
 you've more than made up for it with this one.
 But once again, it's very elegant to see this really nifty solution to a complex problem.
 Oh, I just, I mean it is, it's one of these things where, and I promised our listeners
 this a year ago that once we had the foundations of symmetric and asymmetric crypto under our
 belts.
 So we could talk about the things you could do with it.
 This is the kind of stuff you can do.
 I mean, it just, it is so neat and there's thousands, well not thousands, there are, that's
 more than many hundred.
 It's I think nearly a thousand of these onion router nodes.
 The system is called Tor, T.O.R., the onion router.
 It is slow.
 I mean, it's not like, you know, going to Microsoft.com or Yahoo or Google where you're
 making a point to point connection, but they know everything they, they care to know about
 who you are.
 The, the trade off is you need to go through multiple hops.
 We've seen why multiple hops are necessary, why just running through a single proxy server
 doesn't really give you robust anonymity, but this onion routing system does.
 And, and it is just, it's just elegant.
 Yeah, T.O.R.E.F.F.O.R.G is a good place to go to find out more and actually to start
 using the Tor system.
 Well, now I feel a thing about Tor, unlike free net, you're not really volunteer, unless
 you volunteer to be a Tor system, you're not volunteering for anything you might not be
 comfortable with.
 Well, yes, you're right.
 And you can use Tor completely freely and safely.
 Yes, I mean, you could certainly be an onion router, in which case you would be offering
 your node as to enrich the network.
 You'd be offering your bandwidth also, but you don't have to use it.
 That is correct.
 You are able just to be a user of the network.
 You would also, I was going to say you, you would be offering your bandwidth, you would
 be offering your node to enhance the anonymity, creating ability of the network, but you would
 not be offering any storage space.
 You don't store anything, right?
 Exactly.
 Hey, I want to thank you, Steve, for clarifying this and for talking about it, because I think
 it's very important, and I'm a big believer in freedom of speech and privacy, and I think
 these two technologies are very important to preserving that.
 I guess my position is, if somebody needs it or wants it, it's cool that it is available
 to them.
 That's exactly right.
 That's exactly right.
 What else is available?
 grc.com, a great place to go to protect your system, whether it's with shields up, the
 free tester that'll test your router or your firewall, or many of his free programs, shoot
 the messenger, decombobulator, unplug and pray and on and on and on, and a new one coming
 up any day now.
 Yep.
 I get to work on it now.
 GRC, you got a couple of weeks to work on it, yeah, grc.com.
 That's where you'll also find the show notes with the 16 kilobit versions for the bandwidth
 impaired and the transcriptions by Elaine, so you can read along.
 This is one you probably will want to read along to, I have a feeling.
 And spin rights there, too.
 That's Steve's daily bread and butter.
 He has been writing that wrote that program about 15 years ago now.
 You're in version six and still going strong, still the best.
 I think no, I think there is no question the best disk recovery and maintenance utility
 on the market today.
 If you have a hard drive, you need spin right.
 Any good letters lately from us been right?
 I got, I got one cool one.
 It's from a guy.
 He said, I'd like to thank you for spin right six.
 I was handed a computer with a completely dead hard drive from a Catholic parish.
 He said, I tried two other tools which ran in windows, both locked up at about 60% into
 the test.
 He said, I then put these aside and bought spin right.
 I had been meaning to buy it for myself anyway, since I'm the one people seem to come to or
 you see, people seem to come begging to around here.
 And that's who should have it that people, you know, that's why I have it.
 Yeah.
 Yeah.
 He said, he said, it took spin right a long time to complete, but when it was done, I
 was able to get the data off the drive.
 There were some corrupted files, but the parish said I had the most valuable ones.
 Wow.
 He said, he said, this may sound strange, but I was also able to prove to them that even
 though we were able to get the data back, the drive should be replaced.
 Watching spin right work on the drive also helped me to convince them to take the time
 to back up.
 Well there you go.
 Well, that was worth it then.
 Sorry.
 It was a win for everybody.
 Yep.
 Well, Steve, I thank you so much.
 We will adjourn and then restore return to our regular security meeting in a week on Thursdays.
 As always, by hook or by crook, he's trying to catch up with Twit.
 We'll see you next week for Episode 71, Steve.
 Thanks a lot.
