 (upbeat music)
 This is "Security Now" with Steve Gibson, episode 31,
 for Thursday, March 16th, 2006.
 (upbeat music)
 - Steve Gibson, it's a great day to talk security.
 How are you today?
 - Yeah, I'm just greatly, great to be back.
 - Yeah.
 - We embarked on the part one of our crypto series,
 very popular last week.
 Although there wasn't really a lot of hard technical facts
 in it, it was really mostly about the issues
 surrounding crypto.
 - Right, although we really got a lot of good feedback
 from it.
 I think people liked the idea of sort of talking about,
 okay, the sociological and moral and ethical aspects
 of this, rather than just plowing directly
 into prime number factorization
 and all of the technology.
 And in fact, one thing that we,
 remember we were brainstorming toward the end there,
 what different types of applications crypto technology had.
 One thing that we failed to mention at that moment,
 and I just sort of, I thought of it as an hour later,
 I was like, ooh, was personal storage encryption?
 - Oh, of course, yeah.
 - Yeah, I mean, like true crypt we've talked about before
 and the original use of it, right?
 - Exactly.
 I mean, and they're scripting your files, your data.
 - Yeah, or exactly.
 Some like where a partition on a laptop
 or you want to encrypt a USB thumb drive
 so that if you lost control of it,
 the idea is not for transporting the information somewhere else,
 but if you lost control of it,
 what would you do in order to prevent people
 from having any access to it?
 - Now, will we talk about applications like that
 in this series or is that for another time?
 - Oh, no, well, I think, I think the idea,
 my concept is that we're going to talk about
 sort of the technology and the modules
 and how they fit together, sort of the fundamentals.
 And then, I mean, there's so much stuff
 that depends upon this.
 I mean, one of the reasons I want to do this
 before we come back to and wrap up the open VPN stuff
 is that a lot of the technology
 that I want to be able to talk about depends upon dough.
 And for example, when we talk about true crypt,
 which is a fantastic open source technology,
 I want to build up a vocabulary
 so that listeners who've been following along
 know when I talk about how this stuff works,
 really what it means.
 I mean, I felt a little uncomfortable, for example,
 when we were talking about Hamachi earlier on,
 I wanted to explain exactly why it was so clear
 that this was secure,
 but I didn't have the underpinning technology
 that I knew everyone would be able to get
 what I was talking about.
 - Yeah, so it's a comeback, yeah.
 - Oh, yeah, yeah.
 So we'll circle back and then we'll talk about applications
 for encryption and Microsoft's built-in encryption
 versus things like true crypt and all of that.
 But that'll be a later on in the series.
 - Right, anything else you want to correct or--
 - Well, a couple of things.
 I have a couple new pieces of technology on the GRC site.
 One of the things that's been happening
 is you know that we have a feedback form
 at the bottom of the securitynow.html page on GRC.
 Many people do remember to put their email address
 in the body of their note.
 And I've always had technology that parses the notes
 to see if there's an embedded email address.
 And if so, it basically emails their note to me
 so that when I reply, it just goes back to them.
 But a lot of people don't remember to do that.
 And so I get these anonymous postings,
 which is fine with me, but they'll ask a question
 that I'm dying to respond to them to.
 But they didn't give me their email address.
 And of course, we know for our Q&A episodes
 that we'd like to be able to say,
 just sort of call out their name and say where they're from.
 And again, some people remember to do that, some don't.
 And of course, if anyone wants to be anonymous,
 I've got no problem with that.
 I mean, I'm Mr. Privacy.
 Anyway, so I've redesigned the form at the bottom of the page
 so that there are now optional fields
 where I'm specifically saying name, email address,
 and location, which can absolutely be left blank
 if someone doesn't want to fill them in.
 But I think I'm excited because there have been so many responses
 that have been anonymous where the person asked me a question
 I could have easily answered, but I didn't have their email address.
 So just when you're not collecting emails,
 you're not trying to invade their privacy.
 It's just so you can respond.
 And I make that very clear on the page.
 I say totally optional information.
 And I specifically say their email address
 will only be used to address their note to me.
 No record of it is being kept, and that's the case.
 It's a shame, but nowadays, you really always have to say that.
 Anytime you start collecting email addresses, people get it.
 Well, and I appreciate it, too, because when I go to a site
 and they need all this from me, it's like, oh, now what?
 Am I going to start getting bombarded with spam?
 Well, the other thing that I did is we got this really neat note
 last week.
 I forwarded it to you because it was from a security now listener.
 And I really liked it.
 It's short, so I'll read it.
 He said, as a listener of your security now podcast,
 I had planned to upgrade my old copy of Spinrite just
 to allow--
 I'm sorry, just to show my support of the podcast.
 But when my boot drive died last night,
 I knew I needed Spinrite 6 for a different reason.
 Since my old copy didn't support my new hardware,
 I upgraded, then downloaded version 6 on a different machine.
 I burned a boot CD and popped it in the machine
 with the failed boot drive.
 A couple of hours later, I am writing this on the machine
 with the previously failed drive, and everything works great.
 That's nice.
 That's a nice story.
 Yeah, I mean, I loved it.
 And we've got this page of testimonials like this for Spinrite.
 But, you know, me and my URLs, it's--
 I mean, even the word testimonials, I have to--
 it's T-E-S-T-I-M-O-N-I-A-L-S.
 I mean, it's got as many vowels as it has consonants.
 Anyway, so what I did was I thought, OK,
 let's make this easier for people to find
 because I know that we've got security now listeners
 who are wanting to turn their friends and other people
 on to Spinrite, because we've received email like that.
 So Spinrite.info, the domain, Spinrite.info,
 takes you directly to that page, and doesn't matter
 how you spell right, it's R-I-T-E, R-I-G-H-T-W-R-I-T-E.
 So just Spinrite.info.
 And that's the URL we can use from now on, Leo.
 Steve, you're learning.
 You're learning.
 I'm getting there.
 I'm a little slow.
 Yeah, well, that's OK.
 Well, actually, I shouldn't say nobody's ever accused you
 of being a marketer.
 You have been accused of being a marketer,
 but anybody who knows you knows that you're not very good at it.
 Yeah, well, you're too much of an engineer.
 I love the technology.
 Exactly.
 I love the technology.
 OK, now, another thing that's going on
 that is worthy of mentioning, because this is a hoax that's
 been around now for about six months,
 and people keep sending me various links to it.
 There's this hoax that all computers and laptops
 have built-in hardware keystroke monitoring.
 And the hoax is-- it's one of those things
 that's good enough to almost be believable.
 It includes photos of this little inline keystroke
 logger, which actually is an inline keystroke logger hardware.
 But the claims are that all laptop and some desktop machines
 have this built-in.
 And the hoax goes on to talk about how this one guy innocently
 opened up his laptop because he was trying to change something.
 And he discovered this little lump in the wire
 between the keyboard and with a wire going to his ethernet
 adapter.
 And this goes on to say that it's sending the information out.
 And in fact, some moderately respectable sites
 have unfortunately been perpetrating this.
 And I'm looking at the headline on one page here
 that says, "Government and computer manufacturers
 caught installing hardwired keystroke loggers
 into all new laptop computers."
 Oh, please.
 But the problem is people are sending this information to us
 wanting to know, oh my god, what do we do?
 It's a hoax.
 It is not going on.
 It's poorly crafted hoax.
 This was pointed out very quickly when people saw the picture.
 It was just bogus.
 Yeah.
 But again, people who aren't so technically oriented
 are going to say, well, maybe this is possible.
 Could this be really happening?
 Well, I'm glad we can lay that one flat.
 There's a hoax a minute.
 I go to scopes.com whenever I get an email like that.
 I mean, most of the time I go, yeah, right.
 But if it doesn't-- if it's not obviously a hoax,
 I will go to snopes, S-N-O-P-E-S.com.
 And it's a great site for those things into bunking them.
 OK, now following that, we have something
 which is unfortunately not a hoax.
 R's Technica reported yesterday, and I've confirmed this,
 that some researchers in Amsterdam
 have verified that RFID tags can be viral carriers.
 Oh, yeah, yeah.
 I know.
 How would you do that?
 It turns out, if you have a bad, a deliberately malicious RFID
 tag, and it's read by an RFID reader, as these things do,
 you can cause a buffer overrun in the back end database,
 which is collecting data, get code
 to execute of your choice.
 And because the RFID tags can also store information,
 that code is able to then update any other non-infected RFID
 tags infecting them with the same virus, so it spreads.
 Now, that requires a buffer overflow flaw
 in the RFID reading code.
 Does-- do all RFID readers use the same code?
 No.
 And so the point of this-- I mean,
 it's not to say that, oh my god, all RFID systems in the world
 are now bad, but apparently, the RFID people
 haven't been taking enough concern, paying enough attention
 to issues of security.
 They never thought somebody would attempt a buffer overflow
 exploit, you know, an RFID tag.
 Yeah, I mean, it just--
 Which of course they would.
 Exactly.
 If it's there, if it's there, somebody will hack it.
 Didn't you know that?
 And then so, you know, this goes back
 to what we've said over and over and over.
 I mean, new things are scary because they haven't
 had time to be proven.
 It's impossible to claim that something new is secure
 because that's something that only history can judge.
 And of course, security is a hard thing to do.
 Clearly, the RFID people, you know, didn't do this on purpose.
 They just didn't check all their code
 because it's never occurred to them.
 Well, in fact, if you think about it,
 I mean, there's very little data in an RFID tag.
 And you'd think the software to read it would be very simple.
 It's kind of amazing that something as simple as that
 has such a serious flaw.
 I'm glad that it has surfaced this early, you know,
 but before we start seeing RFID-laden passports that
 are like infecting each other and all this.
 So it's a good thing.
 Yeah.
 OK.
 All right.
 On with the show, ladies and gentlemen, crypto--
 is it 102 or 201?
 It's been a long time since college.
 I don't know.
 Well, because we're going to talk about secret decoder rings,
 I think it's maybe 102.
 It's starting crypto.
 Now, it turns out that--
 I mean, literally, I want to talk about a secret decoder
 ring because it's a perfect, easily visualizable model
 of simple crypto.
 And we're going to talk about how you can take that
 and extend it to make it unbreakable.
 And this is essentially what's so-called symmetric crypto
 or private key cryptography is about.
 Now, it turns out that the original--
 I did some research on this, believe it or not,
 on secret decoder rings.
 The original rings would use concentric rings.
 The outer ring was alphabetic, A through Z.
 And the inner ring was numeric.
 They would actually use numbers 1 through 26.
 And so you would set this to some position the inner versus
 the outer ring, and then look up the message
 you wanted to encrypt by looking for the alphabetic character
 on the outer ring, and then look into the number immediately
 adjacent on the inner ring.
 That's how those things actually worked.
 We're going to modify, for the sake of discussion,
 that traditional secret decoder ring,
 because the way normal crypto works
 is that it translates the encryption alphabet
 into other characters of that alphabet.
 Now, when I say alphabet, I mean the entire set
 of possible characters.
 So not just, for example, A through Z.
 For example, in our ring, we're going to use a 28 character
 or 28 symbol alphabet, because I want
 to have a period and a space.
 So we'll have A through Z and period and space, which
 are inner ring on the outside.
 And we're going to have another A through Z period and space,
 which are on a ring on the inside.
 So we have this 28 symbol alphabet.
 Now, if the rings are aligned so that A is opposite,
 A and B is opposite, B, we obviously get no encryption.
 So for example, the term for anything
 that's unencrypted by universal agreement is plain text
 or sometimes clear text.
 But even if it's not textual, it might
 be unencrypted binary stuff, which
 just looks like gibberish of hex junk.
 But we still call it plain text as a term of art in cryptography.
 And similarly, after we do something
 to the plain text to obscure it to encrypt it,
 it's then called ciphertext, again, by agreement.
 So if our inner and our outer secret decoder ring,
 our modified secret decoder rings,
 are aligned, we get no encryption.
 So in order to use this very simplistic encoder,
 you would twist the rings so that they're no longer
 aligned by some amount.
 Now, another characteristic of this
 is that there are only 28 possible combinations.
 That is 28 possible keys essentially for this algorithm.
 Because as soon as you go 28 times,
 you're back around to the beginning.
 But that turns out to be useful, as we'll see in a minute also.
 And we already know that one of those, 28,
 provides no encryption at all.
 So if we rotate our secret decoder ring off to some angle,
 some number of steps, then the process of encoding
 is looking up-- we write down our message
 that we want to send.
 And then for every character, including periods and spaces,
 since we have a 28 symbol alphabet on ours,
 we look up from the outer ring, we
 find the clear text character.
 And we look down into the inner ring for the matching cipher
 text and character.
 And you don't move it for that message.
 You leave it that way.
 Exactly.
 Yeah, exactly.
 For the entire message, you do not
 rotate the rings relative to each other.
 You then run through the whole message,
 and you end up with this encrypted character stream.
 Now, you give it to a friend, and you
 have to give them one other piece of information.
 You need to tell them how many places will just
 say clockwise to rotate the rings from the inner ring
 from its normal alignment in order to decrypt this message.
 So your friend basically sets his secret decoder ring
 identical to the way yours was set,
 and then performs a reverse operation.
 That is, for every character on the inner ring,
 he looks at the character adjacent on the outer ring
 and writes that down, and is able to obviously reverse
 the process you used and get back the original message.
 Simple enough.
 Simple enough.
 Well, it suffers from a couple things.
 First of all, it obviously suffers
 from not having many possible keys.
 That is, as we saw, one of them that
 is no rotation of the inner ring produces exactly the same cipher
 text as plain text, so that's not very good encryption.
 Then we only have 27 other settings before we repeat.
 So it's feasible, even if someone
 got a hold of your message at school, for example,
 and they weren't a really fancy cryptographer,
 they could just put the ring in the first notch away
 from its normal synchronized position
 and try a few characters of the cipher text
 to see if it starts to look like English.
 And then if that doesn't, they click it to the next position
 and try it again and click it to the next position.
 They've only got 27 positions total.
 So in a relatively short period of time,
 they're going to stumble upon the quote key,
 unquote, that you used for this encryption
 and be able to decrypt the entire message.
 So it's not very good from that standpoint.
 There aren't a lot of possible keys,
 and we'll be coming back to that,
 because that's where the so-called 128-bit encryption
 comes in, the 128-bit, or 256-bit, or so forth,
 that's the length of the key in binary bits, which
 specifies how many possible keys there are.
 And of course, that needs to be a big number
 for the sake of brute force testing.
 That is, basically, rotating our decoder ring
 through all of its possible positions.
 And in this case, there aren't very many of them.
 OK, now, the analysis-- say that you
 wanted to attack the cipher that we've generated
 with our secret decoder ring, not using brute force,
 for whatever reason.
 You want to do more of a standard cryptanalysis
 of the process.
 Well, that turns out to be not very hard.
 If you knew that this was English, for example,
 or whatever language it was probably encoded in,
 you could look at a table of the occurrence
 of different letters in the language.
 For example, we know that A, E, T, and S occur very frequently.
 And so with a large enough source message,
 you count up the number of occurrences
 of each of the ciphertext symbols.
 And any kind of a cryptographer would look at this
 and immediately be able to identify what the vowels were
 and probably what S and T is.
 In fact, it's so easy that even some daily newspapers
 have cryptanalysis problems, challenges like this.
 They're very easy to do.
 They're like their crossword puzzle.
 Right.
 E-T-A-I-O-N-S-H-R-D-L-U at the Unsured Lou.
 That's how I know it.
 And that's the sequence of English characters
 from the most frequent down towards lesser frequent.
 Now, the second clue are character pairs,
 because there's strong association in most languages
 with pairs of characters.
 Things that either rarely occur or occur very often.
 And that gives you another clue.
 It turns out, as you go to longer sequences of characters,
 you begin to get a little bit lost.
 There's not that much statistical weight.
 If you look at eight character sequences, for example,
 because there's so many possibilities,
 and not many of them tend to occur that often.
 But the use of single character and character pairs
 completely cracks our simple little code.
 OK, so that wasn't such a good encryption.
 Were Dakota rings used for anything else,
 but Captain Midnight, an all-time radio serials?
 I mean, do they go back to Roman times?
 How long have they been used?
 Good question.
 I didn't go that far back.
 I don't think they were ever taken very seriously,
 because they're so easy.
 I think they were just so easy to crack.
 Now, let's dispense with the inner ring
 and just look at the outer ring.
 So imagine now that we have a next generation encoder
 decoder system.
 And all we're going to use is just a single ring of A
 through Z with period and space.
 Now, in fact, what we know of the prior design
 was that all we were really doing
 was finding a character and moving a certain distance,
 a certain number of character spaces, for example, clockwise.
 And we were wrapping around the end of the sequence
 back to the beginning.
 So for example, if you had A and you went three characters
 forward, you'd be B, C, D, would be your cypherd version.
 Or if you were Z, you would go three spaces forward.
 Dot space A would be your cypherd version of that symbol.
 So imagine that instead, we just have a single ring.
 And again, our key is just how many spaces we go forward.
 Well, it turns out that there is a simple thing
 that can be done to create an absolutely unbreakable code
 system using this approach.
 And that is if the number of spaces we go forward
 for any given symbol we're encrypting is a random number.
 And as we learned before, randomness
 is really kind of key to creating
 difficult to decipher things.
 Yes, randomness comes in all over the place.
 And in fact, we'll be talking about the uses for and the need
 for what are called cryptographic quality random numbers.
 So imagine now that someone had maybe ping pong balls
 and drew a number one through 28 for how far you could go for.
 Actually, we wouldn't want 28 because that puts you right
 back in the beginning, 1 through 27 or 1 through 28.
 That's a good question.
 I didn't think this all the way through.
 But for me, I think we want 28 ping pong balls.
 So you have a basket of these and you swish them around
 and pull a ball out and write down the number.
 Put that back in, stir it around again,
 pull another ball out, write down that number.
 Put that ball back in, stir it around again,
 pull a ball out, and so forth.
 So what you're doing is you're using mechanical randomness
 to create a string of really very high quality random numbers.
 And in fact, this approach was used in early wartime
 to create unbreakable ciphers.
 So there's one problem, though.
 How do you communicate this random number
 to the person who's going to read this cipher?
 Well, I mean, that absolutely is a problem.
 So let's go through the process first.
 And because all the things that have a ring
 and you've got two rings, you can give the guy the ring
 and he can do it.
 But as soon as we start this random process,
 how does he know what ping pong balls you pulled?
 Well, what this is called is called a one time pad
 is this technology.
 And so the idea would be literally an implementation.
 You'd get a pad of paper and you would sit there
 or maybe get an assistant to sit there and pull out balls
 one at a time, write down the number of the ball
 that you got, put it back in, stir it around again,
 and pull out the next one.
 So basically, you create an entire pad of random--
 I mean, truly random numbers numbered one through 28.
 OK, now to use this, we take our existing ring.
 That is, our A through Z plus dot in space.
 We take the ring and find the symbol
 that we want to encrypt and take the first number written
 down on the pad and move that far clockwise around the ring
 and write down the corresponding symbol.
 Then we go to the next symbol that we want to encrypt,
 take the next number on the pad,
 go that number forward and write down the symbol
 that we find at the ring that many spaces clockwise around
 and proceed for the entire message.
 Now we've got a great and possible to decode message,
 even by the recipients.
 Well, but that's the point that is so critical
 and that I wanted to draw this illustration for.
 It is impossible for anyone to decrypt this message.
 I mean, it turns out that what we've done
 is we've taken very, very non-random text.
 We already know that the source text can be analyzed
 all kinds of ways in order to determine frequency
 distributions and characteristics and all that.
 It turns out, though, and this is a critical component
 of cryptography, is that if you mix your clear text message
 with truly random data, there is no force on Earth.
 And I don't mean like we're talking about normal crypto
 where it'll take x number of machines a certain length
 of time to get this done.
 I mean, it cannot be done.
 When you mix a message with randomness,
 and this just counting around a ring
 is a completely valid form of mixing
 where you mix content with something random,
 no analysis can reverse that process.
 And that's what's so cool.
 I mean, none, it's a key concept for people
 to kind of get their minds around,
 is that just even though your message has affected
 these random numbers, because they were random
 in the beginning pulled from these ping pong balls,
 the result is every bit as random,
 even though there is a way if you knew the original pad
 to reverse the process.
 And so for example, in order to decode this, of course,
 the decoding process is pretty clear.
 Somebody who had the pad that was originally used,
 or I should say a copy of the pad,
 that was originally used to encrypt this message,
 would take one of the ciphertext symbols
 and look at the first value on the pad
 and go counterclockwise back to the original symbol
 that was used and write that down.
 And then take the second ciphertext symbol,
 look up the second number on the pad,
 go counterclockwise, and get back to the original text.
 - So they need a copy of your pad, is what they need.
 - Yes, and in fact, this approach, for example,
 was used in submarines and to encrypt
 the most important data that the government
 has ever produced back in the old days.
 - And it would still work even
 with high-tech computer analysis today.
 It would still be undecipherable, am I right?
 - It is more unbreakable than anything else.
 I mean, absolutely completely unbreakable,
 and that's the key.
 - So this is a good system, why don't we use it anymore?
 - Well, because of the point you brought up
 very early on here is how the key to decrypting it
 is having a copy of that original one-time pad.
 Now the term one-time talks about one of the two great weaknesses.
 First of all, you've got to get the pad
 to the person decrypting it.
 Now back in wartime, what would happen
 is literally there were people with bingo machines
 or ping-pong ball machines or whatever
 reaching into them, pulling out numbers, creating pads.
 I mean, this is in the early days of the NSA.
 Actually, it's probably pre-ANSA.
 But the idea being, this was actually done.
 And so submarine captains would go to see
 with a briefcase full of these sheets of paper.
 - They had a pad, they had the duplicate.
 - Exactly, they had a copy.
 I mean, it was the whole courier with the handcuff
 to his wrist case thing, because if this got away,
 this would completely allow the code to be broken.
 - Right.
 - So the idea would be, you needed a,
 what we would call a secure channel.
 You need a secure channel to get the one-time pad
 to its destination.
 But once there, you are then able to,
 I mean, literally during the middle of the day,
 just say the numbers out in the air.
 For anyone, you could publish them
 on the front page of the New York Times.
 Doesn't matter at all what you do,
 because nobody can crack this code
 who doesn't have a copy of the pad
 that was used to produce it.
 - But that's-
 - No analysis.
 - But that's the weak link is that there is,
 you have to share, it's a shared key system.
 - Yes, well, it is a shared key also known as a private key.
 And in this case, it's also a symmetric key,
 meaning that the same key, in this case a pad,
 which is used to encrypt the message
 is used to decrypt it.
 That's what a symmetric key means.
 It means that the operation,
 even though you may do something different
 technically for decryption.
 For example, in this case, we went back,
 we went counterclockwise around the wheel
 to decrypt and clockwise around the wheel to encrypt.
 So you might do something different,
 but you're using the same key.
 So it's considered symmetric cryptography.
 Now, I said there were two weaknesses.
 One being that, you know, again,
 that you need to have a so-called secure channel.
 In this case, you know, a courier who you trust,
 and you make sure there's no way
 for these documents to fall into enemy hands.
 The second weakness is, you absolutely cannot ever reuse
 the pad a second time.
 - Why is that?
 - It is, any pages you use have to be torn up and burned.
 I mean, securely destroyed.
 The reason is that as soon as you have two encrypted messages,
 which were encoded, or ciphered,
 using the same pad, cryptanalysis will allow you
 to basically separate the messages from each other
 and decode the message.
 There are ways you're able to slide two messages
 against each other, and non-random peaks occur,
 which cryptanalysis is able to then determine,
 you know, what was really going on prior to the cryptography.
 And it turns out that some of our enemies
 who were using one-time pads didn't recognize,
 and this is, you know, decades ago,
 didn't recognize the vulnerability of the system,
 and we cracked their codes because they were using pads
 more than one time, and so our analysis would check
 for that happening, we found it was happening,
 and we were able to determine
 what the original pad's contents were.
 Once we had that, we could then easily decrypt
 all the messages that were encrypted with that same pad.
 - Wow, that's pretty amazing.
 - So, I mean, it's really neat.
 I mean, it's interesting too, because you go from
 absolutely no force on Earth can decrypt this
 to its trivial to decrypt it
 if you make the mistake of using it twice.
 So it absolutely has to be only used once.
 Okay, now, let's go the next step in our development of this.
 Rather than using a ping-pong ball machine
 and true random numbers, we're going to use
 a mathematical algorithm to generate random numbers.
 That is, and in this case, terminology gets a little tricky.
 I mean, I really have to call them pseudo-random numbers,
 although I dislike the term because it implies
 that, you know, they're not good enough.
 You know, pseudo-random isn't as good as random.
 Well, in fact, really good pseudo-random numbers
 are so good that it can take an analysis of millions of them
 in order to determine that they're not random.
 - The problem in general with these is that they repeat
 after some period of time.
 - Well, really cheesy ones do.
 - Oh, not all of them?
 - No, no, no.
 - Is that how they change it, sir?
 - Well, if you think about it, if we have, for example,
 128 bits, and if the entire state
 of our random number generator were 128 bits,
 we know that 128 bits gives us a certain number of numbers.
 And if we ever hit on one of those again,
 we'd be stuck in a loop.
 But it turns out that really good random number generators
 use a huge pool of entropy, essentially,
 as one of the terms that they use,
 is they have a big pool of randomness,
 and the generator is constantly churning
 this big and tropic pool.
 And so, for example, it might generate
 the number five, five times in a row,
 and then go off and never do it again.
 So, I mean, so really good pseudo-random number generators
 exist now, and I mean, they're so good
 they can be used without concern.
 And what's cool about them is the,
 essentially, you start them in a known state,
 and you give them a key, which determines
 the sequence of randomness.
 Well, now, we've seen this before,
 and we talked about it very early on
 in the Security Now podcast,
 because RC4 was a, sorry, the pseudo-random number generator
 used in the original WIP-wired equivalent privacy
 Wi-Fi encryption, which we know was so poorly implemented.
 - I mean, it was that seed that was the problem.
 - Well, it was that the people who used it
 didn't appreciate the limitations,
 and one of the things that was really the Achilles heel
 is that the same number, that is the same sequence,
 got used multiple times.
 - Same thing like using one time pad more than once.
 - Exactly, I mean, that's exactly what it was.
 And so, they created some technology
 that wouldn't have this happening all the time,
 but the number of total different sequences
 was so large, was not large enough,
 that if you listen for a while, you couldn't pick up
 some reuse, and as soon as you pick up reuse
 of the same sequence, you're in trouble.
 - Interesting.
 Okay, so let's go back, we have RC4,
 which is a very nice pseudo-random number generator.
 What you need to do is you need to avoid
 what are now known as some weak keys
 that just don't initialize it very well,
 'cause basically it starts out with an array,
 a 256 byte array that's filled with the values 0 through 255.
 The key is used to sort of pre-scramble that,
 and then as you generate numbers with it,
 it continues to churn within that array additionally.
 Well, it turns out that all you have to do
 is throw away the first, maybe 256 bytes
 that it generates, because those tend to not be very random.
 It sort of, it takes a while to get going.
 And again, using these tools correctly
 is certainly important, and the horrors
 of original Wi-Fi show us all the ways
 in which you can go wrong and make mistakes
 in not using these properly.
 But given that you had this,
 basically you could take a key and use RC4,
 throw away the first 256 bytes that it emits,
 then take the balance and simply use that
 as your pad.
 So, I mean, and it's really good encryption.
 Now you've got a pseudo-random sequence,
 which is being used to spin us our encryption
 around the wheel until we go a number,
 the number of steps around, for example, clockwise,
 of the pseudo-random number that's been emitted,
 and that's our symbol.
 And because the pseudo-random sequence generator
 is so random and so good,
 it is also incredibly difficult to decrypt.
 Now, we need to back off a little bit from impossible.
 True randomness that is mixed with the message
 cannot be decrypted, but because an algorithm
 was generated, I'm sorry,
 because an algorithm was used to generate the sequence,
 it's not absolutely, truly random random random.
 You know, it's just, it's really good random,
 but it's not, it is, okay, pseudo-random.
 So, there's that tiny weakness,
 but with really good pseudo-random number generators,
 encrypting a message with, I mean, virtually,
 state-of-the-art technology is just that simple.
 You use an algorithm to produce random numbers,
 and you spin around the wheel.
 Now, I wanna talk about one last thing here
 for this first, you know,
 into the technology of cryptography,
 and that's an operation which is performed all the time,
 known as an exclusive OR.
 In math, you know, there's like the basic functions OR and AND.
 For example, if you had two bits,
 and you run them through an AND function,
 well, you only get a one bit out
 when all of the inputs are true,
 or you're feeding one in.
 With an OR, you get a true value out, or a one out.
 If any one or more of the inputs is true,
 then the OR function says, okay, I'm gonna be true.
 An exclusive OR is an interesting animal.
 It has two inputs,
 and the output is true if either input is true,
 but not both.
 So, if you make a little chart for yourself,
 where you say, okay, you've got two inputs
 that are gonna be zero and zero, so the output is zero.
 Now, the first input is one, the second input is zero,
 and the output is true, exactly one.
 And the reverse, the first one is zero,
 the second one is one or true, then the output is true.
 So it's only false if both are false.
 Or if both are true.
 Oh, it's false if both are true.
 Yes, that's the key.
 So if the input, if the first input is one,
 AND the second input is one, then the output is zero.
 So that's what's called an exclusive OR.
 It's not-- It's not a regular old OR.
 Exactly.
 Well, what's very cool about this
 is if you look at this chart,
 you'll realize that if you had like a signal coming
 in the first input that was going through the output,
 now let's say that the second input is zero.
 So we have our signal coming through,
 if the signal is zero, the output is zero.
 If the input signal is one, the output's one,
 because our other input is zero.
 So this is having no effect.
 But if our second input is a one, look what happens.
 We put a zero in, and because the other input is a one,
 we get a one out.
 We put a one in, and because both of them are one,
 we get a zero out.
 In other words, this is inverting.
 It's sort of a conditional inverter.
 If our second input is zero,
 there's no inversion of the data.
 But if our second input is one,
 anything we put in the input is flipped over.
 We put in a one, we get out a zero.
 We put in a zero, we get out a one.
 So that's what an XOR operation does.
 - Got it.
 - Okay, so the reason that's cool is that it's reversible.
 That is to say, if you say that you had your clear text
 and you ran it through this XOR,
 and it may or may not have inverted it.
 Okay, then you run it through the XOR again.
 Well, if it had inverted it before,
 it will invert it now.
 And if it didn't before, it won't now.
 So the idea is it reverses the process.
 And that ends up being a key function in cryptography.
 So now, instead of talking about our symbols,
 let's get away now from our little 28 symbol wheel
 and talk about bytes.
 'Cause bytes is the way everything works in
 everything that we're doing today.
 So we have an eight bit byte of clear text.
 That could be the whole ASCII character.
 It could be a byte of computer data, any eight bit pattern.
 We then we XOR that byte with an eight bit pseudo-random value
 that came from our RC4 generator or whatever,
 pseudo-random generator we're using.
 And that's gonna produce the cipher text.
 If we, and so we're done basically,
 we've by just taking our clear text byte
 and XORing all the bits with the pseudo-random bits
 from our generator, we now have encrypted our byte.
 And literally, that's all that is being done today.
 And it's reversible.
 And that's the beauty because if you then take that
 and you send it somewhere, you store it somewhere,
 you do whatever you want to with it.
 Doesn't matter because I mean, it is at this point
 after running it through that XOR operation, XORing it,
 and that is to say mixing it with a pseudo-random value,
 it is now ciphered.
 That's all there is to it.
 You then, if you wanna decipher it or decrypt it,
 someone wants to read your message, all they do
 is they do need to have the key
 for the pseudo-random sequence generator
 so that they're gonna be spitting out the same random bytes.
 But they take your byte, XOR it with the byte,
 which will have been the same one you used.
 And because this XOR process is reversible,
 out drops your original byte.
 - Isn't that slick?
 I've always liked XOR.
 Always been one of my favorites.
 It's so elegant.
 - Yeah, well, it's clean, and what I love about this
 is this is so simple.
 I mean, what I'm describing is exactly
 how many systems work today.
 And as I promised you, Leo, that's all there is to it.
 I mean, everyone can understand this.
 This is not, I mean, it's on some level,
 I guess it's rocket science, but, you know,
 and in fact, the details of the pseudo-random sequence
 generator that's spitting out these really good random bytes,
 that's pretty hairy, you know, crypto math stuff.
 But if you have a stream of pseudo-random bytes,
 you simply XOR them with your data
 and you get something out nothing
 in any reasonable time can crack.
 - It's really remarkable.
 Now, I wish we had illustrations on this one
 because this is a tough one to do in audio.
 I mean, I'm impressed that you were able to explain this
 and I followed it, but it is tough.
 - Well, I want to try to do this
 because we're doing an audio podcast
 and draw the examples.
 I think that going, falling back to the decoder ring
 in order to sort of build up some vocabulary
 and then moving into bytes, I would imagine
 we've probably held everyone here.
 And so essentially, what we've just described is for,
 I mean, absolutely symmetric key encryption
 as it is used today.
 You have a key that must be kept private
 but because that key allows someone
 to generate the same stream of pseudo-random bytes
 which are then XORed against the ciphertext
 in order to recreate the original plaintext.
 So, and that's one of the keys.
 Now, you know, you mentioned early on, of course,
 the problem with the one time pad
 was that the person on the receiving end
 had to somehow get that ahead of time.
 Well, we've reduced the problem size
 but we have not at all reduced the nature of the problem
 because the key still must be kept private
 in the same way that the suitcase with the one time pad
 had to be kept out of enemy hands
 even though we now have a key that lets us
 easily generate as much data as we want to
 which is very cool, the secrecy of that key
 is every bit as important.
 And now we're gonna, next time, we're gonna talk about--
 - Shh, don't tell them how we're gonna solve this problem.
 - It turns out there are very cool technologies
 that solve that so that it's possible
 to establish a communication with another party
 where somebody eavesdropping can't gain the information
 they need to decode the conversation.
 - And that was the real revolution in cryptography, really.
 - That's a very cool thing.
 So here, I just wanna make sure people get it
 that this key that generates the random numbers,
 now notice just not the key itself or not the key alone
 but also all of the machinery
 for generating the random numbers, that has to be known too.
 So somebody who was gonna decrypt it
 basically needs to recreate the same stream
 of pseudo-random data to exor against the ciphertext
 to create the clear text.
 So they have to know what algorithm you're using,
 the details of that, and the key.
 So more than just the key is necessary,
 but the problem is all that stuff has to be kept secret.
 And we know that there is some security and obscurity
 but it's not nearly as good as any security technology
 where you can just be completely open and say,
 here's what we're doing, give it your best shot.
 - Wouldn't it be neat if we could just give our keys out
 and still have security?
 - And we'll be talking about how that works
 in the coming weeks.
 - And we won't do it next week
 'cause next week is a question and answer week,
 our 32nd episode, every fourth episode.
 Steve sits down and answers the mailbag
 and there's a bunch of great questions for you, I know.
 - And now thanks to this updated form on the page,
 we'll have a better sense for who and where people are
 and I'll be able to answer people's questions
 and we'll go from there.
 - Don't forget to go to his website,
 grc.com/securitynow.html for transcripts
 and 16 kilobit versions of the show,
 all his show notes, links and so forth.
 And of course, while you're there, check out Spinrite,
 which is the ultimate disc recovery
 and maintenance utility, I use it
 and I encourage everybody to get a copy
 of Spinrite, Steve Gibson's incredible program.
 - Well, now we've got Spinrite.info
 for anyone who wants to see some listener feedback, yep.
 - Just go to spinrite.info.
 - I can't believe you, Steve.
 This is a revolution, a revolution.
 Do you have, have you ever had anything but size grc.com?
 - Actually, I own spinrite.com
 and that brings you to my site also
 and I've got various other little domains
 that I use here and there, but you know grc.com,
 of course, is the flagship.
 - That's the one, that's the one.
 Well, we thank our flagship AOL radio,
 they broadcast us on their podcast channel
 and of course provide us the bandwidth
 so we can get this to you via podcasting.
 - That's AOL.com/podcasting
 for more information, I've got some great programs
 on there, including all the other Twitter programs
 that host them all.
 Steve Gibson, we'll talk next week.
 ♪ Secure it now ♪
