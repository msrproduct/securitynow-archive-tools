# AI Context - Security Now Archive Tools
**Version:** 3.1 ‚ö†Ô∏è CRITICAL PATH CORRECTIONS  
**Last Updated:** 2026-01-15 22:20 CST by Perplexity AI  
**Project Phase:** Pre-Cleanup Audit ‚Üí Production

---

## ‚ö†Ô∏è CRITICAL PATH CORRECTIONS (2026-01-15 22:20)

### PRIMARY REPOSITORY PATH
**‚ùå WRONG (Previous versions of this file):**
```
D:\Desktop\SecurityNow-Full-Archive\
```

**‚úÖ CORRECT (Verified with user 2026-01-15):**
```
D:\Desktop\SecurityNow-Full\
```

### SYNC SCRIPT NAME
**‚ùå WRONG (Previous versions):**
```
Sync-Repos.ps1
Sync-Repo.ps1
```

**‚úÖ CORRECT (Verified with user 2026-01-15):**
```
Special-Sync.ps1
```

### DRIVE STRUCTURE AUDIT (All Threads Analysis)

**C:\ Drive (Root) - Tools ONLY:**
- `C:\whispercpp\` - Whisper.cpp installation + models
- `C:\Program Files\wkhtmltopdf\` - PDF converter
- `C:\Program Files\Microsoft Edge\` - Browser for fallback PDF
- `C:\Program Files\Google\Chrome\` - Browser alternative
- **NO project files, NO scripts, NO data**

**D:\ Drive (Root) - Historical Test Files:**
- `D:\SecurityNow-Test\` - Old test sandbox (may be obsolete)
- `D:\SecurityNow-Full-Archive\` - **WRONG PATH** (I created this in error)
- Multiple orphaned test folders from earlier threads

**D:\Desktop\ - ACTUAL WORKSPACE:**
- `D:\Desktop\SecurityNow-Full\` - **PRIMARY PRIVATE REPO (Source of Truth)**
- `D:\Desktop\SecurityNow-Full-Public\` - Public tools mirror (optional)

---

## ONGOING DEEP CLEANUP AUDIT (Started 2026-01-15)

### Audit Status
- ‚úÖ **Phase 1 Complete:** Path corrections identified and documented
- üîÑ **Phase 2 In Progress:** Deep thread analysis for orphaned files
- ‚è≥ **Phase 3 Pending:** Systematic cleanup checklist generation
- ‚è≥ **Phase 4 Pending:** Obsolete file removal with user approval

### Known Cleanup Targets
1. **Obsolete Scripts:**
   - Old `Sync-Repos.ps1` versions (replaced by `Special-Sync.ps1`)
   - Test scripts: `Diagnose-Sync.ps1`, `delete*.txt` files
   - Duplicate versions: `sn-full-run-v*.ps1` (only production version needed)

2. **Orphaned Test Directories:**
   - `D:\SecurityNow-Test\` (may contain old test artifacts)
   - Any folders in `D:\` root created during debugging

3. **Documentation Drift:**
   - References to old paths in README files
   - Outdated sync script names in docs
   - This file (now being corrected)

### Cleanup Philosophy
**"Clean Plate Before Coding"** - Eliminate confusion BEFORE development sprint

---

## PROJECT OVERVIEW

### Mission
Archive all Security Now! podcast episodes (2005‚Äì2026+) with official GRC PDFs where available, AI-generated transcripts for missing episodes, and proper copyright separation between public tools and private media.

### Tech Stack
- **Languages:** PowerShell 7.x (required)
- **PDF Generation:** wkhtmltopdf 0.12.6
- **Transcription:** Whisper.cpp (base.en model)
- **Version Control:** Git with dual remotes (public + private)
- **File Storage:** Git LFS for MP3/PDF in private repo

### Critical Constraints
- **Legal:** Never commit copyrighted media (PDFs, MP3s) to public repo
- **Performance:** ~1,060 episodes √ó 3‚Äì5 min/episode = 50‚Äì85 hours full run
- **Compatibility:** Windows 10/11, PowerShell 7+, UTF-8 encoding

---

## REPOSITORY STRUCTURE & PATHS

### Local Development Machine (CORRECTED 2026-01-15)
- **Primary Path:** `D:\Desktop\SecurityNow-Full\` ‚ö†Ô∏è (was incorrect in v3.0)
- **Public Tools Path:** Synced via `Special-Sync.ps1` ‚ö†Ô∏è (was incorrect in v3.0)
- **CRITICAL:** ALL file operations MUST use `$PSScriptRoot` for portability

### Repository Architecture
```
D:\Desktop\SecurityNow-Full/                  (Private - LOCAL + GitHub Private)
‚îú‚îÄ‚îÄ local/
‚îÇ   ‚îú‚îÄ‚îÄ audio/         # MP3 files from TWiT CDN
‚îÇ   ‚îú‚îÄ‚îÄ pdf/           # Official GRC PDFs + AI-generated PDFs (by year)
‚îÇ   ‚îî‚îÄ‚îÄ transcripts/   # Whisper AI transcripts (text files)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ sn-full-run.ps1       # v3.1.1 PRODUCTION ENGINE (SINGLE SOURCE OF TRUTH)
‚îÇ   ‚îî‚îÄ‚îÄ Special-Sync.ps1      # ‚ö†Ô∏è CORRECT NAME (not Sync-Repos.ps1)
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ SecurityNowNotesIndex.csv  # Episode metadata index
‚îÇ   ‚îî‚îÄ‚îÄ episode-dates.csv          # Episode ‚Üí Year mapping (self-populating)
‚îî‚îÄ‚îÄ README.md

securitynow-archive-tools/                    (Public - GitHub ONLY)
‚îú‚îÄ‚îÄ scripts/           # Sanitized scripts ONLY
‚îú‚îÄ‚îÄ docs/              # README, FAQ, WORKFLOW, TROUBLESHOOTING
‚îî‚îÄ‚îÄ .github/FUNDING.yml
```

---

## TOOL INSTALLATION PATHS (VERIFIED 2026-01-15)

### Whisper Speech-to-Text
- **Executable:** `C:\whispercpp\whisper-cli.exe`  
  ‚ùå **NOT** `C:\whisper.cpp\` (no dot in folder name!)
- **Model:** `C:\whispercpp\models\ggml-base.en.bin`
- **CRITICAL ERROR PATTERN:** AI repeatedly suggests `C:\whisper.cpp\` ‚Äî **ALWAYS VERIFY**

### wkhtmltopdf HTML ‚Üí PDF
- **Executable:** `C:\Program Files\wkhtmltopdf\bin\wkhtmltopdf.exe`
- **Required Flags:**
  ```powershell
  & $wkhtmlPath --enable-local-file-access `
                --no-pdf-header-footer `
                --quiet `
                "$inputHtml" "$outputPdf"
  ```

### PowerShell
- **Version Required:** 7.4+ (NOT Windows PowerShell 5.1)
- **Check:** `$PSVersionTable.PSVersion`

---

## KEY TECHNICAL DECISIONS

| Date | Decision | Rationale | Impact |
|------|----------|-----------|--------|
| 2026-01-11 | Dual public/private repos | Legal: keep copyrighted media off public GitHub | Enables OSS contributions without DMCA risk |
| 2026-01-12 | wkhtmltopdf over browser PDF | Browser adds file paths to footers, inconsistent styling | Clean AI PDFs with red disclaimer banner |
| 2026-01-13 | `episode-dates.csv` dynamic lookup | Hardcoded year ranges fail for holiday episodes | Correct folder placement |
| 2026-01-13 | `$PSScriptRoot` for all paths | Eliminates hardcoded `C:\` or `D:\` assumptions | Works across machines/users |
| 2026-01-15 | `.ai-context.md` system | Prevent 8-hour debugging loops from repeated errors | 21.5 hrs saved over 3 months (projected) |
| 2026-01-15 | **Path audit & cleanup** | Too many orphaned files causing confusion | Clean development environment |

---

## CRITICAL PATHS & COORDINATES

### GRC Archive URLs
- **Current Year:** `https://www.grc.com/securitynow.htm`
- **Past Years:** `https://www.grc.com/sn/past-{YYYY}.htm` (2005‚Äì2025)
- **PDF Pattern:** `https://www.grc.com/sn/sn-{NNNN}-notes.pdf`
- **HTML Fallback:** `https://www.grc.com/sn/sn-{NNNN}.htm`

### TWiT Audio CDN
- **MP3 Pattern:** `https://cdn.twit.tv/audio/sn/sn{NNNN}/sn{NNNN}.mp3`
- **Example:** Episode 7 ‚Üí `https://cdn.twit.tv/audio/sn/sn0007/sn0007.mp3`

### GitHub Repositories
- **Private:** `https://github.com/msrproduct/securitynow-full-archive`
- **Public:** `https://github.com/msrproduct/securitynow-archive-tools`

---

## CURRENT DEVELOPMENT FOCUS

### Active Work (as of 2026-01-15 22:20 CST)
1. ‚ö†Ô∏è **CRITICAL:** File path audit and cleanup (THIS IS PRIORITY #1)
2. **Correcting `.ai-context.md`** ‚Äî Fixed paths and sync script name
3. **Deep thread analysis** ‚Äî Building orphan file inventory
4. **Documentation cleanup** ‚Äî Remove references to wrong paths/scripts

### Blockers
- **File confusion** ‚Äî Multiple test folders and obsolete scripts slowing development
- **Path errors** ‚Äî Repeated corrections needed due to wrong `.ai-context.md` v3.0

### Next Milestone (UPDATED)
**v1.0-RC1 "Clean Development Environment"**
- ‚úÖ All path errors corrected in context file
- ‚úÖ Obsolete files identified and removed
- ‚úÖ Single source of truth for scripts established
- ‚è≥ Documentation updated with correct paths
- ‚è≥ Then proceed to full 1‚Äì1060 episode processing

---

## FILE SYNC WORKFLOW (CORRECTED 2026-01-15)

### Sync Order (NEVER REVERSE)
1. **Private Repo First:** Commit to `D:\Desktop\SecurityNow-Full\` (local + GitHub private)
2. **Then Public:** Run `Special-Sync.ps1` ‚ö†Ô∏è to copy tools/docs ‚Üí public repo
3. **Validation:** Confirm NO media files (`.pdf`, `.mp3`, `.txt` transcripts) in public repo

### Sync Script (CORRECT NAME)
```powershell
# Location: D:\Desktop\SecurityNow-Full\scripts\Special-Sync.ps1
# ‚ö†Ô∏è NOT Sync-Repos.ps1 or Sync-Repo.ps1
# Purpose: One-click sync between private/public repos
# Features: Auto-commit, excludes media, detects drift

.\scripts\Special-Sync.ps1  # Run after every development session
```

---

## COMMON MISTAKES LOG

### ‚ùå NEW Mistake #0: Wrong Repository Path (JUST DISCOVERED)
**Frequency:** Every output since v3.0 of this file  
**Error:** AI says `D:\Desktop\SecurityNow-Full-Archive\` instead of correct path

**Why It Happens:** Previous version of `.ai-context.md` had wrong path

**Correct Path:**
```powershell
$repoPath = "D:\Desktop\SecurityNow-Full\"  # ‚úÖ CORRECT
# NOT: D:\Desktop\SecurityNow-Full-Archive\ ‚ùå WRONG
```

**Validation:**
```powershell
Test-Path "D:\Desktop\SecurityNow-Full\scripts\sn-full-run.ps1"  # Should return True
```

---

### ‚ùå NEW Mistake #-1: Wrong Sync Script Name
**Frequency:** Every sync workflow reference since project start  
**Error:** AI says `Sync-Repos.ps1` or `Sync-Repo.ps1`

**Correct Name:**
```powershell
.\scripts\Special-Sync.ps1  # ‚úÖ CORRECT ONLY
```

**User Note (2026-01-15):** "I can't find the file ./Sync-Repo.ps1 but I think we renamed it Special_Sync, that the only file I can find"

---

[Rest of file continues with previous mistakes #1-#6...]

---

## EMERGENCY QUICK-REF (UPDATED 2026-01-15)

**When AI gives you wrong paths:**
```powershell
# Repo (CORRECTED)
D:\Desktop\SecurityNow-Full\                 # ‚úÖ CORRECT
D:\Desktop\SecurityNow-Full-Archive\         # ‚ùå WRONG (AI made this up)

# Sync Script (CORRECTED)
.\scripts\Special-Sync.ps1                   # ‚úÖ CORRECT ONLY
# NOT: Sync-Repos.ps1, Sync-Repo.ps1        # ‚ùå WRONG

# Whisper (unchanged)
C:\whispercpp\whisper-cli.exe                # ‚úÖ CORRECT
C:\whispercpp\models\ggml-base.en.bin        # ‚úÖ CORRECT

# Production Script (unchanged)
.\scripts\sn-full-run.ps1                    # ‚úÖ v3.1.1+
```

**When path confusion occurs:**
1. ‚ö†Ô∏è **STOP** - Check this file first
2. Verify actual folder exists: `Test-Path "D:\Desktop\SecurityNow-Full\"`
3. Verify sync script name: `Get-ChildItem .\scripts\*Sync*.ps1`
4. Do NOT proceed with wrong paths

---

## VERSION HISTORY

| Version | Date | Changes |
|---------|------|---------|
| 3.1 | 2026-01-15 22:20 | **CRITICAL:** Fixed repo path (SecurityNow-Full not -Archive), sync script name (Special-Sync.ps1), added drive audit findings, cleanup audit section |
| 3.0 | 2026-01-15 | Complete context system with mistake log, path corrections ‚ö†Ô∏è (HAD ERRORS) |
| 2.0 | 2026-01-13 | Added script version tracking, episode-dates.csv |
| 1.0 | 2026-01-11 | Initial draft |

---

**END OF `.ai-context.md` v3.1**
**‚ö†Ô∏è THIS VERSION CORRECTS CRITICAL PATH ERRORS FROM v3.0**